<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="import_moinmoinpages.py">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>import_moinmoinpages.py | Scientific logbook</title>
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../rss.xml">
<link rel="canonical" href="https://laurentperrinet.github.io/sciblog/listings/import_moinmoinpages.py.html">
<link rel="icon" href="favicon.ico" sizes="16x16">
<!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Header and menu bar -->
<div class="container">
      <header class="blog-header py-3"><div class="row nbb-header align-items-center">
          <div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;">
            <button class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" type="button" data-toggle="collapse" data-target=".bs-nav-collapsible" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse bs-nav-collapsible bootblog4-search-form-holder">
                
<!-- Custom search -->
<form method="get" id="search" action="//duckduckgo.com/" class="navbar-form pull-left">
<input type="hidden" name="sites" value="https://laurentperrinet.github.io/sciblog/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Search…" class="span2" style="margin-top: 4px;"><input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
<!-- End of custom search -->

            </div>
        </div>
          <div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;">
            <a class="navbar-brand blog-header-logo text-dark" href="../">

            <span id="blog-title">Scientific logbook</span>
        </a>
          </div>
            <div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
            <nav class="navbar navbar-light bg-white"><ul class="navbar-nav bootblog4-right-nav">
<li class="nav-item">
    <a href="import_moinmoinpages.py" id="sourcelink" class="nav-link">Source</a>
    </li>


                    
            </ul></nav>
</div>
    </div>
</header><nav class="navbar navbar-expand-md navbar-light bg-white static-top"><div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
            <ul class="navbar-nav nav-fill d-flex w-100">
<li class="nav-item">
<a href="../index.html" class="nav-link">Home</a>
                </li>
<li class="nav-item">
<a href="../archive.html" class="nav-link">Archives</a>
                </li>
<li class="nav-item">
<a href="../categories/index.html" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="../rss.xml" class="nav-link">RSS</a>
                </li>
<li class="nav-item">
<a href="http://laurentperrinet.github.io" class="nav-link">About my research</a>
                </li>
<li class="nav-item">
<a href="https://twitter.com/laurentperrinet" class="nav-link">Twitter</a>
                </li>
<li class="nav-item">
<a href="https://github.com/laurentperrinet" class="nav-link">Github</a>

                
            </li>
</ul>
</div>
<!-- /.navbar-collapse -->
</nav>
</div>

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        

<nav class="breadcrumbs"><ul class="breadcrumb">
<li class="breadcrumb-item"><a href=".">listings</a></li>
                <li class="breadcrumb-item active">import_moinmoinpages.py</li>
</ul></nav><h1>import_moinmoinpages.py
        <small><a href="import_moinmoinpages.py">(Source)</a></small>
    </h1>
    <div class="code"><table class="codetable">
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-1"><code data-line-number="  1"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-1"></a><span class="ch">#!/usr/bin/env python</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-2"><code data-line-number="  2"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-2"></a><span class="c1"># imported from</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-3"><code data-line-number="  3"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-3"></a><span class="c1"># https://github.com/jbarratt/serialized-nikola/blob/master/util/import_octopress_posts.py</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-4"><code data-line-number="  4"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-4"></a><span class="kn">import</span> <span class="nn">sys</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-5"><code data-line-number="  5"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-5"></a><span class="kn">import</span> <span class="nn">os</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-6"><code data-line-number="  6"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-6"></a><span class="kn">import</span> <span class="nn">glob</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-7"><code data-line-number="  7"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-7"></a><span class="kn">import</span> <span class="nn">re</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-8"><code data-line-number="  8"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-8"></a>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-9"><code data-line-number="  9"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-9"></a>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-10"><code data-line-number=" 10"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-10"></a><span class="k">def</span> <span class="nf">octo_parse</span><span class="p">(</span><span class="n">octo_post</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-11"><code data-line-number=" 11"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-11"></a>    <span class="sd">"""</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-12"><code data-line-number=" 12"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-12"></a><span class="sd">        Input: an octopress post</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-13"><code data-line-number=" 13"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-13"></a><span class="sd">        Output: a tuple of (dict of metadata, string of body)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-14"><code data-line-number=" 14"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-14"></a><span class="sd">    """</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-15"><code data-line-number=" 15"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-15"></a>    <span class="n">fm_count</span> <span class="o">=</span> <span class="mi">0</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-16"><code data-line-number=" 16"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-16"></a>    <span class="n">meta</span> <span class="o">=</span> <span class="p">{}</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-17"><code data-line-number=" 17"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-17"></a>    <span class="n">body</span> <span class="o">=</span> <span class="p">[]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-18"><code data-line-number=" 18"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-18"></a>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-19"><code data-line-number=" 19"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-19"></a>    <span class="n">block_type</span> <span class="o">=</span> <span class="kc">None</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-20"><code data-line-number=" 20"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-20"></a>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-21"><code data-line-number=" 21"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-21"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">octo_post</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-22"><code data-line-number=" 22"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-22"></a>        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-23"><code data-line-number=" 23"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-23"></a>            <span class="k">if</span> <span class="n">fm_count</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-24"><code data-line-number=" 24"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-24"></a>                <span class="c1"># everything after frontmatter is body</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-25"><code data-line-number=" 25"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-25"></a>                <span class="c1"># {% img right /images/GiveUpSmall.jpg 180 240 foo %}</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-26"><code data-line-number=" 26"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-26"></a>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-27"><code data-line-number=" 27"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-27"></a>                <span class="c1"># Convert octopress image blocks</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-28"><code data-line-number=" 28"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-28"></a>                <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">'\s*\{\s*\%\s*img\s*(right)?\s*(\S*)\s*(\d+)?\s*(\d+)?\s*(.*?)\s*\%\s*\}'</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-29"><code data-line-number=" 29"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-29"></a>                <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-30"><code data-line-number=" 30"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-30"></a>                    <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">alt</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-31"><code data-line-number=" 31"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-31"></a>                    <span class="n">img_tag</span> <span class="o">=</span> <span class="s2">"&lt;img src='</span><span class="si">%s</span><span class="s2">'"</span> <span class="o">%</span> <span class="n">source</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-32"><code data-line-number=" 32"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-32"></a>                    <span class="k">if</span> <span class="n">right</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-33"><code data-line-number=" 33"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-33"></a>                        <span class="n">img_tag</span> <span class="o">+=</span> <span class="s2">" align='right'"</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-34"><code data-line-number=" 34"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-34"></a>                    <span class="k">if</span> <span class="n">width</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-35"><code data-line-number=" 35"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-35"></a>                        <span class="n">img_tag</span> <span class="o">+=</span> <span class="s2">" width='</span><span class="si">%s</span><span class="s2">'"</span> <span class="o">%</span> <span class="n">width</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-36"><code data-line-number=" 36"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-36"></a>                    <span class="k">if</span> <span class="n">height</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-37"><code data-line-number=" 37"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-37"></a>                        <span class="n">img_tag</span> <span class="o">+=</span> <span class="s2">" height='</span><span class="si">%s</span><span class="s2">'"</span> <span class="o">%</span> <span class="n">height</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-38"><code data-line-number=" 38"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-38"></a>                    <span class="k">if</span> <span class="n">alt</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-39"><code data-line-number=" 39"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-39"></a>                        <span class="n">img_tag</span> <span class="o">+=</span> <span class="s2">" title='</span><span class="si">%s</span><span class="s2">' alt='</span><span class="si">%s</span><span class="s2">'"</span> <span class="o">%</span> <span class="p">(</span><span class="n">alt</span><span class="p">,</span> <span class="n">alt</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-40"><code data-line-number=" 40"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-40"></a>                    <span class="n">img_tag</span> <span class="o">+=</span> <span class="s2">"/&gt;"</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-41"><code data-line-number=" 41"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-41"></a>                    <span class="n">body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img_tag</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-42"><code data-line-number=" 42"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-42"></a>                    <span class="k">continue</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-43"><code data-line-number=" 43"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-43"></a>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-44"><code data-line-number=" 44"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-44"></a>                <span class="c1"># convert octopress blockquote and code blocks</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-45"><code data-line-number=" 45"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-45"></a>                <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">'\s*\{\s*\%\s*(end)?(\w+)\s*(?:lang:)?(\w+)?\s*\%'</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-46"><code data-line-number=" 46"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-46"></a>                <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-47"><code data-line-number=" 47"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-47"></a>                    <span class="p">(</span><span class="n">ended</span><span class="p">,</span> <span class="n">b_type</span><span class="p">,</span> <span class="n">lang</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-48"><code data-line-number=" 48"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-48"></a>                    <span class="k">if</span> <span class="n">ended</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-49"><code data-line-number=" 49"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-49"></a>                        <span class="k">if</span> <span class="n">block_type</span> <span class="o">==</span> <span class="s2">"codeblock"</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-50"><code data-line-number=" 50"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-50"></a>                            <span class="n">body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"```</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-51"><code data-line-number=" 51"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-51"></a>                        <span class="n">block_type</span> <span class="o">=</span> <span class="kc">None</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-52"><code data-line-number=" 52"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-52"></a>                        <span class="k">continue</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-53"><code data-line-number=" 53"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-53"></a>                    <span class="k">else</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-54"><code data-line-number=" 54"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-54"></a>                        <span class="n">block_type</span> <span class="o">=</span> <span class="n">b_type</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-55"><code data-line-number=" 55"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-55"></a>                        <span class="k">if</span> <span class="n">block_type</span> <span class="o">==</span> <span class="s2">"codeblock"</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-56"><code data-line-number=" 56"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-56"></a>                            <span class="n">opener</span> <span class="o">=</span> <span class="s2">"```"</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-57"><code data-line-number=" 57"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-57"></a>                            <span class="k">if</span> <span class="n">lang</span> <span class="ow">and</span> <span class="n">lang</span> <span class="o">!=</span> <span class="s2">"text"</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-58"><code data-line-number=" 58"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-58"></a>                                <span class="n">opener</span> <span class="o">+=</span> <span class="s2">" </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">lang</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-59"><code data-line-number=" 59"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-59"></a>                            <span class="n">body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opener</span> <span class="o">+</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-60"><code data-line-number=" 60"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-60"></a>                        <span class="k">continue</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-61"><code data-line-number=" 61"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-61"></a>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-62"><code data-line-number=" 62"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-62"></a>                <span class="k">if</span> <span class="n">block_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-63"><code data-line-number=" 63"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-63"></a>                    <span class="n">body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-64"><code data-line-number=" 64"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-64"></a>                <span class="k">elif</span> <span class="n">block_type</span> <span class="o">==</span> <span class="s2">"blockquote"</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-65"><code data-line-number=" 65"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-65"></a>                    <span class="n">body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"&gt; "</span> <span class="o">+</span> <span class="n">l</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-66"><code data-line-number=" 66"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-66"></a>                <span class="k">elif</span> <span class="n">block_type</span> <span class="o">==</span> <span class="s2">"codeblock"</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-67"><code data-line-number=" 67"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-67"></a>                    <span class="n">body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-68"><code data-line-number=" 68"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-68"></a>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-69"><code data-line-number=" 69"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-69"></a>            <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">'^\s*-+\s*$'</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-70"><code data-line-number=" 70"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-70"></a>                <span class="c1"># YAML frontmatter marker</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-71"><code data-line-number=" 71"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-71"></a>                <span class="n">fm_count</span> <span class="o">=</span> <span class="n">fm_count</span> <span class="o">+</span> <span class="mi">1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-72"><code data-line-number=" 72"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-72"></a>            <span class="k">else</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-73"><code data-line-number=" 73"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-73"></a>                <span class="c1"># I'm only interested in date and title from</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-74"><code data-line-number=" 74"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-74"></a>                <span class="c1"># Octopress frontmatter. Others may want more.</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-75"><code data-line-number=" 75"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-75"></a>                <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">'^\s*(date|title): (.*?)$'</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-76"><code data-line-number=" 76"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-76"></a>                <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-77"><code data-line-number=" 77"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-77"></a>                    <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-78"><code data-line-number=" 78"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-78"></a>                    <span class="n">meta</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">'" '</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-79"><code data-line-number=" 79"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-79"></a>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-80"><code data-line-number=" 80"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-80"></a>        <span class="c1"># Pull the date out of the filename</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-81"><code data-line-number=" 81"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-81"></a>        <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">'(\d</span><span class="si">{4}</span><span class="s1">)-(\d</span><span class="si">{2}</span><span class="s1">)-(\d</span><span class="si">{2}</span><span class="s1">)-(.*?).markdown'</span><span class="p">,</span> <span class="n">octo_post</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-82"><code data-line-number=" 82"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-82"></a>        <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-83"><code data-line-number=" 83"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-83"></a>            <span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">slug</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-84"><code data-line-number=" 84"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-84"></a>            <span class="k">if</span> <span class="s2">"date"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meta</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-85"><code data-line-number=" 85"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-85"></a>                <span class="c1"># if it has a date, it's better, because it has time</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-86"><code data-line-number=" 86"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-86"></a>                <span class="c1"># if not make something up</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-87"><code data-line-number=" 87"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-87"></a>                <span class="n">meta</span><span class="p">[</span><span class="s1">'date'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2"> 13:37"</span> <span class="o">%</span> <span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-88"><code data-line-number=" 88"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-88"></a>            <span class="k">else</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-89"><code data-line-number=" 89"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-89"></a>                <span class="n">meta</span><span class="p">[</span><span class="s1">'date'</span><span class="p">]</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="s1">'date'</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'-'</span><span class="p">,</span> <span class="s1">'/'</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-90"><code data-line-number=" 90"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-90"></a>            <span class="n">meta</span><span class="p">[</span><span class="s1">'slug'</span><span class="p">]</span> <span class="o">=</span> <span class="n">slug</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-91"><code data-line-number=" 91"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-91"></a>            <span class="n">meta</span><span class="p">[</span><span class="s1">'year'</span><span class="p">]</span> <span class="o">=</span> <span class="n">year</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-92"><code data-line-number=" 92"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-92"></a>            <span class="n">meta</span><span class="p">[</span><span class="s1">'month'</span><span class="p">]</span> <span class="o">=</span> <span class="n">month</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-93"><code data-line-number=" 93"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-93"></a>        <span class="k">else</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-94"><code data-line-number=" 94"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-94"></a>            <span class="nb">print</span> <span class="s2">"warning, can't get slug from </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">octo_post</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-95"><code data-line-number=" 95"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-95"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">body</span><span class="p">))</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-96"><code data-line-number=" 96"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-96"></a>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-97"><code data-line-number=" 97"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-97"></a>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-98"><code data-line-number=" 98"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-98"></a><span class="k">def</span> <span class="nf">nikola_save</span><span class="p">(</span><span class="n">np_dir</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-99"><code data-line-number=" 99"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-99"></a>    <span class="sd">"""</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-100"><code data-line-number="100"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-100"></a><span class="sd">        Input: directory for posts</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-101"><code data-line-number="101"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-101"></a><span class="sd">               metadata hash</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-102"><code data-line-number="102"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-102"></a><span class="sd">               body text</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-103"><code data-line-number="103"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-103"></a>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-104"><code data-line-number="104"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-104"></a><span class="sd">        .. title: How to make money</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-105"><code data-line-number="105"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-105"></a><span class="sd">        .. slug: how-to-make-money</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-106"><code data-line-number="106"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-106"></a><span class="sd">        .. date: 2012/09/15 19:52:05</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-107"><code data-line-number="107"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-107"></a><span class="sd">        .. tags:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-108"><code data-line-number="108"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-108"></a><span class="sd">        .. link:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-109"><code data-line-number="109"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-109"></a><span class="sd">        .. description:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-110"><code data-line-number="110"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-110"></a><span class="sd">    """</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-111"><code data-line-number="111"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-111"></a>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-112"><code data-line-number="112"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-112"></a>    <span class="n">newdir</span> <span class="o">=</span> <span class="s2">"</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">np_dir</span><span class="p">,</span> <span class="n">meta</span><span class="p">[</span><span class="s1">'year'</span><span class="p">],</span> <span class="n">meta</span><span class="p">[</span><span class="s1">'month'</span><span class="p">])</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-113"><code data-line-number="113"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-113"></a>    <span class="c1"># make this an index so we end up with YYYY/MM/&lt;slug&gt;.extension</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-114"><code data-line-number="114"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-114"></a>    <span class="k">try</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-115"><code data-line-number="115"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-115"></a>        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">newdir</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-116"><code data-line-number="116"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-116"></a>    <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-117"><code data-line-number="117"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-117"></a>        <span class="k">pass</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-118"><code data-line-number="118"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-118"></a>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-119"><code data-line-number="119"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-119"></a>    <span class="n">newfile</span> <span class="o">=</span> <span class="s2">"</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">.md"</span> <span class="o">%</span> <span class="p">(</span><span class="n">meta</span><span class="p">[</span><span class="s1">'slug'</span><span class="p">],</span> <span class="n">newdir</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-120"><code data-line-number="120"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-120"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">newfile</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-121"><code data-line-number="121"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-121"></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'&lt;!--</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-122"><code data-line-number="122"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-122"></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'date'</span><span class="p">,</span> <span class="s1">'slug'</span><span class="p">]:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-123"><code data-line-number="123"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-123"></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'.. </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="se">\n</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">meta</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-124"><code data-line-number="124"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-124"></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'tags'</span><span class="p">,</span> <span class="s1">'link'</span><span class="p">,</span> <span class="s1">'description'</span><span class="p">]:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-125"><code data-line-number="125"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-125"></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'.. </span><span class="si">%s</span><span class="s1">:</span><span class="se">\n</span><span class="s1">'</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-126"><code data-line-number="126"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-126"></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'--&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-127"><code data-line-number="127"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-127"></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="n">body</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-128"><code data-line-number="128"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-128"></a>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-129"><code data-line-number="129"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-129"></a>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-130"><code data-line-number="130"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-130"></a><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-131"><code data-line-number="131"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-131"></a>    <span class="sd">"""</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-132"><code data-line-number="132"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-132"></a><span class="sd">        Input: octopress posts directory</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-133"><code data-line-number="133"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-133"></a><span class="sd">        Output: nikola posts directory</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-134"><code data-line-number="134"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-134"></a>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-135"><code data-line-number="135"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-135"></a><span class="sd">        For each file</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-136"><code data-line-number="136"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-136"></a><span class="sd">            * strip the yaml front matter</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-137"><code data-line-number="137"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-137"></a><span class="sd">            * parse the file name to fill in missing bits of the front matter</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-138"><code data-line-number="138"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-138"></a><span class="sd">            * fill in nikola front matter</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-139"><code data-line-number="139"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-139"></a><span class="sd">            * rename from YYYY-MM-DD-&lt;slug&gt;.markdown to YYYY/MM/&lt;slug&gt;.md</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-140"><code data-line-number="140"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-140"></a><span class="sd">    """</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-141"><code data-line-number="141"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-141"></a>    <span class="n">op_dir</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-142"><code data-line-number="142"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-142"></a>    <span class="n">np_dir</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-143"><code data-line-number="143"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-143"></a>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-144"><code data-line-number="144"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-144"></a>    <span class="k">for</span> <span class="n">op_file</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">'</span><span class="si">%s</span><span class="s1">/*.markdown'</span> <span class="o">%</span> <span class="n">op_dir</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-145"><code data-line-number="145"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-145"></a>        <span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span> <span class="o">=</span> <span class="n">octo_parse</span><span class="p">(</span><span class="n">op_file</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-146"><code data-line-number="146"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-146"></a>        <span class="n">nikola_save</span><span class="p">(</span><span class="n">np_dir</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-147"><code data-line-number="147"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-147"></a>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-148"><code data-line-number="148"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-148"></a>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-149"><code data-line-number="149"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-149"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="#listingsimport_moinmoinpagespy-150"><code data-line-number="150"></code></a></td>
<td class="code"><code><a name="listingsimport_moinmoinpagespy-150"></a>    <span class="n">main</span><span class="p">()</span>
</code></td>
</tr>
</table></div>

        <!--End of body content-->

        <footer id="footer">
            Contents © 2022 <a href="mailto:laurent.perrinet@univ-amu.fr">Laurent Perrinet</a> -
Powered by <a href="http://getnikola.com">Nikola</a> with <a href="https://themes.getnikola.com/v7/maupassant/">Maupassant</a> theme <br><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/ar/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="http://i.creativecommons.org/l/by-nc-sa/2.5/ar/88x31.png"></a>
            
            
        </footer>
</div>
</div>


        <script src="../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140381649-1"></script><script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));
  }

  gtag('js', new Date());
  gtag('config', 'UA-140381649-1', {});


  document.addEventListener('click', onClickCallback, false);
</script>
</body>
</html>
