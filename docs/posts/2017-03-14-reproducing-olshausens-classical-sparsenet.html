<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Reproducing Olshausen's classical SparseNet (part 1) | Scientific logbook</title>
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../rss.xml">
<link rel="canonical" href="https://laurentperrinet.github.io/sciblog/posts/2017-03-14-reproducing-olshausens-classical-sparsenet.html">
<link rel="icon" href="favicon.ico" sizes="16x16">
<!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]--><link href="../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="assets/css/typeplate.css">
<link rel="stylesheet" media="screen" href="http://openfontlibrary.org/face/railway-sans" type="text/css">
<meta name="author" content="Laurent Perrinet">
<link rel="prev" href="2017-03-09_probabilities.html" title="Some basics around probabilities" type="text/html">
<link rel="next" href="2017-03-15-reproducing-olshausens-classical-sparsenet-part-2.html" title="Reproducing Olshausens classical SparseNet (part 2)" type="text/html">
<meta property="og:site_name" content="Scientific logbook">
<meta property="og:title" content="Reproducing Olshausen's classical SparseNet (part 1)">
<meta property="og:url" content="https://laurentperrinet.github.io/sciblog/posts/2017-03-14-reproducing-olshausens-classical-sparsenet.html">
<meta property="og:description" content="This notebook tries to reproduce the learning strategy specified in the framework of the SparseNet algorithm from Bruno Olshausen. It allows to efficiently code natural image patches by constraining t">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2017-03-14T13:51:06+02:00">
<meta property="article:tag" content="computational neuroscience">
<meta property="article:tag" content="learning">
<meta property="article:tag" content="open-science">
</head>
<body>
<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation"><div class="container">
    <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="https://laurentperrinet.github.io/sciblog/">Scientific logbook</a>
    </div>
    <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
<li>
<a href="../index.html">Home</a>
                </li>
<li>
<a href="../archive.html">Archives</a>
                </li>
<li>
<a href="../categories/index.html">Tags</a>
                </li>
<li>
<a href="../rss.xml">RSS</a>
                </li>
<li>
<a href="http://laurentperrinet.github.io">About my research</a>
                </li>
<li>
<a href="https://twitter.com/laurentperrinet">Twitter</a>
                </li>
<li>
<a href="https://github.com/laurentperrinet">Github</a>

        </li>
</ul>
<!-- Custom search --><form method="get" id="search" action="//duckduckgo.com/" class="navbar-form pull-left">
<input type="hidden" name="sites" value="https://laurentperrinet.github.io/sciblog/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Search…" class="span2" style="margin-top: 4px;"><input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
<!-- End of custom search -->


        <ul class="nav navbar-nav navbar-right">
<!--Add Links to social media sites --><!-- pass --><li>
    <a href="2017-03-14-reproducing-olshausens-classical-sparsenet.ipynb" id="sourcelink">Source</a>
    </li>

        </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
</nav><!-- End of Menubar --><div class="container">
  <!--Body content-->
  <div class="row">
      
      
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Reproducing Olshausen's classical SparseNet (part 1)</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Laurent Perrinet
            </span></p>
            <p class="dateline">
            <a href="#" rel="bookmark">
            <time class="published dt-published" datetime="2017-03-14T13:51:06+02:00" itemprop="datePublished" title="2017-03-14 13:51">2017-03-14 13:51</time></a>
            </p>
            
        <p class="sourceline"><a href="2017-03-14-reproducing-olshausens-classical-sparsenet.ipynb" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<p>This notebook tries to reproduce the learning strategy specified in the framework of the <a href="http://redwood.berkeley.edu/bruno/sparsenet/">SparseNet algorithm from Bruno Olshausen</a>. It allows to efficiently code natural image patches by constraining the code to be sparse.</p>
</li>
<li>
<p>the underlying machinery uses a similar dictionary learning as used in the <a href="http://scikit-learn.org/stable/_downloads/plot_image_denoising.py">image denoising</a> example from <code>sklearn</code> and our aim here is to show that a novel ingredient is necessary to reproduce Olshausen's results.</p>
</li>
<li>
<p>All these code bits is regrouped in the <a href="https://github.com/bicv/SHL_scripts">SHL scripts repository</a> (where you will also find some older matlab code). You may install it using</p>
</li>
</ul>
<pre><code>    pip install git+https://github.com/bicv/SHL_scripts</code></pre>
<ul>
<li>
<p>following this failed <a href="https://github.com/scikit-learn/scikit-learn/pull/4693">PR to sklearn</a> that was argued in <a href="https://laurentperrinet.github.io/sciblog/posts/2015-05-05-reproducing-olshausens-classical-sparsenet.html">this post</a>  (and following) the goal of this notebooks is to illustrate the simpler code implemented in the <a href="https://github.com/bicv/SHL_scripts">SHL scripts</a></p>
<p>This is joint work with <a href="https://laurentperrinet.github.io/authors/victor-boutin">Victor Boutin</a>.</p>
</li>
</ul>
<!-- TEASER_END -->
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's start by doing a simple learning as implemented in the <a href="http://scikit-learn.org/stable/_downloads/plot_image_denoising.py">image denoising</a> example from <code>sklearn</code> and then show the dictionary:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">shl_scripts.shl_experiments</span> <span class="kn">import</span> <span class="n">SHL</span>
<span class="n">DEBUG_DOWNSCALE</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">matname</span> <span class="o">=</span> <span class="s1">'olshausen'</span>
<span class="n">shl</span> <span class="o">=</span> <span class="n">SHL</span><span class="p">(</span><span class="n">datapath</span><span class="o">=</span><span class="s1">'/tmp/database/'</span><span class="p">,</span> <span class="n">DEBUG_DOWNSCALE</span><span class="o">=</span><span class="n">DEBUG_DOWNSCALE</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">eta_homeo</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">shl</span><span class="o">.</span><span class="n">learn_dico</span><span class="p">(</span><span class="n">matname</span><span class="o">=</span><span class="n">matname</span><span class="p">)</span><span class="o">.</span><span class="n">show_dico</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">matname</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-2-212282eb8dd8&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> matname <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">'olshausen'</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> shl <span class="ansi-blue-fg">=</span> SHL<span class="ansi-blue-fg">(</span>datapath<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">'/tmp/database/'</span><span class="ansi-blue-fg">,</span> DEBUG_DOWNSCALE<span class="ansi-blue-fg">=</span>DEBUG_DOWNSCALE<span class="ansi-blue-fg">,</span> verbose<span class="ansi-blue-fg">=</span>verbose<span class="ansi-blue-fg">,</span> eta_homeo<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----&gt; 5</span><span class="ansi-red-fg"> </span>fig<span class="ansi-blue-fg">,</span> ax <span class="ansi-blue-fg">=</span> shl<span class="ansi-blue-fg">.</span>learn_dico<span class="ansi-blue-fg">(</span>matname<span class="ansi-blue-fg">=</span>matname<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>show_dico<span class="ansi-blue-fg">(</span>title<span class="ansi-blue-fg">=</span>matname<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span> fig<span class="ansi-blue-fg">.</span>show<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/science/ABC/2017-11_cosyne/SHL_scripts/shl_scripts/shl_experiments.py</span> in <span class="ansi-cyan-fg">learn_dico</span><span class="ansi-blue-fg">(self, dictionary, P_cum, data, name_database, matname, record_each, folder_exp, list_figures, fname)</span>
<span class="ansi-green-intense-fg ansi-bold">    176</span>                             patch_size<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>patch_size<span class="ansi-blue-fg">,</span> datapath<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>datapath<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    177</span>                             max_patches<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>max_patches<span class="ansi-blue-fg">,</span> verbose<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>verbose<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">--&gt; 178</span><span class="ansi-red-fg">                             data_cache=self.data_cache, matname=matname)
</span><span class="ansi-green-intense-fg ansi-bold">    179</span> 
<span class="ansi-green-intense-fg ansi-bold">    180</span>         <span class="ansi-green-fg">if</span> matname <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">TypeError</span>: get_data() got an unexpected keyword argument 'height'</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="in-summary">in summary<a class="anchor-link" href="2017-03-14-reproducing-olshausens-classical-sparsenet.html#in-summary">¶</a>
</h3>
<p>In this notebook, we have replicated the classical SparseNet algorithm of Olshausen on a  set of natural images. However, the dictionaries are qualitatively not the same as the one from the original paper, and this is certainly due to the lack of control in the competition during the learning phase.</p>
<p>What differ in this implementation from the original algorithm is mainly the way that the norm of the filters is controlled. Here, <code>sklearn</code> simply assumes that $ || V_k ||_2 = 1$,  $\forall k$ (with $0 &lt;= k &lt; n_{components}$). We will see that this may be a problem.</p>
<p>Let's now try to do that <a href="https://laurentperrinet.github.io/sciblog/posts/2017-03-15-reproducing-olshausens-classical-sparsenet-part-2.html">in a new notebook</a>.</p>
<p>In <a href="https://laurentperrinet.github.io/sciblog/posts/2017-03-17-extending-olshausens-classical-sparsenet.html">an extension</a>, we will study how homeostasis (cooperation) may be an essential ingredient to this algorithm working on a winner-take-all basis (competition). This extension has been published as Perrinet, Neural Computation (2010) (see  <a href="https://laurentperrinet.github.io/publication/perrinet-10-shl">https://laurentperrinet.github.io/publication/perrinet-10-shl</a> ).</p>

</div>
</div>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../categories/computational-neuroscience.html" rel="tag">computational neuroscience</a></li>
            <li><a class="tag p-category" href="../categories/learning.html" rel="tag">learning</a></li>
            <li><a class="tag p-category" href="../categories/open-science.html" rel="tag">open-science</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="2017-03-09_probabilities.html" rel="prev" title="Some basics around probabilities">Previous post</a>
            </li>
            <li class="next">
                <a href="2017-03-15-reproducing-olshausens-classical-sparsenet-part-2.html" rel="next" title="Reproducing Olshausens classical SparseNet (part 2)">Next post</a>
            </li>
        </ul></nav></aside><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    },
    displayAlign: 'center', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script></article>
</div>

  <div class="footerbox">
    Contents © 2022 <a href="mailto:laurent.perrinet@univ-amu.fr">Laurent Perrinet</a> -
Powered by <a href="http://getnikola.com">Nikola</a> with <a href="https://themes.getnikola.com/v7/maupassant/">Maupassant</a> theme <br><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/ar/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="http://i.creativecommons.org/l/by-nc-sa/2.5/ar/88x31.png"></a>
    
  </div>
<!--End of body content-->
</div>

            <script src="../assets/js/all-nocdn.js"></script><!-- Add Jumbotron scroll js --><script type="text/javascript">//<![CDATA[
$(window).load(function(){
  $(window).scroll(function() {
    var scrolledY = $(window).scrollTop();
    $('.jumbotron').css('background-position', 'left ' + ((scrolledY)) + 'px');
  });
});//]]>
</script><!-- fancy dates --><script>
moment.locale("en");
fancydates(0, "YYYY-MM-DD HH:mm");
</script><!-- end fancy dates --><script>
baguetteBox.run('div#content', {
    ignoreClass: 'islink',
    captions: function(element) {
        return element.getElementsByTagName('img')[0].alt;
}});
</script><!-- Abstract hide/show
<script src"/assets/js/div_toggle.js"></script>
--><script type="text/javascript">
function toggle(showHideDiv, switchTextDiv) {
    var ele = document.getElementById(showHideDiv);
    var text = document.getElementById(switchTextDiv);
    if(ele.style.display == "none") {
        ele.style.display = "block";
        text.innerHTML = "[hide abstract]";
    }
    else {
            ele.style.display = "none";
            text.innerHTML = "[show abstract]";
    }
}
</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140381649-1"></script><script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));
  }

  gtag('js', new Date());
  gtag('config', 'UA-140381649-1', {});


  document.addEventListener('click', onClickCallback, false);
</script>
</body>
</html>
