<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Embedding a trajectory in noise | Scientific logbook</title>
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml">
<link rel="canonical" href="https://laurentperrinet.github.io/sciblog/posts/2018-11-13-testing-more-complex-trajectories.html">
<link rel="icon" href="favicon.ico" sizes="16x16">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    },
    displayAlign: 'center', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script><!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]--><meta name="author" content="Laurent Perrinet">
<link rel="prev" href="2018-11-11-rainbow-effect.html" title="Rainbow effect" type="text/html">
<link rel="next" href="2018-11-14-regex-an-iso8601-date.html" title="Using regex to filter an ISO8601 date" type="text/html">
<meta property="og:site_name" content="Scientific logbook">
<meta property="og:title" content="Embedding a trajectory in noise">
<meta property="og:url" content="https://laurentperrinet.github.io/sciblog/posts/2018-11-13-testing-more-complex-trajectories.html">
<meta property="og:description" content="MotionClouds may be considered as a control stimulus - it seems more interesting to consider more complex trajectories. Following a previous post, we design a trajectory embedded in noise.











">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2018-11-13T11:43:46+02:00">
<meta property="article:tag" content="code">
<meta property="article:tag" content="motionclouds">
<meta property="article:tag" content="trajectory">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Header and menu bar -->
<div class="container">
      <header class="blog-header py-3"><div class="row nbb-header align-items-center">
          <div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;">
            <button class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" type="button" data-toggle="collapse" data-target=".bs-nav-collapsible" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse bs-nav-collapsible bootblog4-search-form-holder">
                
<!-- Custom search -->
<form method="get" id="search" action="//duckduckgo.com/" class="navbar-form pull-left">
<input type="hidden" name="sites" value="https://laurentperrinet.github.io/sciblog/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Search…" class="span2" style="margin-top: 4px;"><input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
<!-- End of custom search -->

            </div>
        </div>
          <div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;">
            <a class="navbar-brand blog-header-logo text-dark" href="https://laurentperrinet.github.io/sciblog/">

            <span id="blog-title">Scientific logbook</span>
        </a>
          </div>
            <div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
            <nav class="navbar navbar-light bg-white"><ul class="navbar-nav bootblog4-right-nav">
<li class="nav-item">
    <a href="2018-11-13-testing-more-complex-trajectories.ipynb" id="sourcelink" class="nav-link">Source</a>
    </li>


                    
            </ul></nav>
</div>
    </div>
</header><nav class="navbar navbar-expand-md navbar-light bg-white static-top"><div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
            <ul class="navbar-nav nav-fill d-flex w-100">
<li class="nav-item">
<a href="../index.html" class="nav-link">Home</a>
                </li>
<li class="nav-item">
<a href="../archive.html" class="nav-link">Archives</a>
                </li>
<li class="nav-item">
<a href="../categories/index.html" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="http://laurentperrinet.github.io" class="nav-link">About my research</a>
                </li>
<li class="nav-item">
<a href="https://twitter.com/laurentperrinet" class="nav-link">Twitter</a>
                </li>
<li class="nav-item">
<a href="https://github.com/laurentperrinet" class="nav-link">Github</a>

                
            </li>
</ul>
</div>
<!-- /.navbar-collapse -->
</nav>
</div>

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Embedding a trajectory in noise</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Laurent Perrinet
            </span></p>
            <p class="dateline">
            <a href="#" rel="bookmark">
            <time class="published dt-published" datetime="2018-11-13T11:43:46+02:00" itemprop="datePublished" title="2018-11-13 11:43">2018-11-13 11:43</time></a>
            </p>
                <p class="commentline">
        
    <a href="2018-11-13-testing-more-complex-trajectories.html#disqus_thread" data-disqus-identifier="cache/posts/2018-11-13-testing-more-complex-trajectories.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="2018-11-13-testing-more-complex-trajectories.ipynb" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>MotionClouds may be considered as a control stimulus - it seems more interesting to consider more complex trajectories. Following a <a href="https://laurentperrinet.github.io/sciblog/posts/2018-01-16-testing-more-complex-trajectories.html">previous post</a>, we design a trajectory embedded in noise.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<center><table style="width:100%">
<tr>
<td><video controls autoplay loop src="../files/2018-11-13-testing-more-complex/trajectory_overlay_difficult.mp4" width="100%/"></video></td>
<td><video controls autoplay loop src="../files/2018-11-13-testing-more-complex/trajectory_overlay_difficult_reversed.mp4" width="100%/"></video></td>
</tr>
<tr>
<td><video controls autoplay loop src="../files/2018-11-13-testing-more-complex/trajectory_overlay_difficult_shuffled.mp4" width="100%/"></video></td>
<td><video controls autoplay loop src="../files/2018-11-13-testing-more-complex/trajectory_overlay_difficult_shuffled_reversed.mp4" width="100%/"></video></td>
</tr>
</table></center>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Can you spot the motion ? from left to right or reversed ?</p>
<p>(For a more controlled test, imagine you fixate on the top left corner of each movie.)</p>
<p>(Upper row is coherent, lower row uncoherent / Left is <code>-&gt;</code> Right column is <code>&lt;-</code>)</p>
<p>TODO: use a biomimetic camouflage such as in this <a href="https://twitter.com/CoenCagli_Lab/status/1168565787818385408">video</a>.</p>
<!-- TEASER_END -->

<p>Let's start with the classical Motion Cloud:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">name</span> <span class="o">=</span> <span class="s1">'trajectory'</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">MotionClouds</span> <span class="k">as</span> <span class="nn">mc</span>
<span class="n">fx</span><span class="p">,</span> <span class="n">fy</span><span class="p">,</span> <span class="n">ft</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">get_grids</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">N_X</span><span class="p">,</span> <span class="n">mc</span><span class="o">.</span><span class="n">N_Y</span><span class="p">,</span> <span class="n">mc</span><span class="o">.</span><span class="n">N_frame</span><span class="p">)</span>

<span class="n">mc</span><span class="o">.</span><span class="n">figpath</span> <span class="o">=</span> <span class="s1">'../files/2018-11-13-testing-more-complex'</span>
<span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">)):</span> <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Some default parameters for the textons used here:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">opts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">sf_0</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">B_sf</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">B_theta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">B_V</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">V_X</span><span class="o">=</span><span class="mf">2.</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First defining a dense,stationary noise with an horizontal drift:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">name_</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">'_dense'</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">mc1</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">envelope_gabor</span><span class="p">(</span><span class="n">fx</span><span class="p">,</span> <span class="n">fy</span><span class="p">,</span> <span class="n">ft</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">mc</span><span class="o">.</span><span class="n">figures</span><span class="p">(</span><span class="n">mc1</span><span class="p">,</span> <span class="n">name_</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">figpath</span><span class="o">=</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">)</span>
<span class="n">mc</span><span class="o">.</span><span class="n">in_show_video</span><span class="p">(</span><span class="n">name_</span><span class="p">,</span> <span class="n">figpath</span><span class="o">=</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">

                <center><table border="none" width="100%" height="100%">
<tr>
<td width="33%%"><center><img src="../files/2018-11-13-testing-more-complex/trajectory_dense.png" width="100%/"></center></td>
                <td rowspan="2" colspan="2"><center><video src="../files/2018-11-13-testing-more-complex/trajectory_dense.mp4" loop="1" autoplay="1" controls type="video/mp4" width="100%/"></video></center></td>
                </tr>
<tr>
<td><center><img src="../files/2018-11-13-testing-more-complex/trajectory_dense_cube.png" width="100%/"></center></td>
                </tr>
</table></center>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The information is distributed densely in space and time.</p>
<h3 id="one-definition-of-a-trajectory">one definition of a trajectory<a class="anchor-link" href="2018-11-13-testing-more-complex-trajectories.html#one-definition-of-a-trajectory">¶</a>
</h3>
<p>It is also possible to show the impulse response ("texton") corresponding to this particular texture (be patient to see a full period):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">name_</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">'_impulse'</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">mc1</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">envelope_gabor</span><span class="p">(</span><span class="n">fx</span><span class="p">,</span> <span class="n">fy</span><span class="p">,</span> <span class="n">ft</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">mc</span><span class="o">.</span><span class="n">figures</span><span class="p">(</span><span class="n">mc1</span><span class="p">,</span> <span class="n">name_</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">impulse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figpath</span><span class="o">=</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">)</span>
<span class="n">mc</span><span class="o">.</span><span class="n">in_show_video</span><span class="p">(</span><span class="n">name_</span><span class="p">,</span> <span class="n">figpath</span><span class="o">=</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">

                <center><table border="none" width="100%" height="100%">
<tr>
<td width="33%%"><center><img src="../files/2018-11-13-testing-more-complex/trajectory_impulse.png" width="100%/"></center></td>
                <td rowspan="2" colspan="2"><center><video src="../files/2018-11-13-testing-more-complex/trajectory_impulse.mp4" loop="1" autoplay="1" controls type="video/mp4" width="100%/"></video></center></td>
                </tr>
<tr>
<td><center><img src="../files/2018-11-13-testing-more-complex/trajectory_impulse_cube.png" width="100%/"></center></td>
                </tr>
</table></center>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To generate a trajectory, we should just convolve this impulse response to a trajectory defined as a binary profile in space and time:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">name_</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">'_straight'</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">fx</span><span class="o">+.</span><span class="mi">5</span><span class="p">,</span> <span class="n">fy</span><span class="o">+.</span><span class="mi">5</span><span class="p">,</span> <span class="n">ft</span><span class="o">+.</span><span class="mi">5</span> <span class="c1"># trick to use fourier coordinates to get spatial coordinates</span>
<span class="n">width_y</span><span class="p">,</span> <span class="n">width_x</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">mc</span><span class="o">.</span><span class="n">N_X</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">mc</span><span class="o">.</span><span class="n">N_Y</span>
<span class="n">t0</span><span class="p">,</span> <span class="n">t1</span> <span class="o">=</span> <span class="o">.</span><span class="mi">375</span><span class="p">,</span> <span class="o">.</span><span class="mi">625</span>
<span class="n">x0</span> <span class="o">=</span> <span class="o">.</span><span class="mi">25</span> <span class="c1">#np.random.rand() * (1 - opts['V_X'] * (t1-t0)) # makes sure the trajectory does not wrap across the border</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span>
<span class="n">events</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">width_y</span><span class="p">)</span><span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">opts</span><span class="p">[</span><span class="s1">'V_X'</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">t0</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">width_x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">&gt;</span> <span class="n">t0</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">&lt;</span> <span class="n">t1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">events</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Time'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'X-axis'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mc1</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">envelope_gabor</span><span class="p">(</span><span class="n">fx</span><span class="p">,</span> <span class="n">fy</span><span class="p">,</span> <span class="n">ft</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">mc</span><span class="o">.</span><span class="n">figures</span><span class="p">(</span><span class="n">mc1</span><span class="p">,</span> <span class="n">name_</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">events</span><span class="p">,</span> <span class="n">figpath</span><span class="o">=</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">)</span>
<span class="n">mc</span><span class="o">.</span><span class="n">in_show_video</span><span class="p">(</span><span class="n">name_</span><span class="p">,</span> <span class="n">figpath</span><span class="o">=</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">

                <center><table border="none" width="100%" height="100%">
<tr>
<td width="33%%"><center><img src="../files/2018-11-13-testing-more-complex/trajectory_straight.png" width="100%/"></center></td>
                <td rowspan="2" colspan="2"><center><video src="../files/2018-11-13-testing-more-complex/trajectory_straight.mp4" loop="1" autoplay="1" controls type="video/mp4" width="100%/"></video></center></td>
                </tr>
<tr>
<td><center><img src="../files/2018-11-13-testing-more-complex/trajectory_straight_cube.png" width="100%/"></center></td>
                </tr>
</table></center>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To replicate the work from Watamaniuk, McKee and colleagues, we replicate the same motion but where we keep the motion energy while shuffling the coherence:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">name_</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">'_shuffled'</span>
<span class="n">N_folds</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">N_traj</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">t1</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="o">*</span><span class="n">mc</span><span class="o">.</span><span class="n">N_frame</span><span class="p">)</span> <span class="o">//</span> <span class="n">N_folds</span>
<span class="n">N_start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t0</span><span class="o">*</span><span class="n">mc</span><span class="o">.</span><span class="n">N_frame</span><span class="p">)</span>
<span class="n">folding</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">N_folds</span><span class="p">)</span>
<span class="n">events_shuffled</span> <span class="o">=</span> <span class="n">events</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i_fold</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_folds</span><span class="p">):</span>
    <span class="n">S0</span><span class="p">,</span> <span class="n">S1</span> <span class="o">=</span> <span class="p">(</span><span class="n">N_start</span><span class="o">+</span><span class="n">folding</span><span class="p">[</span><span class="n">i_fold</span><span class="p">]</span><span class="o">*</span><span class="n">N_traj</span><span class="p">),</span> <span class="p">(</span><span class="n">N_start</span><span class="o">+</span><span class="p">(</span><span class="n">folding</span><span class="p">[</span><span class="n">i_fold</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">N_traj</span><span class="p">)</span>
    <span class="n">N0</span><span class="p">,</span> <span class="n">N1</span> <span class="o">=</span> <span class="p">(</span><span class="n">N_start</span><span class="o">+</span><span class="n">i_fold</span><span class="o">*</span><span class="n">N_traj</span><span class="p">),</span> <span class="p">(</span><span class="n">N_start</span><span class="o">+</span><span class="p">(</span><span class="n">i_fold</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">N_traj</span><span class="p">)</span>
    <span class="n">nx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">*</span><span class="n">mc</span><span class="o">.</span><span class="n">N_Y</span><span class="p">)</span>
    <span class="n">ny</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">*</span><span class="n">mc</span><span class="o">.</span><span class="n">N_Y</span><span class="p">)</span>
    <span class="n">events_shuffled</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">S0</span><span class="p">:</span><span class="n">S1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">events</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">N0</span><span class="p">:</span><span class="n">N1</span><span class="p">],</span> <span class="n">nx</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">ny</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">events_shuffled</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Time'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'X-axis'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mc1</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">envelope_gabor</span><span class="p">(</span><span class="n">fx</span><span class="p">,</span> <span class="n">fy</span><span class="p">,</span> <span class="n">ft</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">mc</span><span class="o">.</span><span class="n">figures</span><span class="p">(</span><span class="n">mc1</span><span class="p">,</span> <span class="n">name_</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">events_shuffled</span><span class="p">,</span> <span class="n">figpath</span><span class="o">=</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">)</span>
<span class="n">mc</span><span class="o">.</span><span class="n">in_show_video</span><span class="p">(</span><span class="n">name_</span><span class="p">,</span> <span class="n">figpath</span><span class="o">=</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">

                <center><table border="none" width="100%" height="100%">
<tr>
<td width="33%%"><center><img src="../files/2018-11-13-testing-more-complex/trajectory_shuffled.png" width="100%/"></center></td>
                <td rowspan="2" colspan="2"><center><video src="../files/2018-11-13-testing-more-complex/trajectory_shuffled.mp4" loop="1" autoplay="1" controls type="video/mp4" width="100%/"></video></center></td>
                </tr>
<tr>
<td><center><img src="../files/2018-11-13-testing-more-complex/trajectory_shuffled_cube.png" width="100%/"></center></td>
                </tr>
</table></center>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="addition-of-a-the-trajectory-to-the-incoherent-noise">addition of a the trajectory to the incoherent noise<a class="anchor-link" href="2018-11-13-testing-more-complex-trajectories.html#addition-of-a-the-trajectory-to-the-incoherent-noise">¶</a>
</h3>
<p>It is now possible to add this trajectory to any kind of background, such as a background texture of the same "texton" but with a null average motion:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">overlay</span><span class="p">(</span><span class="n">movie1</span><span class="p">,</span> <span class="n">movie2</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">do_linear</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">do_linear</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">rho</span><span class="o">*</span><span class="n">movie1</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">rho</span><span class="p">)</span><span class="o">*</span><span class="n">movie2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">movie1</span><span class="p">,</span> <span class="n">movie2</span> <span class="o">=</span> <span class="n">rho</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">movie1</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mf">2.</span><span class="o">*</span><span class="n">movie2</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">movie</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">movie1</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">movie1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">movie2</span><span class="p">)</span>
        <span class="n">movie</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">movie1</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
        <span class="n">movie</span><span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">movie2</span><span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="n">mask</span><span class="p">]</span>
        <span class="k">return</span> <span class="o">.</span><span class="mi">5</span> <span class="o">+</span> <span class="o">.</span><span class="mi">5</span><span class="o">*</span><span class="n">movie</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>a more memory-efficient version of the above:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">overlay</span><span class="p">(</span><span class="n">movie1</span><span class="p">,</span> <span class="n">movie2</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">do_linear</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">do_linear</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">rho</span><span class="o">*</span><span class="n">movie1</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">rho</span><span class="p">)</span><span class="o">*</span><span class="n">movie2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">movie1</span><span class="p">,</span> <span class="n">movie2</span> <span class="o">=</span> <span class="n">rho</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">movie1</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mf">2.</span><span class="o">*</span><span class="n">movie2</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">movie</span> <span class="o">=</span> <span class="n">movie1</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">movie1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">movie2</span><span class="p">))</span> <span class="o">+</span> <span class="n">movie2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">movie1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">movie2</span><span class="p">))</span>
        <span class="c1">#return .5 + .5*movie</span>
        <span class="k">return</span> <span class="mf">1.</span> <span class="o">*</span> <span class="p">(</span><span class="n">movie</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="c1">#seuil = .1</span>
        <span class="c1">#return .5 + .5 * (-1. * (movie &lt; -seuil) +  1. * (movie &gt; seuil))</span>
        <span class="c1">#return  .5 + .5* np.tan(4.*movie)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mc1</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">envelope_gabor</span><span class="p">(</span><span class="n">fx</span><span class="p">,</span> <span class="n">fy</span><span class="p">,</span> <span class="n">ft</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">movie_coh</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">rectif</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">random_cloud</span><span class="p">(</span><span class="n">mc1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">events</span><span class="p">))</span>
<span class="n">opts_</span> <span class="o">=</span> <span class="n">opts</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">opts_</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">V_X</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mc0</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">envelope_gabor</span><span class="p">(</span><span class="n">fx</span><span class="p">,</span> <span class="n">fy</span><span class="p">,</span> <span class="n">ft</span><span class="p">,</span> <span class="o">**</span><span class="n">opts_</span><span class="p">)</span>
<span class="n">movie_unc</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">rectif</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">random_cloud</span><span class="p">(</span><span class="n">mc0</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">name_</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">'_overlay'</span>
<span class="n">rho_coh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">9</span>
<span class="n">mc</span><span class="o">.</span><span class="n">anim_save</span><span class="p">(</span><span class="n">overlay</span><span class="p">(</span><span class="n">movie_coh</span><span class="p">,</span> <span class="n">movie_unc</span><span class="p">,</span> <span class="n">rho_coh</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">,</span> <span class="n">name_</span><span class="p">))</span>
<span class="n">mc</span><span class="o">.</span><span class="n">in_show_video</span><span class="p">(</span><span class="n">name_</span><span class="p">,</span> <span class="n">figpath</span><span class="o">=</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">

            <center><table border="none" width="100%" height="100%"><tr><td width="100%"><center><video loop="1" autoplay="1" controls src="../files/2018-11-13-testing-more-complex/trajectory_overlay.mp4" type="video/mp4" width="100%\"></video></center></td></tr></table></center>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">name_</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">'_overlay_difficult'</span>
<span class="n">rho_coh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>
<span class="n">mc</span><span class="o">.</span><span class="n">anim_save</span><span class="p">(</span><span class="n">overlay</span><span class="p">(</span><span class="n">movie_coh</span><span class="p">,</span> <span class="n">movie_unc</span><span class="p">,</span> <span class="n">rho_coh</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">,</span> <span class="n">name_</span><span class="p">))</span>
<span class="n">mc</span><span class="o">.</span><span class="n">in_show_video</span><span class="p">(</span><span class="n">name_</span><span class="p">,</span> <span class="n">figpath</span><span class="o">=</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">

            <center><table border="none" width="100%" height="100%"><tr><td width="100%"><center><video loop="1" autoplay="1" controls src="../files/2018-11-13-testing-more-complex/trajectory_overlay_difficult.mp4" type="video/mp4" width="100%\"></video></center></td></tr></table></center>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Though it is difficult to find the coherent pattern in a single frame, one detects it thanks to its coherent motion.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">name_</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">'_overlay_shuffled'</span>
<span class="n">movie_coh_shuffled</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">rectif</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">random_cloud</span><span class="p">(</span><span class="n">mc1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">events_shuffled</span><span class="p">))</span>
<span class="n">rho_coh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">9</span>
<span class="n">mc</span><span class="o">.</span><span class="n">anim_save</span><span class="p">(</span><span class="n">overlay</span><span class="p">(</span><span class="n">movie_coh_shuffled</span><span class="p">,</span> <span class="n">movie_unc</span><span class="p">,</span> <span class="n">rho_coh</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">,</span> <span class="n">name_</span><span class="p">))</span>
<span class="n">mc</span><span class="o">.</span><span class="n">in_show_video</span><span class="p">(</span><span class="n">name_</span><span class="p">,</span> <span class="n">figpath</span><span class="o">=</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">

            <center><table border="none" width="100%" height="100%"><tr><td width="100%"><center><video loop="1" autoplay="1" controls src="../files/2018-11-13-testing-more-complex/trajectory_overlay_shuffled.mp4" type="video/mp4" width="100%\"></video></center></td></tr></table></center>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">name_</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">'_overlay_difficult_shuffled'</span>
<span class="n">rho_coh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>
<span class="n">mc</span><span class="o">.</span><span class="n">anim_save</span><span class="p">(</span><span class="n">overlay</span><span class="p">(</span><span class="n">movie_coh_shuffled</span><span class="p">,</span> <span class="n">movie_unc</span><span class="p">,</span> <span class="n">rho_coh</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">,</span> <span class="n">name_</span><span class="p">))</span>
<span class="n">mc</span><span class="o">.</span><span class="n">in_show_video</span><span class="p">(</span><span class="n">name_</span><span class="p">,</span> <span class="n">figpath</span><span class="o">=</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">

            <center><table border="none" width="100%" height="100%"><tr><td width="100%"><center><video loop="1" autoplay="1" controls src="../files/2018-11-13-testing-more-complex/trajectory_overlay_difficult_shuffled.mp4" type="video/mp4" width="100%\"></video></center></td></tr></table></center>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="trying-out-different-directions">trying out different directions<a class="anchor-link" href="2018-11-13-testing-more-complex-trajectories.html#trying-out-different-directions">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">name_</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">'_overlay_difficult_reversed'</span>
<span class="n">mc</span><span class="o">.</span><span class="n">anim_save</span><span class="p">(</span><span class="n">overlay</span><span class="p">(</span><span class="n">movie_coh</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">movie_unc</span><span class="p">,</span> <span class="n">rho_coh</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">,</span> <span class="n">name_</span><span class="p">))</span>
<span class="n">mc</span><span class="o">.</span><span class="n">in_show_video</span><span class="p">(</span><span class="n">name_</span><span class="p">,</span> <span class="n">figpath</span><span class="o">=</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">

            <center><table border="none" width="100%" height="100%"><tr><td width="100%"><center><video loop="1" autoplay="1" controls src="../files/2018-11-13-testing-more-complex/trajectory_overlay_difficult_reversed.mp4" type="video/mp4" width="100%\"></video></center></td></tr></table></center>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">name_</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">'_overlay_difficult_shuffled_reversed'</span>
<span class="n">mc</span><span class="o">.</span><span class="n">anim_save</span><span class="p">(</span><span class="n">overlay</span><span class="p">(</span><span class="n">movie_coh_shuffled</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">movie_unc</span><span class="p">,</span> <span class="n">rho_coh</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">,</span> <span class="n">name_</span><span class="p">))</span>
<span class="n">mc</span><span class="o">.</span><span class="n">in_show_video</span><span class="p">(</span><span class="n">name_</span><span class="p">,</span> <span class="n">figpath</span><span class="o">=</span><span class="n">mc</span><span class="o">.</span><span class="n">figpath</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">

            <center><table border="none" width="100%" height="100%"><tr><td width="100%"><center><video loop="1" autoplay="1" controls src="../files/2018-11-13-testing-more-complex/trajectory_overlay_difficult_shuffled_reversed.mp4" type="video/mp4" width="100%\"></video></center></td></tr></table></center>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="some-book-keeping-for-the-notebook">some book keeping for the notebook<a class="anchor-link" href="2018-11-13-testing-more-complex-trajectories.html#some-book-keeping-for-the-notebook">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> watermark
<span class="o">%</span><span class="k">watermark</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>2020-01-14T11:23:54+01:00

CPython 3.7.6
IPython 7.11.1

compiler   : Clang 11.0.0 (clang-1100.0.33.16)
system     : Darwin
release    : 19.2.0
machine    : x86_64
processor  : i386
CPU cores  : 36
interpreter: 64bit
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> watermark
<span class="o">%</span><span class="k">watermark</span> -i -h -m -v -p MotionClouds,numpy,pillow,imageio  -r -g -b
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>The watermark extension is already loaded. To reload it, use:
  %reload_ext watermark
2020-01-14T11:23:55+01:00

CPython 3.7.6
IPython 7.11.1

MotionClouds 20180606
numpy 1.19.0.dev0+624d34c
pillow not installed
imageio 2.6.1

compiler   : Clang 11.0.0 (clang-1100.0.33.16)
system     : Darwin
release    : 19.2.0
machine    : x86_64
processor  : i386
CPU cores  : 36
interpreter: 64bit
host name  : fortytwo
Git hash   : 7a9632c08197e479802f7b890ae18179d347a12e
Git repo   : https://github.com/laurentperrinet/sciblog.git
Git branch : master
</pre>
</div>
</div>

</div>
</div>

</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../categories/code.html" rel="tag">code</a></li>
            <li><a class="tag p-category" href="../categories/motionclouds.html" rel="tag">motionclouds</a></li>
            <li><a class="tag p-category" href="../categories/trajectory.html" rel="tag">trajectory</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="2018-11-11-rainbow-effect.html" rel="prev" title="Rainbow effect">Previous post</a>
            </li>
            <li class="next">
                <a href="2018-11-14-regex-an-iso8601-date.html" rel="next" title="Using regex to filter an ISO8601 date">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="invibe",
            disqus_url="https://laurentperrinet.github.io/sciblog/posts/2018-11-13-testing-more-complex-trajectories.html",
        disqus_title="Embedding a trajectory in noise",
        disqus_identifier="cache/posts/2018-11-13-testing-more-complex-trajectories.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    },
    displayAlign: 'center', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script></article><script>var disqus_shortname="invibe";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><!--End of body content--><footer id="footer">
            Contents © 2020 <a href="mailto:laurent.perrinet@univ-amu.fr">Laurent Perrinet</a> -
Powered by <a href="http://getnikola.com">Nikola</a> with <a href="https://themes.getnikola.com/v7/maupassant/">Maupassant</a> theme <br><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/ar/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="http://i.creativecommons.org/l/by-nc-sa/2.5/ar/88x31.png"></a>
            
            
        </footer>
</div>
</div>


        <script src="../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
