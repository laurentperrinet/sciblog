<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Video abstract for "An Adaptive Homeostatic Algorithm for the Unsupervised Learning of Visual Features" | Scientific logbook</title>
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml">
<link rel="canonical" href="https://laurentperrinet.github.io/sciblog/posts/2019-09-11_video-abstract-vision.html">
<link rel="icon" href="favicon.ico" sizes="16x16">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    },
    displayAlign: 'center', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script><!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]--><meta name="author" content="Laurent Perrinet">
<link rel="prev" href="2019-05-28_MainenSejnowski1995.html" title="Mainen &amp; Sejnowski, 1995" type="text/html">
<meta property="og:site_name" content="Scientific logbook">
<meta property="og:title" content='Video abstract for "An Adaptive Homeostatic Algorithm for the Unsuperv'>
<meta property="og:url" content="https://laurentperrinet.github.io/sciblog/posts/2019-09-11_video-abstract-vision.html">
<meta property="og:description" content="This video shows the results of unsupervised learning with different type of kezrnel normalization. This is to illustrate the results obtained in this paper on the An Adaptive Homeostatic Algorithm fo">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2019-09-11T10:06:52+02:00">
<meta property="article:tag" content="sparse-coding">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Header and menu bar -->
<div class="container">
      <header class="blog-header py-3"><div class="row nbb-header align-items-center">
          <div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;">
            <button class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" type="button" data-toggle="collapse" data-target=".bs-nav-collapsible" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse bs-nav-collapsible bootblog4-search-form-holder">
                
<!-- Custom search -->
<form method="get" id="search" action="//duckduckgo.com/" class="navbar-form pull-left">
<input type="hidden" name="sites" value="https://laurentperrinet.github.io/sciblog/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Search…" class="span2" style="margin-top: 4px;"><input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
<!-- End of custom search -->

            </div>
        </div>
          <div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;">
            <a class="navbar-brand blog-header-logo text-dark" href="https://laurentperrinet.github.io/sciblog/">

            <span id="blog-title">Scientific logbook</span>
        </a>
          </div>
            <div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
            <nav class="navbar navbar-light bg-white"><ul class="navbar-nav bootblog4-right-nav">
<li class="nav-item">
    <a href="2019-09-11_video-abstract-vision.ipynb" id="sourcelink" class="nav-link">Source</a>
    </li>


                    
            </ul></nav>
</div>
    </div>
</header><nav class="navbar navbar-expand-md navbar-light bg-white static-top"><div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
            <ul class="navbar-nav nav-fill d-flex w-100">
<li class="nav-item">
<a href="../index.html" class="nav-link">Home</a>
                </li>
<li class="nav-item">
<a href="../archive.html" class="nav-link">Archives</a>
                </li>
<li class="nav-item">
<a href="../categories/index.html" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="http://laurentperrinet.github.io" class="nav-link">About my research</a>
                </li>
<li class="nav-item">
<a href="https://twitter.com/laurentperrinet" class="nav-link">Twitter</a>
                </li>
<li class="nav-item">
<a href="https://github.com/laurentperrinet" class="nav-link">Github</a>

                
            </li>
</ul>
</div>
<!-- /.navbar-collapse -->
</nav>
</div>

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Video abstract for "An Adaptive Homeostatic Algorithm for the Unsupervised Learning of Visual Features"</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    Laurent Perrinet
            </span></p>
            <p class="dateline">
            <a href="#" rel="bookmark">
            <time class="published dt-published" datetime="2019-09-11T10:06:52+02:00" itemprop="datePublished" title="2019-09-11 10:06">2019-09-11 10:06</time></a>
            </p>
                <p class="commentline">
        
    <a href="2019-09-11_video-abstract-vision.html#disqus_thread" data-disqus-identifier="cache/posts/2019-09-11_video-abstract-vision.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="2019-09-11_video-abstract-vision.ipynb" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This video shows the results of unsupervised learning with different type of kezrnel normalization. This is to illustrate the results obtained in this <a href="https://laurentperrinet.github.io/publication/perrinet-19">paper on the An Adaptive Homeostatic Algorithm for the Unsupervised Learning of Visual Features</a> which is now in press.</p>
<p><br></p>
<p></p>
<center><video controls autoplay loop src="../files/2019-09-11_Perrinet19.mp4" width="61.8%/"></video></center>
<br><!-- TEASER_END -->
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">ls</span> -ltr /tmp/cache_dir
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">ls</span> -ltr /tmp/2019-09-11*
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>ls: /tmp/2019-09-11*: No such file or directory
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">rm</span> /tmp/cache_dir/*lock* 
<span class="c1">#%rm/tmp/2019-09-11*</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>rm: /tmp/cache_dir/*lock*: No such file or directory
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#initialize</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">shl_scripts.shl_experiments</span> <span class="k">import</span> <span class="n">SHL</span>
<span class="c1">#from shl_scripts import sparse_encode</span>
<span class="n">name</span> <span class="o">=</span> <span class="s1">'2019-09-11_Perrinet19'</span>

<span class="n">datapath</span> <span class="o">=</span> <span class="s1">'/tmp/database'</span>
<span class="n">opts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">datapath</span><span class="o">=</span><span class="n">datapath</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cache_dir</span><span class="o">=</span><span class="s1">'/tmp/cache_dir'</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
<span class="n">shl</span> <span class="o">=</span> <span class="n">SHL</span><span class="p">(</span><span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">shl</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">matname</span><span class="o">=</span><span class="n">f</span><span class="s1">'</span><span class="si">{name}</span><span class="s1">_data'</span><span class="p">)</span>

<span class="c1"># running main simulations</span>
<span class="c1"># Figure 1 &amp; 3</span>
<span class="n">N_cv</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">homeo_methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'None'</span><span class="p">,</span> <span class="s1">'OLS'</span><span class="p">,</span> <span class="s1">'HEH'</span><span class="p">,</span> <span class="s1">'HAP'</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'black'</span><span class="p">,</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="s1">'blue'</span><span class="p">,</span> <span class="s1">'red'</span><span class="p">]</span>

<span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">N_step</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.</span> <span class="p">)</span> <span class="o">/</span><span class="mi">2</span>
<span class="n">base_iter</span> <span class="o">=</span> <span class="n">phi</span>

<span class="n">fig_width</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">dpi_export</span> <span class="o">=</span> <span class="mi">300</span>


<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="k">def</span> <span class="nf">plot_dico</span><span class="p">(</span><span class="n">dico</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">dim_graph</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)):</span>
    <span class="n">subplotpars</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=.</span><span class="mi">95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">top</span><span class="o">=.</span><span class="mi">95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_width</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">phi</span><span class="p">)),</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">subplotpars</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="s1">'w'</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">'w'</span><span class="p">)</span>
        
    <span class="kn">from</span> <span class="nn">shl_scripts</span> <span class="k">import</span> <span class="n">show_dico</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">show_dico</span><span class="p">(</span><span class="n">shl</span><span class="p">,</span> <span class="n">dico</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">dim_graph</span><span class="o">=</span><span class="n">dim_graph</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="kc">False</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">shl_scripts</span> <span class="k">import</span> <span class="n">plot_P_cum</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_P_cum</span><span class="p">(</span><span class="n">dico</span><span class="o">.</span><span class="n">P_cum</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">1.001</span><span class="p">,</span> 
                             <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">'non-linear functions'</span><span class="p">,</span> 
                             <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_yticks</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">02</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">homeo_method</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">6</span><span class="p">)</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">shl_scripts</span> <span class="k">import</span> <span class="n">plot_proba_histogram</span>
        <span class="n">coding</span> <span class="o">=</span> <span class="n">shl</span><span class="o">.</span><span class="n">code</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dico</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_proba_histogram</span><span class="p">(</span><span class="n">coding</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">homeo_method</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">6</span><span class="p">)</span>
    <span class="c1"># ax.set_ylabel(homeo_method)</span>

    <span class="c1">#ax.text(-8, 7*dim_graph[0], homeo_method, fontsize=12, color='k', rotation=90)#, backgroundcolor='white'</span>
    <span class="c1">#axs[1].legend(loc='lower right')</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span>
    
    
<span class="kn">from</span> <span class="nn">shl_scripts.shl_experiments</span> <span class="k">import</span> <span class="n">SHL_set</span>
<span class="k">for</span> <span class="n">homeo_method</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">homeo_methods</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'=&gt; homeo_method=</span><span class="si">{homeo_method}</span><span class="s1">'</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_step</span><span class="p">):</span>
        
        <span class="n">opts_</span> <span class="o">=</span> <span class="n">opts</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">n_iter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">base_iter</span><span class="o">**</span><span class="n">i_step</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i_step</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">d_iter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">base_iter</span><span class="o">**</span><span class="n">i_step</span> <span class="o">-</span> <span class="n">base_iter</span><span class="o">**</span><span class="p">(</span><span class="n">i_step</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d_iter</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'==&gt; i_iter=</span><span class="si">{i_step}</span><span class="s1"> / n_iter=</span><span class="si">{n_iter}</span><span class="s1">'</span><span class="p">)</span>
        <span class="n">opts_</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">homeo_method</span><span class="o">=</span><span class="n">homeo_method</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="n">d_iter</span><span class="p">,)</span>

        <span class="n">shl</span> <span class="o">=</span> <span class="n">SHL</span><span class="p">(</span><span class="o">**</span><span class="n">opts</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i_step</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">dictionary</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dictionary</span> <span class="o">=</span> <span class="n">shl</span><span class="o">.</span><span class="n">learn_dico</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">matname</span><span class="o">=</span><span class="n">f</span><span class="s1">'</span><span class="si">{name}</span><span class="s1">_</span><span class="si">{homeo_method}</span><span class="s1">_{i_step-1}'</span><span class="p">,</span> <span class="n">list_figures</span><span class="o">=</span><span class="p">[])</span><span class="o">.</span><span class="n">dictionary</span>
            
        <span class="n">dico</span> <span class="o">=</span> <span class="n">shl</span><span class="o">.</span><span class="n">learn_dico</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">dictionary</span><span class="o">=</span><span class="n">dictionary</span><span class="p">,</span> <span class="n">matname</span><span class="o">=</span><span class="n">f</span><span class="s1">'</span><span class="si">{name}</span><span class="s1">_</span><span class="si">{homeo_method}</span><span class="s1">_</span><span class="si">{i_step}</span><span class="s1">'</span><span class="p">,</span> <span class="n">list_figures</span><span class="o">=</span><span class="p">[])</span>
            

        <span class="n">figname</span> <span class="o">=</span> <span class="n">f</span><span class="s1">'/tmp/</span><span class="si">{name}</span><span class="s1">_</span><span class="si">{homeo_method}</span><span class="s1">_</span><span class="si">{i_step}</span><span class="s1">.png'</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">figname</span><span class="p">):</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plot_dico</span><span class="p">(</span><span class="n">dico</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="n">f</span><span class="s1">'homeo_method=</span><span class="si">{homeo_method}</span><span class="s1">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="c1">#, backgroundcolor='white'</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">.</span><span class="mi">7</span><span class="p">,</span> <span class="o">.</span><span class="mi">65</span><span class="p">,</span> <span class="n">f</span><span class="s1">'n_iter=</span><span class="si">{n_iter}</span><span class="s1">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="c1">#, backgroundcolor='white'</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figname</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi_export</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">'tight'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>=&gt; homeo_method=None
==&gt; i_iter=0 / n_iter=2
</pre>
</div>
</div>

</div>
</div>

</div>#initialize
from shl_scripts.shl_experiments import SHL
name = '2019-09-11_Perrinet19'

datapath = '/tmp/database'
opts = dict(datapath=datapath, verbose=0, cache_dir='/tmp/cache_dir', n_iter=2**5 + 1,)
shl = SHL(**opts)
data = shl.get_data(matname=f'{name}_data')

# running main simulations
# Figure 1 &amp; 3
N_cv = 1
homeo_methods = ['HAP']
colors = ['black', 'orange', 'blue', 'red']

seed = 42
n_jobs = 1


import numpy as np
np.set_printoptions(precision=2, suppress=True)
np.random.seed(seed)

    
from shl_scripts.shl_experiments import SHL_set
for homeo_method, color in zip(homeo_methods, colors):
    print(f'=&gt; homeo_method={homeo_method}')
    for i_step in range(7):
        opts_ = opts.copy()
        n_iter = 2**i_step + 1
        if i_step&gt;0:
            d_iter = 2**i_step - 2**(i_step-1)
        else:
            d_iter = 1
        print(f'==&gt; i_iter={i_step} / n_iter={n_iter}')
        opts_.update(homeo_method=homeo_method, n_iter=d_iter,)

        shl = SHL(**opts)
        if i_step==0:
            dictionary = None
        else:
            dictionary = shl.learn_dico(data=data, matname=f'{name}_{homeo_method}_{i_step-1}', list_figures=[]).dictionary
            
        dico = shl.learn_dico(data=data, dictionary=dictionary, matname=f'{name}_{homeo_method}_{i_step}', list_figures=[])
            


<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Creating the movie using the (excellent) <a href="http://zulko.github.io/moviepy/index.html">MoviePy</a> library:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vext</span> <span class="o">=</span> <span class="s1">'mp4'</span>

<span class="kn">from</span> <span class="nn">moviepy.editor</span> <span class="k">import</span> <span class="n">ImageSequenceClip</span>

<span class="k">for</span> <span class="n">homeo_method</span> <span class="ow">in</span> <span class="n">homeo_methods</span><span class="p">:</span>
    <span class="n">clip</span> <span class="o">=</span> <span class="n">ImageSequenceClip</span><span class="p">([</span><span class="n">f</span><span class="s1">'/tmp/</span><span class="si">{name}</span><span class="s1">_</span><span class="si">{homeo_method}</span><span class="s1">_</span><span class="si">{i_step}</span><span class="s1">.png'</span> <span class="k">for</span> <span class="n">i_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_step</span><span class="p">)],</span> <span class="n">fps</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">clip</span><span class="o">.</span><span class="n">write_videofile</span><span class="p">(</span><span class="n">f</span><span class="s1">'/tmp/</span><span class="si">{name}</span><span class="s1">_</span><span class="si">{homeo_method}</span><span class="s1">.</span><span class="si">{vext}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Annotating the movie using the (excellent) <a href="http://zulko.github.io/moviepy/index.html">MoviePy</a> library:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">moviepy.editor</span> <span class="k">import</span> <span class="n">ImageClip</span><span class="p">,</span> <span class="n">TextClip</span><span class="p">,</span> <span class="n">CompositeVideoClip</span>

<span class="n">clip</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="n">texts</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"An Adaptive Homeostatic Algorithm</span><span class="se">\n</span><span class="s2"> for the Unsupervised Learning</span><span class="se">\n</span><span class="s2"> of Visual Features"</span><span class="p">,</span>
    <span class="s2">"https://laurentperrinet.github.io/publication/perrinet-19"</span><span class="p">]</span>
<span class="k">for</span> <span class="n">text</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">txt_clip</span> <span class="o">=</span> <span class="n">TextClip</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">txt_opts</span><span class="p">)</span>
    <span class="n">txt_clip</span> <span class="o">=</span> <span class="n">txt_clip</span><span class="o">.</span><span class="n">set_start</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">set_pos</span><span class="p">(</span><span class="s1">'center'</span><span class="p">)</span><span class="o">.</span><span class="n">set_duration</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">clip</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">txt_clip</span><span class="p">)</span>
    
<span class="n">texts</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"No homeostasis"</span><span class="p">,</span> <span class="s2">"Olshausen (1997)"</span><span class="p">,</span> <span class="s2">"Histogram Equalization"</span><span class="p">,</span> <span class="s2">"Activation Probability"</span><span class="p">]</span>
<span class="n">subtitles</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">subtitles</span><span class="p">[</span><span class="s1">'None'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">'I show here the result of learning...'</span><span class="p">,</span>
    <span class="s1">'... evolving with the number of iterations  ...'</span><span class="p">,</span>
    <span class="s1">'... on the left the receptive fields (kernels) ...'</span><span class="p">,</span>
    <span class="s1">'... by showing 64 randomly picked from the 661 cells ...'</span><span class="p">,</span>
    <span class="s1">'... and on the right histogram of activation probability.'</span><span class="p">,</span>
    <span class="s1">'... After some iterations, edge-like filters appear ...'</span><span class="p">,</span>
    <span class="s1">'... but the histogram shows a desequilibrium in the ...'</span><span class="p">,</span>
    <span class="s1">'... activation probability, even though  ...'</span><span class="p">,</span>
    <span class="s1">'... the norm of the kerenals are normalized.'</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">subtitles</span><span class="p">[</span><span class="s1">'OLS'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">'The original homeostasis algorithm developped ...'</span><span class="p">,</span>
    <span class="s1">'... by Olshausen and Field (1997) included a more  ...'</span><span class="p">,</span>
    <span class="s1">'... elaborated adaptation based on the variance of ...'</span><span class="p">,</span>
    <span class="s1">'... the coefficients, yielding a better balance...'</span><span class="p">,</span>
    <span class="s1">'...  ...'</span><span class="p">,</span>
    <span class="s1">'Still, this causes an under-optimisation of the ... '</span><span class="p">,</span>
    <span class="s1">'... sparse code as some are a priori ...'</span><span class="p">,</span>
    <span class="s1">'... more likely to be selected than ...'</span><span class="p">,</span>
    <span class="s1">'... others ...'</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">subtitles</span><span class="p">[</span><span class="s1">'HEH'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">'Such an objective can be simply optimzed...'</span><span class="p">,</span>
    <span class="s1">'... by introducing an adaptive non-linearity in our ...'</span><span class="p">,</span>
    <span class="s1">'... sparse coding algorithm. This non-linearity  ...'</span><span class="p">,</span>
    <span class="s1">'... is based on the concept of histogram normalization ...'</span><span class="p">,</span>
    <span class="s1">'... to make sure that all neurons are always picked up.'</span><span class="p">,</span>
    <span class="s1">'...  with a priori the same probability ...'</span><span class="p">,</span>
    <span class="s1">'... We called this Histogram Equalization Homeostasis ...'</span><span class="p">,</span>
    <span class="s1">'... and it effectively works very well, as well ...'</span><span class="p">,</span>
    <span class="s1">'... qualitatively (left) than quantitatively (right).'</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">subtitles</span><span class="p">[</span><span class="s1">'HAP'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">'A problem of Histogram Equalization Homeostasis ...'</span><span class="p">,</span>
    <span class="s1">'... is that it is computationally more expensive  ...'</span><span class="p">,</span>
    <span class="s1">'... and less plausible to be implemented in real ...'</span><span class="p">,</span>
    <span class="s1">'...  biological neurons. We thus explored another...'</span><span class="p">,</span>
    <span class="s1">'... algorithm simply based on the activation probability.'</span><span class="p">,</span>
    <span class="s1">'This Homeostasis on the Activation Probability  ... '</span><span class="p">,</span>
    <span class="s1">'... performed qualitatively as well as HEH ...'</span><span class="p">,</span>
    <span class="s1">'... and also quantitatively similarly ...'</span><span class="p">,</span>
    <span class="s1">'Yet it comes at a very low cost compatible with biomimetic algorithms'</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">txt_opts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s2">"Amiri-Bold"</span><span class="p">,</span> <span class="n">stroke_color</span><span class="o">=</span><span class="s1">'gray'</span><span class="p">,</span> <span class="n">stroke_width</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>

<span class="k">for</span> <span class="n">homeo_method</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">homeo_methods</span><span class="p">,</span> <span class="n">texts</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'=&gt; homeo_method=</span><span class="si">{homeo_method}</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">txt_clip</span> <span class="o">=</span> <span class="n">TextClip</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">txt_opts</span><span class="p">)</span>
    <span class="n">txt_clip</span> <span class="o">=</span> <span class="n">txt_clip</span><span class="o">.</span><span class="n">set_start</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">set_pos</span><span class="p">(</span><span class="s1">'center'</span><span class="p">)</span><span class="o">.</span><span class="n">set_duration</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">clip</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">txt_clip</span><span class="p">)</span>
    
    <span class="c1">#clip = [VideoFileClip(f'{name}_{homeo_method}.{vext}')]</span>
    
    <span class="k">for</span> <span class="n">i_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_step</span><span class="p">):</span>
        <span class="n">im_clip</span> <span class="o">=</span> <span class="n">ImageClip</span><span class="p">(</span><span class="n">f</span><span class="s1">'/tmp/</span><span class="si">{name}</span><span class="s1">_</span><span class="si">{homeo_method}</span><span class="s1">_</span><span class="si">{i_step}</span><span class="s1">.png'</span><span class="p">)</span>
        <span class="n">clip</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">im_clip</span><span class="p">)</span>


<span class="c1"># Overlay the text clip on the first video clip</span>
<span class="n">video</span> <span class="o">=</span> <span class="n">CompositeVideoClip</span><span class="p">(</span><span class="n">clip</span><span class="p">)</span>

<span class="c1"># Write the result to a file (many options available !)</span>
<span class="n">video</span><span class="o">.</span><span class="n">write_videofile</span><span class="p">(</span><span class="n">f</span><span class="s1">'</span><span class="si">{name}</span><span class="s1">.</span><span class="si">{vext}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="some-book-keeping-for-the-notebook">some book keeping for the notebook<a class="anchor-link" href="2019-09-11_video-abstract-vision.html#some-book-keeping-for-the-notebook">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<p></p>
<center><video controls autoplay loop src="../files/2019-09-11_Perrinet19.mp4" width="61.8%/"></video></center>
<br>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> version_information
<span class="o">%</span><span class="k">version_information</span> numpy, scipy, matplotlib, MotionClouds
</pre></div>

    </div>
</div>
</div>

</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../categories/sparse-coding.html" rel="tag">sparse-coding</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="2019-05-28_MainenSejnowski1995.html" rel="prev" title="Mainen &amp; Sejnowski, 1995">Previous post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="invibe",
            disqus_url="https://laurentperrinet.github.io/sciblog/posts/2019-09-11_video-abstract-vision.html",
        disqus_title="Video abstract for \"An Adaptive Homeostatic Algorithm for the Unsupervised Learning of Visual Features\"",
        disqus_identifier="cache/posts/2019-09-11_video-abstract-vision.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha256-SDRP1VVYu+tgAGKhddBSl5+ezofHKZeI+OzxakbIe/Y=" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    },
    displayAlign: 'center', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script></article><script>var disqus_shortname="invibe";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><!--End of body content--><footer id="footer">
            Contents © 2019 <a href="mailto:laurent.perrinet@univ-amu.fr">Laurent Perrinet</a> -
Powered by <a href="http://getnikola.com">Nikola</a> with <a href="https://themes.getnikola.com/v7/maupassant/">Maupassant</a> theme <br><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/ar/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="http://i.creativecommons.org/l/by-nc-sa/2.5/ar/88x31.png"></a>
            
        </footer>
</div>
</div>


        <script src="../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
