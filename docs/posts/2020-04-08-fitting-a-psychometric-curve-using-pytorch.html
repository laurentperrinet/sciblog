<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>2020-04-08 fitting a psychometric curve using pyTorch | Scientific logbook</title>
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml">
<link rel="canonical" href="https://laurentperrinet.github.io/sciblog/posts/2020-04-08-fitting-a-psychometric-curve-using-pytorch.html">
<link rel="icon" href="favicon.ico" sizes="16x16">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    },
    displayAlign: 'center', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script><!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]--><meta name="author" content="Laurent Perrinet">
<link rel="prev" href="2020-01-08-changing-the-global-phase-of-a-motion-cloud.html" title="Changing the global phase of a Motion Cloud" type="text/html">
<meta property="og:site_name" content="Scientific logbook">
<meta property="og:title" content="2020-04-08 fitting a psychometric curve using pyTorch">
<meta property="og:url" content="https://laurentperrinet.github.io/sciblog/posts/2020-04-08-fitting-a-psychometric-curve-using-pytorch.html">
<meta property="og:description" content="The goal here is to compare methods which fit data with psychometric curves using logistic regression. Indeed, after (long) experiments where for instance you collected sequences of keypresses, it is ">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-04-08T16:29:06+02:00">
<meta property="article:tag" content="numpy">
<meta property="article:tag" content="open-science">
<meta property="article:tag" content="orientation">
<meta property="article:tag" content="psychophysics">
<meta property="article:tag" content="pytorch">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Header and menu bar -->
<div class="container">
      <header class="blog-header py-3"><div class="row nbb-header align-items-center">
          <div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;">
            <button class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" type="button" data-toggle="collapse" data-target=".bs-nav-collapsible" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse bs-nav-collapsible bootblog4-search-form-holder">
                
<!-- Custom search -->
<form method="get" id="search" action="//duckduckgo.com/" class="navbar-form pull-left">
<input type="hidden" name="sites" value="https://laurentperrinet.github.io/sciblog/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Search…" class="span2" style="margin-top: 4px;"><input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
<!-- End of custom search -->

            </div>
        </div>
          <div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;">
            <a class="navbar-brand blog-header-logo text-dark" href="https://laurentperrinet.github.io/sciblog/">

            <span id="blog-title">Scientific logbook</span>
        </a>
          </div>
            <div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
            <nav class="navbar navbar-light bg-white"><ul class="navbar-nav bootblog4-right-nav">
<li class="nav-item">
    <a href="2020-04-08-fitting-a-psychometric-curve-using-pytorch.ipynb" id="sourcelink" class="nav-link">Source</a>
    </li>


                    
            </ul></nav>
</div>
    </div>
</header><nav class="navbar navbar-expand-md navbar-light bg-white static-top"><div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
            <ul class="navbar-nav nav-fill d-flex w-100">
<li class="nav-item">
<a href="../index.html" class="nav-link">Home</a>
                </li>
<li class="nav-item">
<a href="../archive.html" class="nav-link">Archives</a>
                </li>
<li class="nav-item">
<a href="../categories/index.html" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="http://laurentperrinet.github.io" class="nav-link">About my research</a>
                </li>
<li class="nav-item">
<a href="https://twitter.com/laurentperrinet" class="nav-link">Twitter</a>
                </li>
<li class="nav-item">
<a href="https://github.com/laurentperrinet" class="nav-link">Github</a>

                
            </li>
</ul>
</div>
<!-- /.navbar-collapse -->
</nav>
</div>

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">2020-04-08 fitting a psychometric curve using pyTorch</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Laurent Perrinet
            </span></p>
            <p class="dateline">
            <a href="#" rel="bookmark">
            <time class="published dt-published" datetime="2020-04-08T16:29:06+02:00" itemprop="datePublished" title="2020-04-08 16:29">2020-04-08 16:29</time></a>
            </p>
                <p class="commentline">
        
    <a href="2020-04-08-fitting-a-psychometric-curve-using-pytorch.html#disqus_thread" data-disqus-identifier="cache/posts/2020-04-08-fitting-a-psychometric-curve-using-pytorch.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="2020-04-08-fitting-a-psychometric-curve-using-pytorch.ipynb" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The goal here is to compare methods which fit data with psychometric curves using logistic regression. Indeed, after (long) experiments where for instance you collected sequences of keypresses, it is important to infer at best the parameters of the underlying processes: was the observer biased, was she more precise? While I was <em>forevever</em> using <a href="https://scikit-learn.org/stable/index.html">sklearn</a> and praised it's beautifully crafted methods, I lacked some flexibility in the definition of the model. This notebook was done in collaboration with <a href="https://github.com/jennafradin">Jenna Fradin</a>, master student in the lab.</p>
<p>Here, I define a similar fitting method using <a href="https://pytorch.org/">pytorch</a> which fits in a few lines of code :</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">TensorDataset</span><span class="p">,</span> <span class="n">DataLoader</span>
<span class="n">torch</span><span class="o">.</span><span class="n">set_default_tensor_type</span><span class="p">(</span><span class="s1">'torch.DoubleTensor'</span><span class="p">)</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">BCELoss</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="s1">'sum'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">LogisticRegressionModel</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">logit0</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span> 
        <span class="nb">super</span><span class="p">(</span><span class="n">LogisticRegressionModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">)</span>    
        <span class="bp">self</span><span class="o">.</span><span class="n">logit0</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">logit0</span><span class="o">*</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
        <span class="n">p0</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logit0</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">p0</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p0</span><span class="p">)</span><span class="o">*</span><span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">out</span>

<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="n">beta1</span><span class="p">,</span> <span class="n">beta2</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.999</span>
<span class="n">betas</span> <span class="o">=</span> <span class="p">(</span><span class="n">beta1</span><span class="p">,</span> <span class="n">beta2</span><span class="p">)</span>
<span class="n">num_epochs</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">11</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="o">.</span><span class="mi">05</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">num_epochs</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">fit_data</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
                <span class="n">learning_rate</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="n">gamma</span><span class="p">,</span>
                <span class="n">num_epochs</span><span class="o">=</span><span class="n">num_epochs</span><span class="p">,</span> <span class="n">betas</span><span class="o">=</span><span class="n">betas</span><span class="p">,</span>
                <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

    <span class="n">Theta</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">theta</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]),</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span>
    <span class="n">loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">TensorDataset</span><span class="p">(</span><span class="n">Theta</span><span class="p">,</span> <span class="n">labels</span><span class="p">),</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cuda"</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">"cpu"</span><span class="p">)</span>
    
    <span class="n">logistic_model</span> <span class="o">=</span> <span class="n">LogisticRegressionModel</span><span class="p">()</span>
    <span class="n">logistic_model</span> <span class="o">=</span> <span class="n">logistic_model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="n">logistic_model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">logistic_model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">,</span> <span class="n">betas</span><span class="o">=</span><span class="n">betas</span><span class="p">)</span>
    <span class="n">scheduler</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">StepLR</span><span class="p">(</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="n">gamma</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_epochs</span><span class="p">)):</span>
        <span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">Theta_</span><span class="p">,</span> <span class="n">labels_</span> <span class="ow">in</span> <span class="n">loader</span><span class="p">:</span>
            <span class="n">Theta_</span><span class="p">,</span> <span class="n">labels_</span> <span class="o">=</span> <span class="n">Theta_</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">labels_</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="n">logistic_model</span><span class="p">(</span><span class="n">Theta_</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">labels_</span><span class="p">)</span>
            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
            <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
        
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">and</span> <span class="p">(</span><span class="n">epoch</span> <span class="o">%</span> <span class="p">(</span><span class="n">num_epochs</span><span class="o">//</span><span class="mi">32</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Iteration: </span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="s2"> - Loss: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        
    <span class="n">logistic_model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">Theta</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">theta</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]),</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">logistic_model</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">logistic_model</span><span class="p">,</span> <span class="n">loss</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>and run a series of tests to compare both methods.</p>
<!-- TEASER_END -->

<p>Let's first initialize the notebook:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">rcParams</span>
<span class="c1">#print(rcParams)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">'font.size'</span><span class="p">]</span> <span class="o">=</span> <span class="n">fontsize</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">'legend.fontsize'</span><span class="p">]</span> <span class="o">=</span> <span class="n">fontsize</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">'axes.labelsize'</span><span class="p">]</span> <span class="o">=</span> <span class="n">fontsize</span>
    
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Some hyper parameters which we will tune later:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">256</span>
<span class="c1">#batch_size = N//4</span>
<span class="c1">#batch_size = N//2</span>

<span class="n">N_cv</span> <span class="o">=</span> <span class="mi">10</span>
<span class="c1"># N_cv = 2</span>

<span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">N_scan</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">N_test</span> <span class="o">=</span> <span class="mi">2000</span> <span class="c1"># number of points for validation</span>

<span class="n">bias</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">p0</span> <span class="o">=</span> <span class="mf">0.1</span>       
<span class="n">theta0</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">wt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">16</span>
<span class="n">theta_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="problem-statement:-a-2aFC-task-on-synthetic-data">problem statement: a 2aFC task on synthetic data<a class="anchor-link" href="2020-04-08-fitting-a-psychometric-curve-using-pytorch.html#problem-statement:-a-2aFC-task-on-synthetic-data">¶</a>
</h3>
<p>We will generate a typical setup where we have to guess for the otientation of a visual display compared to the vertical and ask observer to either press on the <code>left</code> or <code>right</code> arrows. The visual display will be controlled by a $theta$ parameter which we draw randomly according to a Gaussian probability density function. This may be synthesized in the following <em>psychometric</em> function:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">psychometric_function</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">p0</span><span class="p">,</span> <span class="n">theta0</span><span class="o">=</span><span class="n">theta0</span><span class="p">,</span> <span class="n">wt</span><span class="o">=</span><span class="n">wt</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p0</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">theta</span><span class="o">-</span><span class="n">theta0</span><span class="p">)</span><span class="o">/</span><span class="n">wt</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>such that we can draw the data according to:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">N</span><span class="p">,</span>
            <span class="n">p0</span> <span class="o">=</span> <span class="n">p0</span><span class="p">,</span>
            <span class="n">theta0</span> <span class="o">=</span> <span class="n">theta0</span><span class="p">,</span>
            <span class="n">wt</span> <span class="o">=</span> <span class="n">wt</span><span class="p">,</span>
            <span class="n">theta_std</span> <span class="o">=</span> <span class="n">theta_std</span><span class="p">,</span>
            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">):</span>    
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">theta_std</span>
    
    <span class="n">p</span> <span class="o">=</span> <span class="n">psychometric_function</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">theta0</span><span class="p">,</span> <span class="n">wt</span><span class="p">)</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">p</span> <span class="c1">#generate data</span>
    <span class="k">return</span> <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>it
<span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>70.4 µs ± 8.73 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">()</span>
<span class="n">logistic_model</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">fit_data</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Final loss ="</span><span class="p">,</span> <span class="n">loss</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Iteration: 0 - Loss: 0.88468
Iteration: 64 - Loss: 0.55394
Iteration: 128 - Loss: 0.46764
Iteration: 192 - Loss: 0.45594
Iteration: 256 - Loss: 0.45391
Iteration: 320 - Loss: 0.45348
Iteration: 384 - Loss: 0.45334
Iteration: 448 - Loss: 0.45325
Iteration: 512 - Loss: 0.45320
Iteration: 576 - Loss: 0.45311
Iteration: 640 - Loss: 0.45304
Iteration: 704 - Loss: 0.45297
Iteration: 768 - Loss: 0.45290
Iteration: 832 - Loss: 0.45286
Iteration: 896 - Loss: 0.45281
Iteration: 960 - Loss: 0.45275
Iteration: 1024 - Loss: 0.45272
Iteration: 1088 - Loss: 0.45268
Iteration: 1152 - Loss: 0.45266
Iteration: 1216 - Loss: 0.45263
Iteration: 1280 - Loss: 0.45260
Iteration: 1344 - Loss: 0.45258
Iteration: 1408 - Loss: 0.45257
Iteration: 1472 - Loss: 0.45256
Iteration: 1536 - Loss: 0.45254
Iteration: 1600 - Loss: 0.45253
Iteration: 1664 - Loss: 0.45252
Iteration: 1728 - Loss: 0.45251
Iteration: 1792 - Loss: 0.45250
Iteration: 1856 - Loss: 0.45250
Iteration: 1920 - Loss: 0.45249
Iteration: 1984 - Loss: 0.45248
Iteration: 2048 - Loss: 0.45248
Final loss = 0.452475408017086
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'p0 = </span><span class="si">{</span><span class="n">p0</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, theta0 = </span><span class="si">{</span><span class="n">theta0</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, wt = </span><span class="si">{</span><span class="n">wt</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, theta_std = </span><span class="si">{</span><span class="n">theta_std</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>p0 = 0.100, theta0 = 0.000, wt = 0.196, theta_std = 0.785
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_params</span><span class="p">(</span><span class="n">logistic_model</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">theta0_</span> <span class="o">=</span> <span class="o">-</span><span class="n">logistic_model</span><span class="o">.</span><span class="n">linear</span><span class="o">.</span><span class="n">bias</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">/</span><span class="n">logistic_model</span><span class="o">.</span><span class="n">linear</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">wt_</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">logistic_model</span><span class="o">.</span><span class="n">linear</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">p0_</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">logistic_model</span><span class="o">.</span><span class="n">logit0</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bias</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'theta0 = </span><span class="si">{</span><span class="n">theta0_</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span> <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'slope = </span><span class="si">{</span><span class="n">wt_</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>    
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'p0 = </span><span class="si">{</span><span class="n">p0_</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>        
    <span class="k">return</span> <span class="n">theta0_</span><span class="p">,</span> <span class="n">wt_</span><span class="p">,</span> <span class="n">p0_</span>

<span class="n">theta0_</span><span class="p">,</span> <span class="n">wt_</span><span class="p">,</span> <span class="n">p0_</span> <span class="o">=</span> <span class="n">get_params</span><span class="p">(</span><span class="n">logistic_model</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>theta0 = 0.037
slope = 0.278
p0 = 0.092
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That method is fairly quick, in under 2 seconds:</p>

</div>
</div>
</div>%%timeit
logistic_model, loss = fit_data(theta, y, verbose=False)
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>let's do the same thing with <code>sklearn</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="n">tol</span> <span class="o">=</span> <span class="mf">1.e-4</span>
<span class="n">C</span> <span class="o">=</span> <span class="mf">3.0</span>
<span class="k">def</span> <span class="nf">fit_data_sklearn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
                <span class="n">num_epochs</span><span class="o">=</span><span class="n">num_epochs</span><span class="p">,</span>
                <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> 
                <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">logistic_model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">'liblinear'</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="n">num_epochs</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">logistic_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">theta</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">y</span><span class="p">)</span>
    
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">logistic_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">theta</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">outputs_</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">outputs</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]),</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs_</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">"Loss ="</span><span class="p">,</span> <span class="n">loss</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">logistic_model</span><span class="p">,</span> <span class="n">loss</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">fit_data_sklearn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Loss = 0.4547978375080631
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_params_sk</span><span class="p">(</span><span class="n">logistic_model</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    
    <span class="n">theta0_</span> <span class="o">=</span> <span class="o">-</span><span class="n">logistic_model</span><span class="o">.</span><span class="n">intercept_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">logistic_model</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">wt_</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">logistic_model</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bias</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'theta0 = </span><span class="si">{</span><span class="n">theta0_</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span> <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'slope = </span><span class="si">{</span><span class="n">wt_</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>    
    <span class="k">return</span> <span class="n">theta0_</span><span class="p">,</span> <span class="n">wt_</span>

<span class="n">theta0_</span><span class="p">,</span> <span class="n">wt_</span> <span class="o">=</span> <span class="n">get_params_sk</span><span class="p">(</span><span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>theta0 = 0.039
slope = 0.379
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That method is <em>much</em> quicker:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>it
<span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">fit_data_sklearn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>991 µs ± 237 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>... but what is the value of few seconds after hours of having observers sitting in front of a screen looking at (often boring) visual displays? More seriously, most important is the reliability of the values which are inferred by each respective method, such that they are correctly reflecting the information contained in the data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="qualitative-comparison-of-methods">qualitative comparison of methods<a class="anchor-link" href="2020-04-08-fitting-a-psychometric-curve-using-pytorch.html#qualitative-comparison-of-methods">¶</a>
</h3>
<p>We can synthesize this comparison by drawing a new dataset and plotting the psychometric curves which are obtained by each method</p>

</div>
</div>
</div>theta, p, y = get_data() # nouvelles données 
logistic_model, loss = fit_data(theta, y, verbose=False)
print(f'Training loss = {loss:.3f}')
logistic_model_sk, loss_sk = fit_data_sklearn(theta, y, verbose=False)
print(f'Training sklearn loss = {loss_sk:.3f}')
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'k'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'data points'</span><span class="p">)</span>
<span class="c1"># ax.scatter(theta, p, s=6, alpha=.4, color = 'b', label='hidden proba')</span>
<span class="n">x_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.50</span><span class="p">,</span> <span class="mi">100</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="n">y_values_p</span> <span class="o">=</span> <span class="n">psychometric_function</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">theta0</span><span class="p">,</span> <span class="n">wt</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">y_values_p</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'hidden proba'</span><span class="p">)</span>
<span class="n">y_values</span> <span class="o">=</span> <span class="n">logistic_model</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">x_values</span><span class="p">))</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">y_values</span><span class="p">,</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">7</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'torch'</span><span class="p">)</span>
<span class="n">y_values_sk</span> <span class="o">=</span> <span class="n">logistic_model_sk</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">x_values</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">y_values_sk</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">7</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'sklearn'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'orientation $\theta$'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">'Left'</span><span class="p">,</span> <span class="s1">'Right'</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scatterpoints</span><span class="o">=</span><span class="mi">6</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The losses which were computed above are those obtained during training. Relying on this value may be a dangerous strategy as the model may be overfitting the data. We should therefore measure how the model would generalize with novel data.</p>
<p>While it hard to do with real (experimental) data which are often scarse, here we synthesized the data and we can thus compute a testing loss by drawing again a set of new data and computing the loss on that data:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N_test</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">N_test</span><span class="p">)</span>    
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">loss_true</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span>        
    <span class="n">P</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">p</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">criterion</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Testing true loss = </span><span class="si">{</span><span class="n">loss_true</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Testing true loss = 0.404
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">logistic_model</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">fit_data</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Training loss = </span><span class="si">{</span><span class="n">loss</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Training loss = 0.403
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">loss_torch</span><span class="p">(</span><span class="n">logistic_model</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span>
    <span class="n">Theta</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">theta</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">p</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="n">logistic_model</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Testing loss = </span><span class="si">{</span><span class="n">loss_torch</span><span class="p">(</span><span class="n">logistic_model</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Testing loss = 0.403
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">loss_sk</span> <span class="o">=</span> <span class="n">fit_data_sklearn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Training sklearn loss = </span><span class="si">{</span><span class="n">loss_sk</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Training sklearn loss = 0.411
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">loss_sklearn</span><span class="p">(</span><span class="n">logistic_model</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">logistic_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">theta</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">outputs_</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">outputs</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]),</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs_</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Testing sklearn loss = </span><span class="si">{</span><span class="n">loss_sklearn</span><span class="p">(</span><span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Testing sklearn loss = 0.411
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="quantitative-comparison-of-methods-:-varrying-methods'-parameters">quantitative comparison of methods : varrying methods' parameters<a class="anchor-link" href="2020-04-08-fitting-a-psychometric-curve-using-pytorch.html#quantitative-comparison-of-methods-:-varrying-methods'-parameters">¶</a>
</h3>
<p>Let's study the influence of each method's meta-parameter, such as the number of iterations:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="influence-of-learning-rate">influence of learning rate<a class="anchor-link" href="2020-04-08-fitting-a-psychometric-curve-using-pytorch.html#influence-of-learning-rate">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learning_rates</span> <span class="o">=</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N_scan</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">learning_rates_</span><span class="p">,</span> <span class="n">losses</span><span class="p">,</span> <span class="n">loss_Ps</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">learning_rate_</span> <span class="ow">in</span> <span class="n">learning_rates</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i_CV</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_cv</span><span class="p">):</span>
        <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="p">)</span>

        <span class="n">logistic_model</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">fit_data</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="n">learning_rate_</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>        

        <span class="k">if</span> <span class="n">N_test</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N_test</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="o">+</span><span class="n">N_test</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_torch</span><span class="p">(</span><span class="n">logistic_model</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>            
        <span class="n">loss_P</span> <span class="o">=</span> <span class="n">loss_true</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">i_CV</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"learning_rate: </span><span class="si">{</span><span class="n">learning_rate_</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">, Loss: </span><span class="si">{</span><span class="n">loss</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">, loss_P: </span><span class="si">{</span><span class="n">loss_P</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">learning_rates_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">learning_rate_</span><span class="p">)</span>
        <span class="n">loss_Ps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_P</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
        <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>learning_rate: 0.00200, Loss: 0.48911, loss_P: 0.40406
learning_rate: 0.00356, Loss: 0.42687, loss_P: 0.40406
learning_rate: 0.00632, Loss: 0.41186, loss_P: 0.40406
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">opts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">'.'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">3</span><span class="o">/</span><span class="n">N_cv</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#influence du learning rate sur loss</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">learning_rates_</span><span class="p">,</span> <span class="n">losses</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'green'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'loss'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">learning_rates_</span><span class="p">,</span> <span class="n">loss_Ps</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'true'</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">learning_rates_</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">learning_rates_</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'learning_rate'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Loss'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">'log'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="influence-du-nombre-d'epochs">influence du nombre d'epochs<a class="anchor-link" href="2020-04-08-fitting-a-psychometric-curve-using-pytorch.html#influence-du-nombre-d'epochs">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">num_epochss</span> <span class="o">=</span> <span class="n">num_epochs</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N_scan</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">num_epochss_</span><span class="p">,</span> <span class="n">losses</span><span class="p">,</span> <span class="n">loss_Ps</span><span class="p">,</span> <span class="n">loss_SKLs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">num_epochs_</span> <span class="ow">in</span> <span class="n">num_epochss</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i_CV</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_cv</span><span class="p">):</span>
        
        <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="p">)</span>
        <span class="n">logistic_model</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">fit_data</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">num_epochs</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">num_epochs_</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">loss_SKL</span> <span class="o">=</span> <span class="n">fit_data_sklearn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">num_epochs</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">num_epochs_</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">N_test</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N_test</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="o">+</span><span class="n">N_test</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_torch</span><span class="p">(</span><span class="n">logistic_model</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>            
            <span class="n">loss_SKL</span> <span class="o">=</span> <span class="n">loss_sklearn</span><span class="p">(</span><span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">loss_P</span> <span class="o">=</span> <span class="n">loss_true</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                
        <span class="k">if</span> <span class="n">i_CV</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"num_epochs: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">num_epochs_</span><span class="p">)</span><span class="si">}</span><span class="s2">, Loss: </span><span class="si">{</span><span class="n">loss</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">, loss_P: </span><span class="si">{</span><span class="n">loss_P</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">, loss_SKL: </span><span class="si">{</span><span class="n">loss_SKL</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">num_epochss_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_epochs_</span><span class="p">)</span>
        <span class="n">loss_SKLs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_SKL</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
        <span class="n">loss_Ps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_P</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
        <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># influence du nbr d'epochs sur loss </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_epochss_</span><span class="p">,</span> <span class="n">losses</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'green'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'loss'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_epochss_</span><span class="p">,</span> <span class="n">loss_Ps</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'loss_P'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_epochss_</span><span class="p">,</span> <span class="n">loss_SKLs</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'loss_SKL'</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'# epochs'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Loss'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">'log'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="influence-of-minibatch-size">influence of minibatch size<a class="anchor-link" href="2020-04-08-fitting-a-psychometric-curve-using-pytorch.html#influence-of-minibatch-size">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch_sizes</span> <span class="o">=</span> <span class="n">N</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">N_scan</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">batch_sizes_</span><span class="p">,</span> <span class="n">losses</span><span class="p">,</span> <span class="n">loss_Ps</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">batch_size_</span> <span class="ow">in</span> <span class="n">batch_sizes</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i_CV</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_cv</span><span class="p">):</span>
        <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="p">)</span>

        <span class="n">logistic_model</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">fit_data</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">batch_size_</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">N_test</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N_test</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="o">+</span><span class="n">N_test</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_torch</span><span class="p">(</span><span class="n">logistic_model</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>            
        <span class="n">loss_P</span> <span class="o">=</span> <span class="n">loss_true</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">i_CV</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"batch_size: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">batch_size_</span><span class="p">)</span><span class="si">}</span><span class="s2">, Loss: </span><span class="si">{</span><span class="n">loss</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">, loss_P: </span><span class="si">{</span><span class="n">loss_P</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">, loss_SKL: </span><span class="si">{</span><span class="n">loss_SKL</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">batch_sizes_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch_size_</span><span class="p">)</span>
        <span class="n">loss_Ps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_P</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
        <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># influence de la taille du minibatch sur loss </span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">batch_sizes_</span><span class="p">,</span> <span class="n">losses</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'green'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'loss'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">batch_sizes_</span><span class="p">,</span> <span class="n">loss_Ps</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'true'</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'batch_size'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Loss '</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">'log'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="influence-of-beta1">influence of <code>beta1</code><a class="anchor-link" href="2020-04-08-fitting-a-psychometric-curve-using-pytorch.html#influence-of-beta1">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta1s</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">N_scan</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">beta1s_</span><span class="p">,</span> <span class="n">losses</span><span class="p">,</span> <span class="n">loss_Ps</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">beta1_</span> <span class="ow">in</span> <span class="n">beta1s</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i_CV</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_cv</span><span class="p">):</span>
        <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="p">)</span>
        
        <span class="n">logistic_model</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">fit_data</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">betas</span><span class="o">=</span><span class="p">(</span><span class="n">beta1_</span><span class="p">,</span> <span class="n">beta2</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">N_test</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N_test</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="o">+</span><span class="n">N_test</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_torch</span><span class="p">(</span><span class="n">logistic_model</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>            
        <span class="n">loss_P</span> <span class="o">=</span> <span class="n">loss_true</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">i_CV</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"beta1: </span><span class="si">{</span><span class="n">beta1_</span><span class="si">}</span><span class="s2">, Loss: </span><span class="si">{</span><span class="n">loss</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">, loss_P: </span><span class="si">{</span><span class="n">loss_P</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">beta1s_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">beta1_</span><span class="p">)</span>
        <span class="n">loss_Ps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_P</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
        <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beta1s_</span><span class="p">,</span> <span class="n">losses</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'green'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'loss'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beta1s_</span><span class="p">,</span> <span class="n">loss_Ps</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'true'</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'beta1'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Loss '</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">'log'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="influence-of-beta2">influence of <code>beta2</code><a class="anchor-link" href="2020-04-08-fitting-a-psychometric-curve-using-pytorch.html#influence-of-beta2">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta2s</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">N_scan</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">beta2s_</span><span class="p">,</span> <span class="n">losses</span><span class="p">,</span> <span class="n">loss_Ps</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">beta2_</span> <span class="ow">in</span> <span class="n">beta2s</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i_CV</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_cv</span><span class="p">):</span>
        <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="p">)</span>

        <span class="n">logistic_model</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">fit_data</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">betas</span><span class="o">=</span><span class="p">(</span><span class="n">beta1</span><span class="p">,</span> <span class="n">beta2_</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">N_test</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N_test</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="o">+</span><span class="n">N_test</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_torch</span><span class="p">(</span><span class="n">logistic_model</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>            
        <span class="n">loss_P</span> <span class="o">=</span> <span class="n">loss_true</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">i_CV</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"beta2: </span><span class="si">{</span><span class="n">beta2_</span><span class="si">}</span><span class="s2">, Loss: </span><span class="si">{</span><span class="n">loss</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">, loss_P: </span><span class="si">{</span><span class="n">loss_P</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">beta2s_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">beta2_</span><span class="p">)</span>
        <span class="n">loss_Ps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_P</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
        <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beta2s_</span><span class="p">,</span> <span class="n">losses</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'green'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'loss'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beta2s_</span><span class="p">,</span> <span class="n">loss_Ps</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'true'</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'beta1'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Loss '</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">'log'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="influence-of-C">influence of <code>C</code><a class="anchor-link" href="2020-04-08-fitting-a-psychometric-curve-using-pytorch.html#influence-of-C">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Cs</span> <span class="o">=</span> <span class="n">C</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N_scan</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">Cs_</span><span class="p">,</span> <span class="n">loss_Ps</span><span class="p">,</span> <span class="n">loss_SKLs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">C_</span> <span class="ow">in</span> <span class="n">Cs</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i_CV</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_cv</span><span class="p">):</span>
        <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="p">)</span>

        <span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">loss_SKL</span> <span class="o">=</span> <span class="n">fit_data_sklearn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="n">C_</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">N_test</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N_test</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="o">+</span><span class="n">N_test</span><span class="p">)</span>
            <span class="n">loss_SKL</span> <span class="o">=</span> <span class="n">loss_sklearn</span><span class="p">(</span><span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">loss_P</span> <span class="o">=</span> <span class="n">loss_true</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">i_CV</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"C: </span><span class="si">{</span><span class="n">C_</span><span class="si">}</span><span class="s2">, Loss: </span><span class="si">{</span><span class="n">loss</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">, loss_SKL: </span><span class="si">{</span><span class="n">loss_SKL</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            
        <span class="n">Cs_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">C_</span><span class="p">)</span>
        <span class="n">loss_SKLs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_SKL</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
        <span class="n">loss_Ps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_P</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cs_</span><span class="p">,</span> <span class="n">loss_Ps</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'true'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cs_</span><span class="p">,</span> <span class="n">loss_SKLs</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'loss_SKL'</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'C'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Loss '</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">'log'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="influence-of-tol">influence of <code>tol</code><a class="anchor-link" href="2020-04-08-fitting-a-psychometric-curve-using-pytorch.html#influence-of-tol">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tols</span> <span class="o">=</span> <span class="n">tol</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N_scan</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">tols_</span><span class="p">,</span> <span class="n">loss_Ps</span><span class="p">,</span> <span class="n">loss_SKLs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">tol_</span> <span class="ow">in</span> <span class="n">tols</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i_CV</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_cv</span><span class="p">):</span>
        <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="p">)</span>

        <span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">loss_SKL</span> <span class="o">=</span> <span class="n">fit_data_sklearn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol_</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">N_test</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N_test</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="o">+</span><span class="n">N_test</span><span class="p">)</span>
            <span class="n">loss_SKL</span> <span class="o">=</span> <span class="n">loss_sklearn</span><span class="p">(</span><span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">loss_P</span> <span class="o">=</span> <span class="n">loss_true</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">i_CV</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"tol: </span><span class="si">{</span><span class="n">tol_</span><span class="si">}</span><span class="s2">, Loss: </span><span class="si">{</span><span class="n">loss</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">, loss_SKL: </span><span class="si">{</span><span class="n">loss_SKL</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">tols_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tol_</span><span class="p">)</span>
        <span class="n">loss_SKLs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_SKL</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
        <span class="n">loss_Ps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_P</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tols_</span><span class="p">,</span> <span class="n">loss_Ps</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'true'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tols_</span><span class="p">,</span> <span class="n">loss_SKLs</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'loss_SKL'</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'tol'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Loss'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">'log'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="quantitative-comparison-of-methods-:-varrying-experimental-parameters">quantitative comparison of methods : varrying experimental parameters<a class="anchor-link" href="2020-04-08-fitting-a-psychometric-curve-using-pytorch.html#quantitative-comparison-of-methods-:-varrying-experimental-parameters">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="influence-of-number-of-trials">influence of number of trials<a class="anchor-link" href="2020-04-08-fitting-a-psychometric-curve-using-pytorch.html#influence-of-number-of-trials">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Ns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">N_scan</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">Ns_</span><span class="p">,</span> <span class="n">losses</span><span class="p">,</span> <span class="n">loss_Ps</span><span class="p">,</span> <span class="n">loss_SKLs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">N_</span> <span class="ow">in</span> <span class="n">Ns</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i_CV</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_cv</span><span class="p">):</span>
        <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">N_</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="p">)</span>
        
        <span class="n">logistic_model</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">fit_data</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">loss_SKL</span> <span class="o">=</span> <span class="n">fit_data_sklearn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">N_test</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N_test</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="o">+</span><span class="n">N_test</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_torch</span><span class="p">(</span><span class="n">logistic_model</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>            
            <span class="n">loss_SKL</span> <span class="o">=</span> <span class="n">loss_sklearn</span><span class="p">(</span><span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">loss_P</span> <span class="o">=</span> <span class="n">loss_true</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">i_CV</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"N: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">N_</span><span class="p">)</span><span class="si">}</span><span class="s2">, Loss: </span><span class="si">{</span><span class="n">loss</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">, loss_P: </span><span class="si">{</span><span class="n">loss_P</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">, loss_SKL: </span><span class="si">{</span><span class="n">loss_SKL</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">loss_SKLs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_SKL</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
        <span class="n">Ns_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N_</span><span class="p">)</span>
        <span class="n">loss_Ps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_P</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
        <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ns_</span><span class="p">,</span> <span class="n">losses</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'green'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'loss'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ns_</span><span class="p">,</span> <span class="n">loss_Ps</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'loss_P'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ns_</span><span class="p">,</span> <span class="n">loss_SKLs</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'loss_SKL'</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">' # trials'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Loss'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">'log'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scatterpoints</span><span class="o">=</span><span class="mi">6</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="influence-of-number-of-theta_std">influence of number of theta_std<a class="anchor-link" href="2020-04-08-fitting-a-psychometric-curve-using-pytorch.html#influence-of-number-of-theta_std">¶</a>
</h4>
<p>The convergence of the fitting procedure may also depend on the parametrers of the data which were set to:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'p0 = </span><span class="si">{</span><span class="n">p0</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, theta0 = </span><span class="si">{</span><span class="n">theta0</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, wt = </span><span class="si">{</span><span class="n">wt</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, theta_std = </span><span class="si">{</span><span class="n">theta_std</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theta_stds</span> <span class="o">=</span> <span class="n">theta_std</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N_scan</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">theta_stds_</span><span class="p">,</span> <span class="n">losses</span><span class="p">,</span> <span class="n">loss_Ps</span><span class="p">,</span> <span class="n">loss_SKLs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">theta_std_</span> <span class="ow">in</span> <span class="n">theta_stds</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i_CV</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_cv</span><span class="p">):</span>
        <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">theta_std</span><span class="o">=</span><span class="n">theta_std_</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="p">)</span>
        
        <span class="n">logistic_model</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">fit_data</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">loss_SKL</span> <span class="o">=</span> <span class="n">fit_data_sklearn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">N_test</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">theta_std</span><span class="o">=</span><span class="n">theta_std_</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">N_test</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="o">+</span><span class="n">N_test</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_torch</span><span class="p">(</span><span class="n">logistic_model</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>            
            <span class="n">loss_SKL</span> <span class="o">=</span> <span class="n">loss_sklearn</span><span class="p">(</span><span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">loss_P</span> <span class="o">=</span> <span class="n">loss_true</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">i_CV</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"theta_std: </span><span class="si">{</span><span class="n">theta_std_</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, Loss: </span><span class="si">{</span><span class="n">loss</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">, loss_P: </span><span class="si">{</span><span class="n">loss_P</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">, loss_SKL: </span><span class="si">{</span><span class="n">loss_SKL</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">loss_SKLs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_SKL</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
        <span class="n">theta_stds_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta_std_</span><span class="p">)</span>
        <span class="n">loss_Ps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_P</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
        <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_stds_</span><span class="p">,</span> <span class="n">losses</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'green'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'loss'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_stds_</span><span class="p">,</span> <span class="n">loss_Ps</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'loss_P'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_stds_</span><span class="p">,</span> <span class="n">loss_SKLs</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'loss_SKL'</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">' # trials'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Loss'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">'log'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scatterpoints</span><span class="o">=</span><span class="mi">6</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="influence-of-number-of-p0">influence of number of <code>p0</code><a class="anchor-link" href="2020-04-08-fitting-a-psychometric-curve-using-pytorch.html#influence-of-number-of-p0">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p0s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-.</span><span class="mi">7</span><span class="p">,</span> <span class="n">N_scan</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">p0s_</span><span class="p">,</span> <span class="n">losses</span><span class="p">,</span> <span class="n">loss_Ps</span><span class="p">,</span> <span class="n">loss_SKLs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">p0_</span> <span class="ow">in</span> <span class="n">p0s</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i_CV</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_cv</span><span class="p">):</span>
        <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">p0</span><span class="o">=</span><span class="n">p0_</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="p">)</span>
        
        <span class="n">logistic_model</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">fit_data</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">loss_SKL</span> <span class="o">=</span> <span class="n">fit_data_sklearn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">N_test</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">p0</span><span class="o">=</span><span class="n">p0_</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">N_test</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_torch</span><span class="p">(</span><span class="n">logistic_model</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="n">loss_SKL</span> <span class="o">=</span> <span class="n">loss_sklearn</span><span class="p">(</span><span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">loss_P</span> <span class="o">=</span> <span class="n">loss_true</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">i_CV</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"theta_std: </span><span class="si">{</span><span class="n">theta_std_</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, Loss: </span><span class="si">{</span><span class="n">loss</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">, loss_P: </span><span class="si">{</span><span class="n">loss_P</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">, loss_SKL: </span><span class="si">{</span><span class="n">loss_SKL</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">loss_SKLs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_SKL</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
        <span class="n">p0s_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p0_</span><span class="p">)</span>
        <span class="n">loss_Ps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_P</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
        <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">/</span><span class="n">loss_P</span><span class="p">)</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_stds_</span><span class="p">,</span> <span class="n">losses</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'green'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'loss'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_stds_</span><span class="p">,</span> <span class="n">loss_Ps</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'loss_P'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_stds_</span><span class="p">,</span> <span class="n">loss_SKLs</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'loss_SKL'</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">' # trials'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Loss'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">'log'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scatterpoints</span><span class="o">=</span><span class="mi">6</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="comparing-the-predicted-values">comparing the predicted values<a class="anchor-link" href="2020-04-08-fitting-a-psychometric-curve-using-pytorch.html#comparing-the-predicted-values">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'p0 = </span><span class="si">{</span><span class="n">p0</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, theta0 = </span><span class="si">{</span><span class="n">theta0</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, wt = </span><span class="si">{</span><span class="n">wt</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, theta_std = </span><span class="si">{</span><span class="n">theta_std</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="changing-p0">changing <code>p0</code><a class="anchor-link" href="2020-04-08-fitting-a-psychometric-curve-using-pytorch.html#changing-p0">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N_scan</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">p0s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-.</span><span class="mi">7</span><span class="p">,</span> <span class="n">N_scan</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">p0s_</span><span class="p">,</span> <span class="n">wts_</span><span class="p">,</span> <span class="n">theta0s_</span><span class="p">,</span> <span class="n">p0_tos</span><span class="p">,</span> <span class="n">theta0_tos</span><span class="p">,</span> <span class="n">theta0_sks</span><span class="p">,</span> <span class="n">wt_tos</span><span class="p">,</span> <span class="n">wt_sks</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">p0_</span> <span class="ow">in</span> <span class="n">p0s</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i_CV</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_cv</span><span class="p">):</span>
        <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">p0</span><span class="o">=</span><span class="n">p0_</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="p">)</span>
        
        <span class="n">logistic_model</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">fit_data</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">loss_SKL</span> <span class="o">=</span> <span class="n">fit_data_sklearn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="n">theta0_to</span><span class="p">,</span> <span class="n">wt_to</span><span class="p">,</span> <span class="n">p0_to</span> <span class="o">=</span> <span class="n">get_params</span><span class="p">(</span><span class="n">logistic_model</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">theta0_sk</span><span class="p">,</span> <span class="n">wt_sk</span> <span class="o">=</span> <span class="n">get_params_sk</span><span class="p">(</span><span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="n">p0s_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p0_</span><span class="p">)</span>
        <span class="n">theta0s_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta0</span><span class="p">)</span>
        <span class="n">wts_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wt</span><span class="p">)</span>
        <span class="n">p0_tos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p0_to</span><span class="p">)</span>
        <span class="n">theta0_tos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta0_to</span><span class="p">)</span>
        <span class="n">theta0_sks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta0_sk</span><span class="p">)</span>
        <span class="n">wt_tos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wt_to</span><span class="p">)</span>
        <span class="n">wt_sks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wt_sk</span><span class="p">)</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">p0s_</span><span class="p">,</span> <span class="n">p0_tos</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'torch'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">p0s_</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">p0s_</span><span class="p">)],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">p0_tos</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">p0_tos</span><span class="p">)],</span> <span class="s1">'--'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">'p0 (true)'</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">'p0 (predicted)'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">"upper left"</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">theta0s_</span><span class="p">,</span> <span class="n">theta0_tos</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'torch'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">theta0s_</span><span class="p">,</span> <span class="n">theta0_sks</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'sklearn'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">theta0s_</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">theta0s_</span><span class="p">)],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">theta0_sks</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">theta0_sks</span><span class="p">)],</span> <span class="s1">'--'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">'theta0 (true)'</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">'theta0 (predicted)'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">"upper left"</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">wts_</span><span class="p">,</span> <span class="n">wt_tos</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'torch'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">wts_</span><span class="p">,</span> <span class="n">wt_sks</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'sklearn'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">wts_</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">wts_</span><span class="p">)],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">wts_</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">wts_</span><span class="p">)],</span> <span class="s1">'--'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">'slope (true)'</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">'slope (predicted)'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">"upper left"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="changing-theta0">changing <code>theta0</code><a class="anchor-link" href="2020-04-08-fitting-a-psychometric-curve-using-pytorch.html#changing-theta0">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N_scan</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">theta0s</span> <span class="o">=</span> <span class="n">theta_std</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N_scan</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">p0s_</span><span class="p">,</span> <span class="n">wts_</span><span class="p">,</span> <span class="n">theta0s_</span><span class="p">,</span> <span class="n">p0_tos</span><span class="p">,</span> <span class="n">theta0_tos</span><span class="p">,</span> <span class="n">theta0_sks</span><span class="p">,</span> <span class="n">wt_tos</span><span class="p">,</span> <span class="n">wt_sks</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">theta0_</span> <span class="ow">in</span> <span class="n">theta0s</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i_CV</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_cv</span><span class="p">):</span>
        <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">theta0</span><span class="o">=</span><span class="n">theta0_</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="p">)</span>
        
        <span class="n">logistic_model</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">fit_data</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">loss_SKL</span> <span class="o">=</span> <span class="n">fit_data_sklearn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="n">theta0_to</span><span class="p">,</span> <span class="n">wt_to</span><span class="p">,</span> <span class="n">p0_to</span> <span class="o">=</span> <span class="n">get_params</span><span class="p">(</span><span class="n">logistic_model</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">theta0_sk</span><span class="p">,</span> <span class="n">wt_sk</span> <span class="o">=</span> <span class="n">get_params_sk</span><span class="p">(</span><span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="n">p0s_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p0</span><span class="p">)</span>
        <span class="n">theta0s_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta0_</span><span class="p">)</span>
        <span class="n">wts_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wt</span><span class="p">)</span>
        <span class="n">p0_tos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p0_to</span><span class="p">)</span>
        <span class="n">theta0_tos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta0_to</span><span class="p">)</span>
        <span class="n">theta0_sks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta0_sk</span><span class="p">)</span>
        <span class="n">wt_tos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wt_to</span><span class="p">)</span>
        <span class="n">wt_sks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wt_sk</span><span class="p">)</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">p0s_</span><span class="p">,</span> <span class="n">p0_tos</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'torch'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">p0s_</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">p0s_</span><span class="p">)],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">p0_tos</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">p0_tos</span><span class="p">)],</span> <span class="s1">'--'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">'p0 (true)'</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">'p0 (predicted)'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">"upper left"</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">theta0s_</span><span class="p">,</span> <span class="n">theta0_tos</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'torch'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">theta0s_</span><span class="p">,</span> <span class="n">theta0_sks</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'sklearn'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">theta0s_</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">theta0s_</span><span class="p">)],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">theta0_sks</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">theta0_sks</span><span class="p">)],</span> <span class="s1">'--'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">'theta0 (true)'</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">'theta0 (predicted)'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">"upper left"</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">wts_</span><span class="p">,</span> <span class="n">wt_tos</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'torch'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">wts_</span><span class="p">,</span> <span class="n">wt_sks</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'sklearn'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">wts_</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">wts_</span><span class="p">)],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">wts_</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">wts_</span><span class="p">)],</span> <span class="s1">'--'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">'slope (true)'</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">'slope (predicted)'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">"upper left"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="changing-wt">changing <code>wt</code><a class="anchor-link" href="2020-04-08-fitting-a-psychometric-curve-using-pytorch.html#changing-wt">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N_scan</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">wts</span> <span class="o">=</span> <span class="n">wt</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N_scan</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">p0s_</span><span class="p">,</span> <span class="n">wts_</span><span class="p">,</span> <span class="n">theta0s_</span><span class="p">,</span> <span class="n">p0_tos</span><span class="p">,</span> <span class="n">theta0_tos</span><span class="p">,</span> <span class="n">theta0_sks</span><span class="p">,</span> <span class="n">wt_tos</span><span class="p">,</span> <span class="n">wt_sks</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">wt_</span> <span class="ow">in</span> <span class="n">wts</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i_CV</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_cv</span><span class="p">):</span>
        <span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">wt</span><span class="o">=</span><span class="n">wt_</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="n">i_CV</span><span class="p">)</span>
        
        <span class="n">logistic_model</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">fit_data</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">loss_SKL</span> <span class="o">=</span> <span class="n">fit_data_sklearn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="n">theta0_to</span><span class="p">,</span> <span class="n">wt_to</span><span class="p">,</span> <span class="n">p0_to</span> <span class="o">=</span> <span class="n">get_params</span><span class="p">(</span><span class="n">logistic_model</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">theta0_sk</span><span class="p">,</span> <span class="n">wt_sk</span> <span class="o">=</span> <span class="n">get_params_sk</span><span class="p">(</span><span class="n">logistic_model_sk</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="n">p0s_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p0</span><span class="p">)</span>
        <span class="n">theta0s_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta0</span><span class="p">)</span>
        <span class="n">wts_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wt_</span><span class="p">)</span>
        <span class="n">p0_tos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p0_to</span><span class="p">)</span>
        <span class="n">theta0_tos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta0_to</span><span class="p">)</span>
        <span class="n">theta0_sks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta0_sk</span><span class="p">)</span>
        <span class="n">wt_tos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wt_to</span><span class="p">)</span>
        <span class="n">wt_sks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wt_sk</span><span class="p">)</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">p0s_</span><span class="p">,</span> <span class="n">p0_tos</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'torch'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">p0s_</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">p0s_</span><span class="p">)],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">p0_tos</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">p0_tos</span><span class="p">)],</span> <span class="s1">'--'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">'p0 (true)'</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">'p0 (predicted)'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">"upper left"</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">theta0s_</span><span class="p">,</span> <span class="n">theta0_tos</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'torch'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">theta0s_</span><span class="p">,</span> <span class="n">theta0_sks</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'sklearn'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">theta0s_</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">theta0s_</span><span class="p">)],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">theta0_sks</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">theta0_sks</span><span class="p">)],</span> <span class="s1">'--'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">'theta0 (true)'</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">'theta0 (predicted)'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">"upper left"</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">wts_</span><span class="p">,</span> <span class="n">wt_tos</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'torch'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">wts_</span><span class="p">,</span> <span class="n">wt_sks</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'sklearn'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">wts_</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">wts_</span><span class="p">)],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">wts_</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">wts_</span><span class="p">)],</span> <span class="s1">'--'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">'slope (true)'</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">'slope (predicted)'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">"upper left"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../categories/numpy.html" rel="tag">numpy</a></li>
            <li><a class="tag p-category" href="../categories/open-science.html" rel="tag">open-science</a></li>
            <li><a class="tag p-category" href="../categories/orientation.html" rel="tag">orientation</a></li>
            <li><a class="tag p-category" href="../categories/psychophysics.html" rel="tag">psychophysics</a></li>
            <li><a class="tag p-category" href="../categories/pytorch.html" rel="tag">pytorch</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="2020-01-08-changing-the-global-phase-of-a-motion-cloud.html" rel="prev" title="Changing the global phase of a Motion Cloud">Previous post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="invibe",
            disqus_url="https://laurentperrinet.github.io/sciblog/posts/2020-04-08-fitting-a-psychometric-curve-using-pytorch.html",
        disqus_title="2020-04-08 fitting a psychometric curve using pyTorch",
        disqus_identifier="cache/posts/2020-04-08-fitting-a-psychometric-curve-using-pytorch.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    },
    displayAlign: 'center', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script></article><script>var disqus_shortname="invibe";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><!--End of body content--><footer id="footer">
            Contents © 2020 <a href="mailto:laurent.perrinet@univ-amu.fr">Laurent Perrinet</a> -
Powered by <a href="http://getnikola.com">Nikola</a> with <a href="https://themes.getnikola.com/v7/maupassant/">Maupassant</a> theme <br><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/ar/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="http://i.creativecommons.org/l/by-nc-sa/2.5/ar/88x31.png"></a>
            
            
        </footer>
</div>
</div>


        <script src="../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
