<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>2020-07-04 colors of the sky | Scientific logbook</title>
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../rss.xml">
<link rel="canonical" href="https://laurentperrinet.github.io/sciblog/posts/2020-07-04-colors-of-the-sky.html">
<link rel="icon" href="favicon.ico" sizes="16x16">
<!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]--><meta name="author" content="Laurent Perrinet">
<link rel="prev" href="2020-06-19-caustic-optics.html" title="2020-06-19 caustic (optics)" type="text/html">
<meta property="og:site_name" content="Scientific logbook">
<meta property="og:title" content="2020-07-04 colors of the sky">
<meta property="og:url" content="https://laurentperrinet.github.io/sciblog/posts/2020-07-04-colors-of-the-sky.html">
<meta property="og:description" content="Our sensorial environment contains multiple regularities which our brain uses to optimize its representation of the world: objects fall most of the time downwards, the nose is usually in the middle be">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-07-04T12:05:58+02:00">
<meta property="article:tag" content="art">
<meta property="article:tag" content="grand-public">
<meta property="article:tag" content="motionclouds">
<meta property="article:tag" content="numpy">
<meta property="article:tag" content="open-science">
<meta property="article:tag" content="outreach">
<meta property="article:tag" content="vision">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Header and menu bar -->
<div class="container">
      <header class="blog-header py-3"><div class="row nbb-header align-items-center">
          <div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;">
            <button class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" type="button" data-toggle="collapse" data-target=".bs-nav-collapsible" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse bs-nav-collapsible bootblog4-search-form-holder">
                
<!-- Custom search -->
<form method="get" id="search" action="//duckduckgo.com/" class="navbar-form pull-left">
<input type="hidden" name="sites" value="https://laurentperrinet.github.io/sciblog/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Search…" class="span2" style="margin-top: 4px;"><input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
<!-- End of custom search -->

            </div>
        </div>
          <div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;">
            <a class="navbar-brand blog-header-logo text-dark" href="../">

            <span id="blog-title">Scientific logbook</span>
        </a>
          </div>
            <div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
            <nav class="navbar navbar-light bg-white"><ul class="navbar-nav bootblog4-right-nav">
<li class="nav-item">
    <a href="2020-07-04-colors-of-the-sky.ipynb" id="sourcelink" class="nav-link">Source</a>
    </li>


                    
            </ul></nav>
</div>
    </div>
</header><nav class="navbar navbar-expand-md navbar-light bg-white static-top"><div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
            <ul class="navbar-nav nav-fill d-flex w-100">
<li class="nav-item">
<a href="../index.html" class="nav-link">Home</a>
                </li>
<li class="nav-item">
<a href="../archive.html" class="nav-link">Archives</a>
                </li>
<li class="nav-item">
<a href="../categories/index.html" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="../rss.xml" class="nav-link">RSS</a>
                </li>
<li class="nav-item">
<a href="http://laurentperrinet.github.io" class="nav-link">About my research</a>
                </li>
<li class="nav-item">
<a href="https://twitter.com/laurentperrinet" class="nav-link">Twitter</a>
                </li>
<li class="nav-item">
<a href="https://github.com/laurentperrinet" class="nav-link">Github</a>

                
            </li>
</ul>
</div>
<!-- /.navbar-collapse -->
</nav>
</div>

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">2020-07-04 colors of the sky</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Laurent Perrinet
            </span></p>
            <p class="dateline">
            <a href="#" rel="bookmark">
            <time class="published dt-published" datetime="2020-07-04T12:05:58+02:00" itemprop="datePublished" title="2020-07-04 12:05">2020-07-04 12:05</time></a>
            </p>
                <p class="commentline">
        
    <a href="2020-07-04-colors-of-the-sky.html#disqus_thread" data-disqus-identifier="cache/posts/2020-07-04-colors-of-the-sky.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="2020-07-04-colors-of-the-sky.ipynb" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our sensorial environment contains multiple regularities which our brain uses to optimize its representation of the world: objects fall most of the time downwards, the nose is usually in the middle below the eyes, the <em>sky is blue</em>... Concerning this last point, I wish here to illustrate the physical origins of this phenomenon and in particular the range of colors that you may observe in the sky.</p>
<!-- TEASER_END -->

<p>Let's first initialize the notebook:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">rcParams</span>
<span class="c1"># print(rcParams)</span>
<span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s2">"font.size"</span><span class="p">]</span> <span class="o">=</span> <span class="n">fontsize</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s2">"legend.fontsize"</span><span class="p">]</span> <span class="o">=</span> <span class="n">fontsize</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.labelsize"</span><span class="p">]</span> <span class="o">=</span> <span class="n">fontsize</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1">#%config InlineBackend.figure_format='retina'</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = 'svg'
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="n">fig_width</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_width</span><span class="o">/</span><span class="n">phi</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-colors-in-the-sky">The colors in the sky<a class="anchor-link" href="2020-07-04-colors-of-the-sky.html#The-colors-in-the-sky">¶</a>
</h3>
<p>Intuitively it goes like this: the sun emits light, it travels space, meets other particles on the way until it hits your retina by entering the eye. This generates electro-chemical reactions on the photo-receptors, and in the particular case that interests us, the color-sensitive cones which will give ---by way of the relative balance of their responses--- the perceived color.</p>
<p>Going the other way around, perceived colors are fully characterized by the three cone types L, M and S which each have given tunings for different light wavelengths. To know about the colors in the sky, we should first get the spectrum (range of wavelengths) emitted by the sun and as they are filtered by the sky.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-spectrum-the-sky">The spectrum the sky<a class="anchor-link" href="2020-07-04-colors-of-the-sky.html#The-spectrum-the-sky">¶</a>
</h3>
<p>Let's thus begin by the sun. Given its temperature, it emits light according to a <a href="https://en.wikipedia.org/wiki/Black-body_radiation">blackboby radiation</a> at 5800K. It is peaking in the range of <a href="https://en.wikipedia.org/wiki/Visible_spectrum">visible light</a> (that is for wavelengths $\lambda$ between $400~nm$ and $800~nm$), toward green yellow colors.
This "smooth" spectrum contains some bands of absorption, but these are mostly outside the range of visible light, so we can discard them.</p>
<p>We can make a <a href="https://stackoverflow.com/questions/22417484/plancks-formula-for-blackbody-spectrum">plot of spectrum</a>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># borrowed from https://github.com/gummiks/gummiks.github.io/blob/master/scripts/astro/planck.py</span>

<span class="k">def</span> <span class="nf">planck</span><span class="p">(</span><span class="n">wav</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">scipy.constants</span> <span class="k">as</span> <span class="nn">const</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">c</span> <span class="c1"># c = 3.0e+8</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">h</span> <span class="c1"># h = 6.626e-34</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">k</span> <span class="c1"># k = 1.38e-23</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="n">wav</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">T</span><span class="p">)</span>
    <span class="n">intensity</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="p">(</span> <span class="p">(</span><span class="n">wav</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">intensity</span>

<span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">200e-9</span><span class="p">,</span> <span class="mf">2000e-9</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span> 
<span class="n">intensity5800</span> <span class="o">=</span> <span class="n">planck</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="mf">5800.</span><span class="p">)</span>
<span class="n">intensity5800</span> <span class="o">/=</span> <span class="n">intensity5800</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
<span class="c1"># borrowed from https://github.com/gummiks/gummiks.github.io/blob/master/scripts/astro/planck.py</span>
<span class="n">adjustprops</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.19</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.92</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="o">**</span><span class="n">adjustprops</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelengths</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="n">intensity5800</span><span class="p">,</span> <span class="s1">'k-'</span><span class="p">)</span> 
<span class="n">opts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">445</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">555</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">'g'</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">'r'</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$\lambda$ (nm)'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'relative spectral radiance'</span><span class="p">)</span>
<span class="c1">#ax.set_ylim(0)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">'log'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?><!-- Created with matplotlib (https://matplotlib.org/) --><svg height="555.041906pt" version="1.1" viewbox="0 0 856.65625 555.041906" width="856.65625pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><metadata><rdf xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><work><type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></type><date>2020-07-28T21:34:58.310876</date><format>image/svg+xml</format><creator><agent><title>Matplotlib v3.3.0, https://matplotlib.org/</title></agent></creator></work></rdf></metadata><defs><style type="text/css">*{stroke-linecap:butt;stroke-linejoin:round;}</style></defs><g id="figure_1"><g id="patch_1"><path d="M 0 555.041906 
L 856.65625 555.041906 
L 856.65625 0 
L 0 0 
z
" style="fill:none;"></path></g><g id="axes_1"><g id="patch_2"><path d="M 61.05625 507.807531 
L 849.45625 507.807531 
L 849.45625 7.2 
L 61.05625 7.2 
z
" style="fill:#ffffff;"></path></g><g id="matplotlib.axis_1"><g id="xtick_1"><g id="line2d_1"><defs><path d="M 0 0 
L 0 3.5 
" id="m858707ba5e" style="stroke:#000000;stroke-width:0.8;"></path></defs><g><use style="stroke:#000000;stroke-width:0.8;" x="116.801705" xlink:href="#m858707ba5e" y="507.807531"></use></g></g><g id="text_1"><!-- 250 --><g transform="translate(107.257955 522.405968)scale(0.1 -0.1)"><defs><path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path><path d="M 10.796875 72.90625 
L 49.515625 72.90625 
L 49.515625 64.59375 
L 19.828125 64.59375 
L 19.828125 46.734375 
Q 21.96875 47.46875 24.109375 47.828125 
Q 26.265625 48.1875 28.421875 48.1875 
Q 40.625 48.1875 47.75 41.5 
Q 54.890625 34.8125 54.890625 23.390625 
Q 54.890625 11.625 47.5625 5.09375 
Q 40.234375 -1.421875 26.90625 -1.421875 
Q 22.3125 -1.421875 17.546875 -0.640625 
Q 12.796875 0.140625 7.71875 1.703125 
L 7.71875 11.625 
Q 12.109375 9.234375 16.796875 8.0625 
Q 21.484375 6.890625 26.703125 6.890625 
Q 35.15625 6.890625 40.078125 11.328125 
Q 45.015625 15.765625 45.015625 23.390625 
Q 45.015625 31 40.078125 35.4375 
Q 35.15625 39.890625 26.703125 39.890625 
Q 22.75 39.890625 18.8125 39.015625 
Q 14.890625 38.140625 10.796875 36.28125 
z
" id="DejaVuSans-53"></path><path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path></defs><use xlink:href="#DejaVuSans-50"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_2"><g id="line2d_2"><g><use style="stroke:#000000;stroke-width:0.8;" x="216.347159" xlink:href="#m858707ba5e" y="507.807531"></use></g></g><g id="text_2"><!-- 500 --><g transform="translate(206.803409 522.405968)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-53"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_3"><g id="line2d_3"><g><use style="stroke:#000000;stroke-width:0.8;" x="315.892614" xlink:href="#m858707ba5e" y="507.807531"></use></g></g><g id="text_3"><!-- 750 --><g transform="translate(306.348864 522.405968)scale(0.1 -0.1)"><defs><path d="M 8.203125 72.90625 
L 55.078125 72.90625 
L 55.078125 68.703125 
L 28.609375 0 
L 18.3125 0 
L 43.21875 64.59375 
L 8.203125 64.59375 
z
" id="DejaVuSans-55"></path></defs><use xlink:href="#DejaVuSans-55"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_4"><g id="line2d_4"><g><use style="stroke:#000000;stroke-width:0.8;" x="415.438068" xlink:href="#m858707ba5e" y="507.807531"></use></g></g><g id="text_4"><!-- 1000 --><g transform="translate(402.713068 522.405968)scale(0.1 -0.1)"><defs><path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path></defs><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use><use x="190.869141" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_5"><g id="line2d_5"><g><use style="stroke:#000000;stroke-width:0.8;" x="514.983523" xlink:href="#m858707ba5e" y="507.807531"></use></g></g><g id="text_5"><!-- 1250 --><g transform="translate(502.258523 522.405968)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-50"></use><use x="127.246094" xlink:href="#DejaVuSans-53"></use><use x="190.869141" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_6"><g id="line2d_6"><g><use style="stroke:#000000;stroke-width:0.8;" x="614.528977" xlink:href="#m858707ba5e" y="507.807531"></use></g></g><g id="text_6"><!-- 1500 --><g transform="translate(601.803977 522.405968)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use><use x="190.869141" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_7"><g id="line2d_7"><g><use style="stroke:#000000;stroke-width:0.8;" x="714.074432" xlink:href="#m858707ba5e" y="507.807531"></use></g></g><g id="text_7"><!-- 1750 --><g transform="translate(701.349432 522.405968)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-55"></use><use x="127.246094" xlink:href="#DejaVuSans-53"></use><use x="190.869141" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_8"><g id="line2d_8"><g><use style="stroke:#000000;stroke-width:0.8;" x="813.619886" xlink:href="#m858707ba5e" y="507.807531"></use></g></g><g id="text_8"><!-- 2000 --><g transform="translate(800.894886 522.405968)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-50"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use><use x="190.869141" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_9"><g id="line2d_9"><defs><path d="M 0 0 
L 0 2 
" id="m318da2ea47" style="stroke:#000000;stroke-width:0.6;"></path></defs><g><use style="stroke:#000000;stroke-width:0.6;" x="76.983523" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_10"><g id="line2d_10"><g><use style="stroke:#000000;stroke-width:0.6;" x="96.892614" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_11"><g id="line2d_11"><g><use style="stroke:#000000;stroke-width:0.6;" x="136.710795" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_12"><g id="line2d_12"><g><use style="stroke:#000000;stroke-width:0.6;" x="156.619886" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_13"><g id="line2d_13"><g><use style="stroke:#000000;stroke-width:0.6;" x="176.528977" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_14"><g id="line2d_14"><g><use style="stroke:#000000;stroke-width:0.6;" x="196.438068" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_15"><g id="line2d_15"><g><use style="stroke:#000000;stroke-width:0.6;" x="236.25625" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_16"><g id="line2d_16"><g><use style="stroke:#000000;stroke-width:0.6;" x="256.165341" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_17"><g id="line2d_17"><g><use style="stroke:#000000;stroke-width:0.6;" x="276.074432" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_18"><g id="line2d_18"><g><use style="stroke:#000000;stroke-width:0.6;" x="295.983523" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_19"><g id="line2d_19"><g><use style="stroke:#000000;stroke-width:0.6;" x="335.801705" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_20"><g id="line2d_20"><g><use style="stroke:#000000;stroke-width:0.6;" x="355.710795" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_21"><g id="line2d_21"><g><use style="stroke:#000000;stroke-width:0.6;" x="375.619886" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_22"><g id="line2d_22"><g><use style="stroke:#000000;stroke-width:0.6;" x="395.528977" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_23"><g id="line2d_23"><g><use style="stroke:#000000;stroke-width:0.6;" x="435.347159" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_24"><g id="line2d_24"><g><use style="stroke:#000000;stroke-width:0.6;" x="455.25625" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_25"><g id="line2d_25"><g><use style="stroke:#000000;stroke-width:0.6;" x="475.165341" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_26"><g id="line2d_26"><g><use style="stroke:#000000;stroke-width:0.6;" x="495.074432" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_27"><g id="line2d_27"><g><use style="stroke:#000000;stroke-width:0.6;" x="534.892614" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_28"><g id="line2d_28"><g><use style="stroke:#000000;stroke-width:0.6;" x="554.801705" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_29"><g id="line2d_29"><g><use style="stroke:#000000;stroke-width:0.6;" x="574.710795" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_30"><g id="line2d_30"><g><use style="stroke:#000000;stroke-width:0.6;" x="594.619886" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_31"><g id="line2d_31"><g><use style="stroke:#000000;stroke-width:0.6;" x="634.438068" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_32"><g id="line2d_32"><g><use style="stroke:#000000;stroke-width:0.6;" x="654.347159" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_33"><g id="line2d_33"><g><use style="stroke:#000000;stroke-width:0.6;" x="674.25625" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_34"><g id="line2d_34"><g><use style="stroke:#000000;stroke-width:0.6;" x="694.165341" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_35"><g id="line2d_35"><g><use style="stroke:#000000;stroke-width:0.6;" x="733.983523" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_36"><g id="line2d_36"><g><use style="stroke:#000000;stroke-width:0.6;" x="753.892614" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_37"><g id="line2d_37"><g><use style="stroke:#000000;stroke-width:0.6;" x="773.801705" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_38"><g id="line2d_38"><g><use style="stroke:#000000;stroke-width:0.6;" x="793.710795" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="xtick_39"><g id="line2d_39"><g><use style="stroke:#000000;stroke-width:0.6;" x="833.528977" xlink:href="#m318da2ea47" y="507.807531"></use></g></g></g><g id="text_9"><!-- $\lambda$ (nm) --><g transform="translate(422.25625 543.682531)scale(0.2 -0.2)"><defs><path d="M 36.71875 67.4375 
L 48.828125 0 
L 39.3125 0 
L 31.84375 40.4375 
L 5.125 0 
L -4.390625 0 
L 29.734375 52.4375 
L 28.03125 62.109375 
Q 26.953125 68.265625 21.734375 68.265625 
L 17.046875 68.265625 
L 18.5 75.984375 
L 24.21875 75.875 
Q 35.203125 75.734375 36.71875 67.4375 
z
" id="DejaVuSans-Oblique-955"></path><path id="DejaVuSans-32"></path><path d="M 31 75.875 
Q 24.46875 64.65625 21.28125 53.65625 
Q 18.109375 42.671875 18.109375 31.390625 
Q 18.109375 20.125 21.3125 9.0625 
Q 24.515625 -2 31 -13.1875 
L 23.1875 -13.1875 
Q 15.875 -1.703125 12.234375 9.375 
Q 8.59375 20.453125 8.59375 31.390625 
Q 8.59375 42.28125 12.203125 53.3125 
Q 15.828125 64.359375 23.1875 75.875 
z
" id="DejaVuSans-40"></path><path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-110"></path><path d="M 52 44.1875 
Q 55.375 50.25 60.0625 53.125 
Q 64.75 56 71.09375 56 
Q 79.640625 56 84.28125 50.015625 
Q 88.921875 44.046875 88.921875 33.015625 
L 88.921875 0 
L 79.890625 0 
L 79.890625 32.71875 
Q 79.890625 40.578125 77.09375 44.375 
Q 74.3125 48.1875 68.609375 48.1875 
Q 61.625 48.1875 57.5625 43.546875 
Q 53.515625 38.921875 53.515625 30.90625 
L 53.515625 0 
L 44.484375 0 
L 44.484375 32.71875 
Q 44.484375 40.625 41.703125 44.40625 
Q 38.921875 48.1875 33.109375 48.1875 
Q 26.21875 48.1875 22.15625 43.53125 
Q 18.109375 38.875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.1875 51.21875 25.484375 53.609375 
Q 29.78125 56 35.6875 56 
Q 41.65625 56 45.828125 52.96875 
Q 50 49.953125 52 44.1875 
z
" id="DejaVuSans-109"></path><path d="M 8.015625 75.875 
L 15.828125 75.875 
Q 23.140625 64.359375 26.78125 53.3125 
Q 30.421875 42.28125 30.421875 31.390625 
Q 30.421875 20.453125 26.78125 9.375 
Q 23.140625 -1.703125 15.828125 -13.1875 
L 8.015625 -13.1875 
Q 14.5 -2 17.703125 9.0625 
Q 20.90625 20.125 20.90625 31.390625 
Q 20.90625 42.671875 17.703125 53.65625 
Q 14.5 64.65625 8.015625 75.875 
z
" id="DejaVuSans-41"></path></defs><use transform="translate(0 0.015625)" xlink:href="#DejaVuSans-Oblique-955"></use><use transform="translate(59.179688 0.015625)" xlink:href="#DejaVuSans-32"></use><use transform="translate(90.966797 0.015625)" xlink:href="#DejaVuSans-40"></use><use transform="translate(129.980469 0.015625)" xlink:href="#DejaVuSans-110"></use><use transform="translate(193.359375 0.015625)" xlink:href="#DejaVuSans-109"></use><use transform="translate(290.771484 0.015625)" xlink:href="#DejaVuSans-41"></use></g></g></g><g id="matplotlib.axis_2"><g id="ytick_1"><g id="line2d_40"><defs><path d="M 0 0 
L -3.5 0 
" id="m4b9f418e25" style="stroke:#000000;stroke-width:0.8;"></path></defs><g><use style="stroke:#000000;stroke-width:0.8;" x="61.05625" xlink:href="#m4b9f418e25" y="394.312567"></use></g></g><g id="text_10"><!-- $\mathdefault{10^{-1}}$ --><g transform="translate(30.55625 398.111786)scale(0.1 -0.1)"><defs><path d="M 10.59375 35.5 
L 73.1875 35.5 
L 73.1875 27.203125 
L 10.59375 27.203125 
z
" id="DejaVuSans-8722"></path></defs><use transform="translate(0 0.684375)" xlink:href="#DejaVuSans-49"></use><use transform="translate(63.623047 0.684375)" xlink:href="#DejaVuSans-48"></use><use transform="translate(128.203125 38.965625)scale(0.7)" xlink:href="#DejaVuSans-8722"></use><use transform="translate(186.855469 38.965625)scale(0.7)" xlink:href="#DejaVuSans-49"></use></g></g></g><g id="ytick_2"><g id="line2d_41"><g><use style="stroke:#000000;stroke-width:0.8;" x="61.05625" xlink:href="#m4b9f418e25" y="29.954888"></use></g></g><g id="text_11"><!-- $\mathdefault{10^{0}}$ --><g transform="translate(36.45625 33.754107)scale(0.1 -0.1)"><use transform="translate(0 0.765625)" xlink:href="#DejaVuSans-49"></use><use transform="translate(63.623047 0.765625)" xlink:href="#DejaVuSans-48"></use><use transform="translate(128.203125 39.046875)scale(0.7)" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_3"><g id="line2d_42"><defs><path d="M 0 0 
L -2 0 
" id="m66098c752c" style="stroke:#000000;stroke-width:0.6;"></path></defs><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m66098c752c" y="503.995158"></use></g></g></g><g id="ytick_4"><g id="line2d_43"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m66098c752c" y="475.144863"></use></g></g></g><g id="ytick_5"><g id="line2d_44"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m66098c752c" y="450.752286"></use></g></g></g><g id="ytick_6"><g id="line2d_45"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m66098c752c" y="429.622474"></use></g></g></g><g id="ytick_7"><g id="line2d_46"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m66098c752c" y="410.98466"></use></g></g></g><g id="ytick_8"><g id="line2d_47"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m66098c752c" y="284.629976"></use></g></g></g><g id="ytick_9"><g id="line2d_48"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m66098c752c" y="220.469774"></use></g></g></g><g id="ytick_10"><g id="line2d_49"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m66098c752c" y="174.947386"></use></g></g></g><g id="ytick_11"><g id="line2d_50"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m66098c752c" y="139.637478"></use></g></g></g><g id="ytick_12"><g id="line2d_51"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m66098c752c" y="110.787183"></use></g></g></g><g id="ytick_13"><g id="line2d_52"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m66098c752c" y="86.394606"></use></g></g></g><g id="ytick_14"><g id="line2d_53"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m66098c752c" y="65.264795"></use></g></g></g><g id="ytick_15"><g id="line2d_54"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m66098c752c" y="46.626981"></use></g></g></g><g id="text_12"><!-- relative spectral radiance --><g transform="translate(22.396875 385.205328)rotate(-90)scale(0.2 -0.2)"><defs><path d="M 41.109375 46.296875 
Q 39.59375 47.171875 37.8125 47.578125 
Q 36.03125 48 33.890625 48 
Q 26.265625 48 22.1875 43.046875 
Q 18.109375 38.09375 18.109375 28.8125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 20.953125 51.171875 25.484375 53.578125 
Q 30.03125 56 36.53125 56 
Q 37.453125 56 38.578125 55.875 
Q 39.703125 55.765625 41.0625 55.515625 
z
" id="DejaVuSans-114"></path><path d="M 56.203125 29.59375 
L 56.203125 25.203125 
L 14.890625 25.203125 
Q 15.484375 15.921875 20.484375 11.0625 
Q 25.484375 6.203125 34.421875 6.203125 
Q 39.59375 6.203125 44.453125 7.46875 
Q 49.3125 8.734375 54.109375 11.28125 
L 54.109375 2.78125 
Q 49.265625 0.734375 44.1875 -0.34375 
Q 39.109375 -1.421875 33.890625 -1.421875 
Q 20.796875 -1.421875 13.15625 6.1875 
Q 5.515625 13.8125 5.515625 26.8125 
Q 5.515625 40.234375 12.765625 48.109375 
Q 20.015625 56 32.328125 56 
Q 43.359375 56 49.78125 48.890625 
Q 56.203125 41.796875 56.203125 29.59375 
z
M 47.21875 32.234375 
Q 47.125 39.59375 43.09375 43.984375 
Q 39.0625 48.390625 32.421875 48.390625 
Q 24.90625 48.390625 20.390625 44.140625 
Q 15.875 39.890625 15.1875 32.171875 
z
" id="DejaVuSans-101"></path><path d="M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 0 
L 9.421875 0 
z
" id="DejaVuSans-108"></path><path d="M 34.28125 27.484375 
Q 23.390625 27.484375 19.1875 25 
Q 14.984375 22.515625 14.984375 16.5 
Q 14.984375 11.71875 18.140625 8.90625 
Q 21.296875 6.109375 26.703125 6.109375 
Q 34.1875 6.109375 38.703125 11.40625 
Q 43.21875 16.703125 43.21875 25.484375 
L 43.21875 27.484375 
z
M 52.203125 31.203125 
L 52.203125 0 
L 43.21875 0 
L 43.21875 8.296875 
Q 40.140625 3.328125 35.546875 0.953125 
Q 30.953125 -1.421875 24.3125 -1.421875 
Q 15.921875 -1.421875 10.953125 3.296875 
Q 6 8.015625 6 15.921875 
Q 6 25.140625 12.171875 29.828125 
Q 18.359375 34.515625 30.609375 34.515625 
L 43.21875 34.515625 
L 43.21875 35.40625 
Q 43.21875 41.609375 39.140625 45 
Q 35.0625 48.390625 27.6875 48.390625 
Q 23 48.390625 18.546875 47.265625 
Q 14.109375 46.140625 10.015625 43.890625 
L 10.015625 52.203125 
Q 14.9375 54.109375 19.578125 55.046875 
Q 24.21875 56 28.609375 56 
Q 40.484375 56 46.34375 49.84375 
Q 52.203125 43.703125 52.203125 31.203125 
z
" id="DejaVuSans-97"></path><path d="M 18.3125 70.21875 
L 18.3125 54.6875 
L 36.8125 54.6875 
L 36.8125 47.703125 
L 18.3125 47.703125 
L 18.3125 18.015625 
Q 18.3125 11.328125 20.140625 9.421875 
Q 21.96875 7.515625 27.59375 7.515625 
L 36.8125 7.515625 
L 36.8125 0 
L 27.59375 0 
Q 17.1875 0 13.234375 3.875 
Q 9.28125 7.765625 9.28125 18.015625 
L 9.28125 47.703125 
L 2.6875 47.703125 
L 2.6875 54.6875 
L 9.28125 54.6875 
L 9.28125 70.21875 
z
" id="DejaVuSans-116"></path><path d="M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 0 
L 9.421875 0 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
" id="DejaVuSans-105"></path><path d="M 2.984375 54.6875 
L 12.5 54.6875 
L 29.59375 8.796875 
L 46.6875 54.6875 
L 56.203125 54.6875 
L 35.6875 0 
L 23.484375 0 
z
" id="DejaVuSans-118"></path><path d="M 44.28125 53.078125 
L 44.28125 44.578125 
Q 40.484375 46.53125 36.375 47.5 
Q 32.28125 48.484375 27.875 48.484375 
Q 21.1875 48.484375 17.84375 46.4375 
Q 14.5 44.390625 14.5 40.28125 
Q 14.5 37.15625 16.890625 35.375 
Q 19.28125 33.59375 26.515625 31.984375 
L 29.59375 31.296875 
Q 39.15625 29.25 43.1875 25.515625 
Q 47.21875 21.78125 47.21875 15.09375 
Q 47.21875 7.46875 41.1875 3.015625 
Q 35.15625 -1.421875 24.609375 -1.421875 
Q 20.21875 -1.421875 15.453125 -0.5625 
Q 10.6875 0.296875 5.421875 2 
L 5.421875 11.28125 
Q 10.40625 8.6875 15.234375 7.390625 
Q 20.0625 6.109375 24.8125 6.109375 
Q 31.15625 6.109375 34.5625 8.28125 
Q 37.984375 10.453125 37.984375 14.40625 
Q 37.984375 18.0625 35.515625 20.015625 
Q 33.0625 21.96875 24.703125 23.78125 
L 21.578125 24.515625 
Q 13.234375 26.265625 9.515625 29.90625 
Q 5.8125 33.546875 5.8125 39.890625 
Q 5.8125 47.609375 11.28125 51.796875 
Q 16.75 56 26.8125 56 
Q 31.78125 56 36.171875 55.265625 
Q 40.578125 54.546875 44.28125 53.078125 
z
" id="DejaVuSans-115"></path><path d="M 18.109375 8.203125 
L 18.109375 -20.796875 
L 9.078125 -20.796875 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.390625 
Q 20.953125 51.265625 25.265625 53.625 
Q 29.59375 56 35.59375 56 
Q 45.5625 56 51.78125 48.09375 
Q 58.015625 40.1875 58.015625 27.296875 
Q 58.015625 14.40625 51.78125 6.484375 
Q 45.5625 -1.421875 35.59375 -1.421875 
Q 29.59375 -1.421875 25.265625 0.953125 
Q 20.953125 3.328125 18.109375 8.203125 
z
M 48.6875 27.296875 
Q 48.6875 37.203125 44.609375 42.84375 
Q 40.53125 48.484375 33.40625 48.484375 
Q 26.265625 48.484375 22.1875 42.84375 
Q 18.109375 37.203125 18.109375 27.296875 
Q 18.109375 17.390625 22.1875 11.75 
Q 26.265625 6.109375 33.40625 6.109375 
Q 40.53125 6.109375 44.609375 11.75 
Q 48.6875 17.390625 48.6875 27.296875 
z
" id="DejaVuSans-112"></path><path d="M 48.78125 52.59375 
L 48.78125 44.1875 
Q 44.96875 46.296875 41.140625 47.34375 
Q 37.3125 48.390625 33.40625 48.390625 
Q 24.65625 48.390625 19.8125 42.84375 
Q 14.984375 37.3125 14.984375 27.296875 
Q 14.984375 17.28125 19.8125 11.734375 
Q 24.65625 6.203125 33.40625 6.203125 
Q 37.3125 6.203125 41.140625 7.25 
Q 44.96875 8.296875 48.78125 10.40625 
L 48.78125 2.09375 
Q 45.015625 0.34375 40.984375 -0.53125 
Q 36.96875 -1.421875 32.421875 -1.421875 
Q 20.0625 -1.421875 12.78125 6.34375 
Q 5.515625 14.109375 5.515625 27.296875 
Q 5.515625 40.671875 12.859375 48.328125 
Q 20.21875 56 33.015625 56 
Q 37.15625 56 41.109375 55.140625 
Q 45.0625 54.296875 48.78125 52.59375 
z
" id="DejaVuSans-99"></path><path d="M 45.40625 46.390625 
L 45.40625 75.984375 
L 54.390625 75.984375 
L 54.390625 0 
L 45.40625 0 
L 45.40625 8.203125 
Q 42.578125 3.328125 38.25 0.953125 
Q 33.9375 -1.421875 27.875 -1.421875 
Q 17.96875 -1.421875 11.734375 6.484375 
Q 5.515625 14.40625 5.515625 27.296875 
Q 5.515625 40.1875 11.734375 48.09375 
Q 17.96875 56 27.875 56 
Q 33.9375 56 38.25 53.625 
Q 42.578125 51.265625 45.40625 46.390625 
z
M 14.796875 27.296875 
Q 14.796875 17.390625 18.875 11.75 
Q 22.953125 6.109375 30.078125 6.109375 
Q 37.203125 6.109375 41.296875 11.75 
Q 45.40625 17.390625 45.40625 27.296875 
Q 45.40625 37.203125 41.296875 42.84375 
Q 37.203125 48.484375 30.078125 48.484375 
Q 22.953125 48.484375 18.875 42.84375 
Q 14.796875 37.203125 14.796875 27.296875 
z
" id="DejaVuSans-100"></path></defs><use xlink:href="#DejaVuSans-114"></use><use x="38.863281" xlink:href="#DejaVuSans-101"></use><use x="100.386719" xlink:href="#DejaVuSans-108"></use><use x="128.169922" xlink:href="#DejaVuSans-97"></use><use x="189.449219" xlink:href="#DejaVuSans-116"></use><use x="228.658203" xlink:href="#DejaVuSans-105"></use><use x="256.441406" xlink:href="#DejaVuSans-118"></use><use x="315.621094" xlink:href="#DejaVuSans-101"></use><use x="377.144531" xlink:href="#DejaVuSans-32"></use><use x="408.931641" xlink:href="#DejaVuSans-115"></use><use x="461.03125" xlink:href="#DejaVuSans-112"></use><use x="524.507812" xlink:href="#DejaVuSans-101"></use><use x="586.03125" xlink:href="#DejaVuSans-99"></use><use x="641.011719" xlink:href="#DejaVuSans-116"></use><use x="680.220703" xlink:href="#DejaVuSans-114"></use><use x="721.333984" xlink:href="#DejaVuSans-97"></use><use x="782.613281" xlink:href="#DejaVuSans-108"></use><use x="810.396484" xlink:href="#DejaVuSans-32"></use><use x="842.183594" xlink:href="#DejaVuSans-114"></use><use x="883.296875" xlink:href="#DejaVuSans-97"></use><use x="944.576172" xlink:href="#DejaVuSans-100"></use><use x="1008.052734" xlink:href="#DejaVuSans-105"></use><use x="1035.835938" xlink:href="#DejaVuSans-97"></use><use x="1097.115234" xlink:href="#DejaVuSans-110"></use><use x="1160.494141" xlink:href="#DejaVuSans-99"></use><use x="1215.474609" xlink:href="#DejaVuSans-101"></use></g></g></g><g id="LineCollection_1"><path clip-path="url(#p21880d0548)" d="M 194.447159 394.312567 
L 194.447159 29.954888 
" style="fill:none;stroke:#0000ff;stroke-dasharray:18.5,8;stroke-dashoffset:0;stroke-opacity:0.3;stroke-width:5;"></path></g><g id="LineCollection_2"><path clip-path="url(#p21880d0548)" d="M 238.247159 394.312567 
L 238.247159 29.954888 
" style="fill:none;stroke:#008000;stroke-dasharray:18.5,8;stroke-dashoffset:0;stroke-opacity:0.3;stroke-width:5;"></path></g><g id="LineCollection_3"><path clip-path="url(#p21880d0548)" d="M 256.165341 394.312567 
L 256.165341 29.954888 
" style="fill:none;stroke:#ff0000;stroke-dasharray:18.5,8;stroke-dashoffset:0;stroke-opacity:0.3;stroke-width:5;"></path></g><g id="line2d_55"><path clip-path="url(#p21880d0548)" d="M 96.892614 483.705335 
L 100.494258 433.778598 
L 104.095903 389.413264 
L 107.697547 349.888206 
L 111.299192 314.597073 
L 114.900837 283.026636 
L 118.502481 254.739833 
L 122.104126 229.362352 
L 125.70577 206.571939 
L 129.307415 186.089801 
L 132.90906 167.673648 
L 136.510704 151.112014 
L 140.112349 136.219599 
L 143.713993 122.833429 
L 147.315638 110.809658 
L 150.917282 100.020906 
L 154.518927 90.354022 
L 158.120572 81.708199 
L 161.722216 73.99338 
L 165.323861 67.1289 
L 168.925505 61.042324 
L 172.52715 55.66846 
L 176.128795 50.948498 
L 179.730439 46.829278 
L 183.332084 43.262645 
L 186.933728 40.2049 
L 190.535373 37.61631 
L 194.137017 35.46069 
L 197.738662 33.705027 
L 201.340307 32.31916 
L 204.941951 31.275485 
L 208.543596 30.548709 
L 212.14524 30.11562 
L 215.746885 29.954888 
L 219.34853 30.04689 
L 222.950174 30.37355 
L 226.551819 30.918198 
L 230.153463 31.665444 
L 233.755108 32.601064 
L 237.356753 33.711898 
L 240.958397 34.98576 
L 244.560042 36.411354 
L 248.161686 37.978199 
L 255.364975 41.497407 
L 262.568265 45.473454 
L 269.771554 49.84576 
L 276.974843 54.561691 
L 284.178132 59.575392 
L 291.381421 64.846819 
L 298.58471 70.340915 
L 309.389644 78.933334 
L 320.194578 87.86985 
L 330.999512 97.077187 
L 345.40609 109.6713 
L 363.414313 125.765086 
L 388.625825 148.651735 
L 442.650494 197.802394 
L 467.862006 220.393507 
L 489.471874 239.468348 
L 511.081741 258.235948 
L 532.691609 276.671733 
L 550.699832 291.770369 
L 568.708054 306.623167 
L 586.716277 321.227852 
L 604.7245 335.584154 
L 622.732723 349.69334 
L 640.740946 363.557853 
L 658.749169 377.18102 
L 676.757392 390.566837 
L 694.765615 403.719783 
L 716.375483 419.202744 
L 737.98535 434.36611 
L 759.595218 449.218939 
L 781.205085 463.770411 
L 802.814953 478.02971 
L 813.619886 485.052643 
L 813.619886 485.052643 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-width:1.5;"></path></g><g id="patch_3"><path d="M 61.05625 507.807531 
L 61.05625 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_4"><path d="M 849.45625 507.807531 
L 849.45625 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_5"><path d="M 61.05625 507.807531 
L 849.45625 507.807531 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_6"><path d="M 61.05625 7.2 
L 849.45625 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g></g></g><defs><clippath id="p21880d0548"><rect height="500.607531" width="788.4" x="61.05625" y="7.2"></rect></clippath></defs></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This gives the full spectrum of the sun from space, as would be seen from the ISS. The vertical dashed lines give reference wavelengths for blue, green and red.</p>
<p>Then, light from the sun meets the atmosphere. Due to the interactions with air particles, light is scattered (for a full reference see [<a href="https://file.scirp.org/pdf/ACS20120400011_46715429.pdf">Zagury, 2012</a>]), as is well described by a simple <a href="https://physics.stackexchange.com/questions/432874/simple-computation-of-the-spectrum-of-the-blue-sky">Rayleigh and Mie scattering formula</a>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">scattering</span><span class="p">(</span><span class="n">wav</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">1.3</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">0.45</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    b is  proportionate  to  the  column  density  of  aerosols  </span>
<span class="sd">    along  the  path  of  sunlight,  from  outside  the  atmosphere </span>
<span class="sd">    to  the  point  of  observation</span>
<span class="sd">    </span>
<span class="sd">    N_O3  is  the  ozone  column  density  along  the  path  of  sunlight,  </span>
<span class="sd">    sigma_O3 is  the  wavelength dependent ozone absorption cross-section.</span>
<span class="sd">    </span>
<span class="sd">    """</span>
    <span class="c1"># converting wav in µm:</span>
    <span class="n">intensity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">/</span><span class="p">((</span><span class="n">wav</span><span class="o">/</span><span class="mf">1e-6</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">))</span> <span class="c1"># Rayleigh extinction by nitrogen</span>
    <span class="n">intensity</span> <span class="o">*=</span> <span class="p">(</span><span class="n">wav</span><span class="o">/</span><span class="mf">1e-6</span><span class="p">)</span><span class="o">**-</span><span class="mi">4</span>
    <span class="n">intensity</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="o">/</span><span class="p">((</span><span class="n">wav</span><span class="o">/</span><span class="mf">1e-6</span><span class="p">)</span><span class="o">**</span><span class="n">p</span><span class="p">))</span> <span class="c1"># Aerosols</span>
    <span class="k">return</span> <span class="n">intensity</span>

<span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">400e-9</span><span class="p">,</span> <span class="mf">800e-9</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span> 
<span class="n">scatter</span> <span class="o">=</span> <span class="n">scattering</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
<span class="c1"># borrowed from https://github.com/gummiks/gummiks.github.io/blob/master/scripts/astro/planck.py</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="o">**</span><span class="n">adjustprops</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelengths</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="n">scatter</span> <span class="o">/</span> <span class="n">scatter</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="s1">'k--'</span><span class="p">)</span> 
<span class="n">opts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">445</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">555</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">'g'</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">'r'</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$\lambda$ (nm)'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'relative scatter'</span><span class="p">)</span>
<span class="c1">#ax.set_ylim(0)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">'log'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?><!-- Created with matplotlib (https://matplotlib.org/) --><svg height="555.041906pt" version="1.1" viewbox="0 0 873.65625 555.041906" width="873.65625pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><metadata><rdf xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><work><type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></type><date>2020-07-28T21:34:59.263592</date><format>image/svg+xml</format><creator><agent><title>Matplotlib v3.3.0, https://matplotlib.org/</title></agent></creator></work></rdf></metadata><defs><style type="text/css">*{stroke-linecap:butt;stroke-linejoin:round;}</style></defs><g id="figure_1"><g id="patch_1"><path d="M 0 555.041906 
L 873.65625 555.041906 
L 873.65625 0 
L 0 0 
z
" style="fill:none;"></path></g><g id="axes_1"><g id="patch_2"><path d="M 78.05625 507.807531 
L 866.45625 507.807531 
L 866.45625 7.2 
L 78.05625 7.2 
z
" style="fill:#ffffff;"></path></g><g id="matplotlib.axis_1"><g id="xtick_1"><g id="line2d_1"><defs><path d="M 0 0 
L 0 3.5 
" id="m49d2948919" style="stroke:#000000;stroke-width:0.8;"></path></defs><g><use style="stroke:#000000;stroke-width:0.8;" x="113.892614" xlink:href="#m49d2948919" y="507.807531"></use></g></g><g id="text_1"><!-- 400 --><g transform="translate(104.348864 522.405968)scale(0.1 -0.1)"><defs><path d="M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
" id="DejaVuSans-52"></path><path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path></defs><use xlink:href="#DejaVuSans-52"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_2"><g id="line2d_2"><g><use style="stroke:#000000;stroke-width:0.8;" x="203.483523" xlink:href="#m49d2948919" y="507.807531"></use></g></g><g id="text_2"><!-- 450 --><g transform="translate(193.939773 522.405968)scale(0.1 -0.1)"><defs><path d="M 10.796875 72.90625 
L 49.515625 72.90625 
L 49.515625 64.59375 
L 19.828125 64.59375 
L 19.828125 46.734375 
Q 21.96875 47.46875 24.109375 47.828125 
Q 26.265625 48.1875 28.421875 48.1875 
Q 40.625 48.1875 47.75 41.5 
Q 54.890625 34.8125 54.890625 23.390625 
Q 54.890625 11.625 47.5625 5.09375 
Q 40.234375 -1.421875 26.90625 -1.421875 
Q 22.3125 -1.421875 17.546875 -0.640625 
Q 12.796875 0.140625 7.71875 1.703125 
L 7.71875 11.625 
Q 12.109375 9.234375 16.796875 8.0625 
Q 21.484375 6.890625 26.703125 6.890625 
Q 35.15625 6.890625 40.078125 11.328125 
Q 45.015625 15.765625 45.015625 23.390625 
Q 45.015625 31 40.078125 35.4375 
Q 35.15625 39.890625 26.703125 39.890625 
Q 22.75 39.890625 18.8125 39.015625 
Q 14.890625 38.140625 10.796875 36.28125 
z
" id="DejaVuSans-53"></path></defs><use xlink:href="#DejaVuSans-52"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_3"><g id="line2d_3"><g><use style="stroke:#000000;stroke-width:0.8;" x="293.074432" xlink:href="#m49d2948919" y="507.807531"></use></g></g><g id="text_3"><!-- 500 --><g transform="translate(283.530682 522.405968)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-53"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_4"><g id="line2d_4"><g><use style="stroke:#000000;stroke-width:0.8;" x="382.665341" xlink:href="#m49d2948919" y="507.807531"></use></g></g><g id="text_4"><!-- 550 --><g transform="translate(373.121591 522.405968)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-53"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_5"><g id="line2d_5"><g><use style="stroke:#000000;stroke-width:0.8;" x="472.25625" xlink:href="#m49d2948919" y="507.807531"></use></g></g><g id="text_5"><!-- 600 --><g transform="translate(462.7125 522.405968)scale(0.1 -0.1)"><defs><path d="M 33.015625 40.375 
Q 26.375 40.375 22.484375 35.828125 
Q 18.609375 31.296875 18.609375 23.390625 
Q 18.609375 15.53125 22.484375 10.953125 
Q 26.375 6.390625 33.015625 6.390625 
Q 39.65625 6.390625 43.53125 10.953125 
Q 47.40625 15.53125 47.40625 23.390625 
Q 47.40625 31.296875 43.53125 35.828125 
Q 39.65625 40.375 33.015625 40.375 
z
M 52.59375 71.296875 
L 52.59375 62.3125 
Q 48.875 64.0625 45.09375 64.984375 
Q 41.3125 65.921875 37.59375 65.921875 
Q 27.828125 65.921875 22.671875 59.328125 
Q 17.53125 52.734375 16.796875 39.40625 
Q 19.671875 43.65625 24.015625 45.921875 
Q 28.375 48.1875 33.59375 48.1875 
Q 44.578125 48.1875 50.953125 41.515625 
Q 57.328125 34.859375 57.328125 23.390625 
Q 57.328125 12.15625 50.6875 5.359375 
Q 44.046875 -1.421875 33.015625 -1.421875 
Q 20.359375 -1.421875 13.671875 8.265625 
Q 6.984375 17.96875 6.984375 36.375 
Q 6.984375 53.65625 15.1875 63.9375 
Q 23.390625 74.21875 37.203125 74.21875 
Q 40.921875 74.21875 44.703125 73.484375 
Q 48.484375 72.75 52.59375 71.296875 
z
" id="DejaVuSans-54"></path></defs><use xlink:href="#DejaVuSans-54"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_6"><g id="line2d_6"><g><use style="stroke:#000000;stroke-width:0.8;" x="561.847159" xlink:href="#m49d2948919" y="507.807531"></use></g></g><g id="text_6"><!-- 650 --><g transform="translate(552.303409 522.405968)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-54"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_7"><g id="line2d_7"><g><use style="stroke:#000000;stroke-width:0.8;" x="651.438068" xlink:href="#m49d2948919" y="507.807531"></use></g></g><g id="text_7"><!-- 700 --><g transform="translate(641.894318 522.405968)scale(0.1 -0.1)"><defs><path d="M 8.203125 72.90625 
L 55.078125 72.90625 
L 55.078125 68.703125 
L 28.609375 0 
L 18.3125 0 
L 43.21875 64.59375 
L 8.203125 64.59375 
z
" id="DejaVuSans-55"></path></defs><use xlink:href="#DejaVuSans-55"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_8"><g id="line2d_8"><g><use style="stroke:#000000;stroke-width:0.8;" x="741.028977" xlink:href="#m49d2948919" y="507.807531"></use></g></g><g id="text_8"><!-- 750 --><g transform="translate(731.485227 522.405968)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-55"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_9"><g id="line2d_9"><g><use style="stroke:#000000;stroke-width:0.8;" x="830.619886" xlink:href="#m49d2948919" y="507.807531"></use></g></g><g id="text_9"><!-- 800 --><g transform="translate(821.076136 522.405968)scale(0.1 -0.1)"><defs><path d="M 31.78125 34.625 
Q 24.75 34.625 20.71875 30.859375 
Q 16.703125 27.09375 16.703125 20.515625 
Q 16.703125 13.921875 20.71875 10.15625 
Q 24.75 6.390625 31.78125 6.390625 
Q 38.8125 6.390625 42.859375 10.171875 
Q 46.921875 13.96875 46.921875 20.515625 
Q 46.921875 27.09375 42.890625 30.859375 
Q 38.875 34.625 31.78125 34.625 
z
M 21.921875 38.8125 
Q 15.578125 40.375 12.03125 44.71875 
Q 8.5 49.078125 8.5 55.328125 
Q 8.5 64.0625 14.71875 69.140625 
Q 20.953125 74.21875 31.78125 74.21875 
Q 42.671875 74.21875 48.875 69.140625 
Q 55.078125 64.0625 55.078125 55.328125 
Q 55.078125 49.078125 51.53125 44.71875 
Q 48 40.375 41.703125 38.8125 
Q 48.828125 37.15625 52.796875 32.3125 
Q 56.78125 27.484375 56.78125 20.515625 
Q 56.78125 9.90625 50.3125 4.234375 
Q 43.84375 -1.421875 31.78125 -1.421875 
Q 19.734375 -1.421875 13.25 4.234375 
Q 6.78125 9.90625 6.78125 20.515625 
Q 6.78125 27.484375 10.78125 32.3125 
Q 14.796875 37.15625 21.921875 38.8125 
z
M 18.3125 54.390625 
Q 18.3125 48.734375 21.84375 45.5625 
Q 25.390625 42.390625 31.78125 42.390625 
Q 38.140625 42.390625 41.71875 45.5625 
Q 45.3125 48.734375 45.3125 54.390625 
Q 45.3125 60.0625 41.71875 63.234375 
Q 38.140625 66.40625 31.78125 66.40625 
Q 25.390625 66.40625 21.84375 63.234375 
Q 18.3125 60.0625 18.3125 54.390625 
z
" id="DejaVuSans-56"></path></defs><use xlink:href="#DejaVuSans-56"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_10"><g id="line2d_10"><defs><path d="M 0 0 
L 0 2 
" id="mbf73399d69" style="stroke:#000000;stroke-width:0.6;"></path></defs><g><use style="stroke:#000000;stroke-width:0.6;" x="95.974432" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_11"><g id="line2d_11"><g><use style="stroke:#000000;stroke-width:0.6;" x="131.810795" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_12"><g id="line2d_12"><g><use style="stroke:#000000;stroke-width:0.6;" x="149.728977" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_13"><g id="line2d_13"><g><use style="stroke:#000000;stroke-width:0.6;" x="167.647159" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_14"><g id="line2d_14"><g><use style="stroke:#000000;stroke-width:0.6;" x="185.565341" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_15"><g id="line2d_15"><g><use style="stroke:#000000;stroke-width:0.6;" x="221.401705" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_16"><g id="line2d_16"><g><use style="stroke:#000000;stroke-width:0.6;" x="239.319886" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_17"><g id="line2d_17"><g><use style="stroke:#000000;stroke-width:0.6;" x="257.238068" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_18"><g id="line2d_18"><g><use style="stroke:#000000;stroke-width:0.6;" x="275.15625" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_19"><g id="line2d_19"><g><use style="stroke:#000000;stroke-width:0.6;" x="310.992614" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_20"><g id="line2d_20"><g><use style="stroke:#000000;stroke-width:0.6;" x="328.910795" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_21"><g id="line2d_21"><g><use style="stroke:#000000;stroke-width:0.6;" x="346.828977" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_22"><g id="line2d_22"><g><use style="stroke:#000000;stroke-width:0.6;" x="364.747159" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_23"><g id="line2d_23"><g><use style="stroke:#000000;stroke-width:0.6;" x="400.583523" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_24"><g id="line2d_24"><g><use style="stroke:#000000;stroke-width:0.6;" x="418.501705" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_25"><g id="line2d_25"><g><use style="stroke:#000000;stroke-width:0.6;" x="436.419886" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_26"><g id="line2d_26"><g><use style="stroke:#000000;stroke-width:0.6;" x="454.338068" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_27"><g id="line2d_27"><g><use style="stroke:#000000;stroke-width:0.6;" x="490.174432" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_28"><g id="line2d_28"><g><use style="stroke:#000000;stroke-width:0.6;" x="508.092614" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_29"><g id="line2d_29"><g><use style="stroke:#000000;stroke-width:0.6;" x="526.010795" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_30"><g id="line2d_30"><g><use style="stroke:#000000;stroke-width:0.6;" x="543.928977" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_31"><g id="line2d_31"><g><use style="stroke:#000000;stroke-width:0.6;" x="579.765341" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_32"><g id="line2d_32"><g><use style="stroke:#000000;stroke-width:0.6;" x="597.683523" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_33"><g id="line2d_33"><g><use style="stroke:#000000;stroke-width:0.6;" x="615.601705" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_34"><g id="line2d_34"><g><use style="stroke:#000000;stroke-width:0.6;" x="633.519886" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_35"><g id="line2d_35"><g><use style="stroke:#000000;stroke-width:0.6;" x="669.35625" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_36"><g id="line2d_36"><g><use style="stroke:#000000;stroke-width:0.6;" x="687.274432" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_37"><g id="line2d_37"><g><use style="stroke:#000000;stroke-width:0.6;" x="705.192614" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_38"><g id="line2d_38"><g><use style="stroke:#000000;stroke-width:0.6;" x="723.110795" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_39"><g id="line2d_39"><g><use style="stroke:#000000;stroke-width:0.6;" x="758.947159" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_40"><g id="line2d_40"><g><use style="stroke:#000000;stroke-width:0.6;" x="776.865341" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_41"><g id="line2d_41"><g><use style="stroke:#000000;stroke-width:0.6;" x="794.783523" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_42"><g id="line2d_42"><g><use style="stroke:#000000;stroke-width:0.6;" x="812.701705" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_43"><g id="line2d_43"><g><use style="stroke:#000000;stroke-width:0.6;" x="848.538068" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="xtick_44"><g id="line2d_44"><g><use style="stroke:#000000;stroke-width:0.6;" x="866.45625" xlink:href="#mbf73399d69" y="507.807531"></use></g></g></g><g id="text_10"><!-- $\lambda$ (nm) --><g transform="translate(439.25625 543.682531)scale(0.2 -0.2)"><defs><path d="M 36.71875 67.4375 
L 48.828125 0 
L 39.3125 0 
L 31.84375 40.4375 
L 5.125 0 
L -4.390625 0 
L 29.734375 52.4375 
L 28.03125 62.109375 
Q 26.953125 68.265625 21.734375 68.265625 
L 17.046875 68.265625 
L 18.5 75.984375 
L 24.21875 75.875 
Q 35.203125 75.734375 36.71875 67.4375 
z
" id="DejaVuSans-Oblique-955"></path><path id="DejaVuSans-32"></path><path d="M 31 75.875 
Q 24.46875 64.65625 21.28125 53.65625 
Q 18.109375 42.671875 18.109375 31.390625 
Q 18.109375 20.125 21.3125 9.0625 
Q 24.515625 -2 31 -13.1875 
L 23.1875 -13.1875 
Q 15.875 -1.703125 12.234375 9.375 
Q 8.59375 20.453125 8.59375 31.390625 
Q 8.59375 42.28125 12.203125 53.3125 
Q 15.828125 64.359375 23.1875 75.875 
z
" id="DejaVuSans-40"></path><path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-110"></path><path d="M 52 44.1875 
Q 55.375 50.25 60.0625 53.125 
Q 64.75 56 71.09375 56 
Q 79.640625 56 84.28125 50.015625 
Q 88.921875 44.046875 88.921875 33.015625 
L 88.921875 0 
L 79.890625 0 
L 79.890625 32.71875 
Q 79.890625 40.578125 77.09375 44.375 
Q 74.3125 48.1875 68.609375 48.1875 
Q 61.625 48.1875 57.5625 43.546875 
Q 53.515625 38.921875 53.515625 30.90625 
L 53.515625 0 
L 44.484375 0 
L 44.484375 32.71875 
Q 44.484375 40.625 41.703125 44.40625 
Q 38.921875 48.1875 33.109375 48.1875 
Q 26.21875 48.1875 22.15625 43.53125 
Q 18.109375 38.875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.1875 51.21875 25.484375 53.609375 
Q 29.78125 56 35.6875 56 
Q 41.65625 56 45.828125 52.96875 
Q 50 49.953125 52 44.1875 
z
" id="DejaVuSans-109"></path><path d="M 8.015625 75.875 
L 15.828125 75.875 
Q 23.140625 64.359375 26.78125 53.3125 
Q 30.421875 42.28125 30.421875 31.390625 
Q 30.421875 20.453125 26.78125 9.375 
Q 23.140625 -1.703125 15.828125 -13.1875 
L 8.015625 -13.1875 
Q 14.5 -2 17.703125 9.0625 
Q 20.90625 20.125 20.90625 31.390625 
Q 20.90625 42.671875 17.703125 53.65625 
Q 14.5 64.65625 8.015625 75.875 
z
" id="DejaVuSans-41"></path></defs><use transform="translate(0 0.015625)" xlink:href="#DejaVuSans-Oblique-955"></use><use transform="translate(59.179688 0.015625)" xlink:href="#DejaVuSans-32"></use><use transform="translate(90.966797 0.015625)" xlink:href="#DejaVuSans-40"></use><use transform="translate(129.980469 0.015625)" xlink:href="#DejaVuSans-110"></use><use transform="translate(193.359375 0.015625)" xlink:href="#DejaVuSans-109"></use><use transform="translate(290.771484 0.015625)" xlink:href="#DejaVuSans-41"></use></g></g></g><g id="matplotlib.axis_2"><g id="ytick_1"><g id="line2d_45"><defs><path d="M 0 0 
L -3.5 0 
" id="mf2931e165f" style="stroke:#000000;stroke-width:0.8;"></path></defs><g><use style="stroke:#000000;stroke-width:0.8;" x="78.05625" xlink:href="#mf2931e165f" y="223.241632"></use></g></g><g id="text_11"><!-- $\mathdefault{10^{0}}$ --><g transform="translate(53.45625 227.040851)scale(0.1 -0.1)"><defs><path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path></defs><use transform="translate(0 0.765625)" xlink:href="#DejaVuSans-49"></use><use transform="translate(63.623047 0.765625)" xlink:href="#DejaVuSans-48"></use><use transform="translate(128.203125 39.046875)scale(0.7)" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_2"><g id="line2d_46"><defs><path d="M 0 0 
L -2 0 
" id="m33d24b6dc5" style="stroke:#000000;stroke-width:0.6;"></path></defs><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m33d24b6dc5" y="467.102689"></use></g></g><g id="text_12"><!-- $\mathdefault{4\times10^{-1}}$ --><g transform="translate(30.55625 470.901908)scale(0.1 -0.1)"><defs><path d="M 70.125 53.71875 
L 47.796875 31.296875 
L 70.125 8.984375 
L 64.3125 3.078125 
L 41.890625 25.484375 
L 19.484375 3.078125 
L 13.71875 8.984375 
L 35.984375 31.296875 
L 13.71875 53.71875 
L 19.484375 59.625 
L 41.890625 37.203125 
L 64.3125 59.625 
z
" id="DejaVuSans-215"></path><path d="M 10.59375 35.5 
L 73.1875 35.5 
L 73.1875 27.203125 
L 10.59375 27.203125 
z
" id="DejaVuSans-8722"></path></defs><use transform="translate(0 0.684375)" xlink:href="#DejaVuSans-52"></use><use transform="translate(83.105469 0.684375)" xlink:href="#DejaVuSans-215"></use><use transform="translate(186.376953 0.684375)" xlink:href="#DejaVuSans-49"></use><use transform="translate(250 0.684375)" xlink:href="#DejaVuSans-48"></use><use transform="translate(314.580078 38.965625)scale(0.7)" xlink:href="#DejaVuSans-8722"></use><use transform="translate(373.232422 38.965625)scale(0.7)" xlink:href="#DejaVuSans-49"></use></g></g></g><g id="ytick_3"><g id="line2d_47"><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m33d24b6dc5" y="407.7154"></use></g></g></g><g id="ytick_4"><g id="line2d_48"><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m33d24b6dc5" y="359.192452"></use></g></g><g id="text_13"><!-- $\mathdefault{6\times10^{-1}}$ --><g transform="translate(30.55625 362.991671)scale(0.1 -0.1)"><use transform="translate(0 0.684375)" xlink:href="#DejaVuSans-54"></use><use transform="translate(83.105469 0.684375)" xlink:href="#DejaVuSans-215"></use><use transform="translate(186.376953 0.684375)" xlink:href="#DejaVuSans-49"></use><use transform="translate(250 0.684375)" xlink:href="#DejaVuSans-48"></use><use transform="translate(314.580078 38.965625)scale(0.7)" xlink:href="#DejaVuSans-8722"></use><use transform="translate(373.232422 38.965625)scale(0.7)" xlink:href="#DejaVuSans-49"></use></g></g></g><g id="ytick_5"><g id="line2d_49"><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m33d24b6dc5" y="318.166884"></use></g></g></g><g id="ytick_6"><g id="line2d_50"><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m33d24b6dc5" y="282.628921"></use></g></g></g><g id="ytick_7"><g id="line2d_51"><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m33d24b6dc5" y="251.282216"></use></g></g></g><g id="ytick_8"><g id="line2d_52"><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m33d24b6dc5" y="38.767864"></use></g></g><g id="text_14"><!-- $\mathdefault{2\times10^{0}}$ --><g transform="translate(36.45625 42.567083)scale(0.1 -0.1)"><defs><path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path></defs><use transform="translate(0 0.765625)" xlink:href="#DejaVuSans-50"></use><use transform="translate(83.105469 0.765625)" xlink:href="#DejaVuSans-215"></use><use transform="translate(186.376953 0.765625)" xlink:href="#DejaVuSans-49"></use><use transform="translate(250 0.765625)" xlink:href="#DejaVuSans-48"></use><use transform="translate(314.580078 39.046875)scale(0.7)" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="text_15"><!-- relative scatter --><g transform="translate(22.396875 333.33814)rotate(-90)scale(0.2 -0.2)"><defs><path d="M 41.109375 46.296875 
Q 39.59375 47.171875 37.8125 47.578125 
Q 36.03125 48 33.890625 48 
Q 26.265625 48 22.1875 43.046875 
Q 18.109375 38.09375 18.109375 28.8125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 20.953125 51.171875 25.484375 53.578125 
Q 30.03125 56 36.53125 56 
Q 37.453125 56 38.578125 55.875 
Q 39.703125 55.765625 41.0625 55.515625 
z
" id="DejaVuSans-114"></path><path d="M 56.203125 29.59375 
L 56.203125 25.203125 
L 14.890625 25.203125 
Q 15.484375 15.921875 20.484375 11.0625 
Q 25.484375 6.203125 34.421875 6.203125 
Q 39.59375 6.203125 44.453125 7.46875 
Q 49.3125 8.734375 54.109375 11.28125 
L 54.109375 2.78125 
Q 49.265625 0.734375 44.1875 -0.34375 
Q 39.109375 -1.421875 33.890625 -1.421875 
Q 20.796875 -1.421875 13.15625 6.1875 
Q 5.515625 13.8125 5.515625 26.8125 
Q 5.515625 40.234375 12.765625 48.109375 
Q 20.015625 56 32.328125 56 
Q 43.359375 56 49.78125 48.890625 
Q 56.203125 41.796875 56.203125 29.59375 
z
M 47.21875 32.234375 
Q 47.125 39.59375 43.09375 43.984375 
Q 39.0625 48.390625 32.421875 48.390625 
Q 24.90625 48.390625 20.390625 44.140625 
Q 15.875 39.890625 15.1875 32.171875 
z
" id="DejaVuSans-101"></path><path d="M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 0 
L 9.421875 0 
z
" id="DejaVuSans-108"></path><path d="M 34.28125 27.484375 
Q 23.390625 27.484375 19.1875 25 
Q 14.984375 22.515625 14.984375 16.5 
Q 14.984375 11.71875 18.140625 8.90625 
Q 21.296875 6.109375 26.703125 6.109375 
Q 34.1875 6.109375 38.703125 11.40625 
Q 43.21875 16.703125 43.21875 25.484375 
L 43.21875 27.484375 
z
M 52.203125 31.203125 
L 52.203125 0 
L 43.21875 0 
L 43.21875 8.296875 
Q 40.140625 3.328125 35.546875 0.953125 
Q 30.953125 -1.421875 24.3125 -1.421875 
Q 15.921875 -1.421875 10.953125 3.296875 
Q 6 8.015625 6 15.921875 
Q 6 25.140625 12.171875 29.828125 
Q 18.359375 34.515625 30.609375 34.515625 
L 43.21875 34.515625 
L 43.21875 35.40625 
Q 43.21875 41.609375 39.140625 45 
Q 35.0625 48.390625 27.6875 48.390625 
Q 23 48.390625 18.546875 47.265625 
Q 14.109375 46.140625 10.015625 43.890625 
L 10.015625 52.203125 
Q 14.9375 54.109375 19.578125 55.046875 
Q 24.21875 56 28.609375 56 
Q 40.484375 56 46.34375 49.84375 
Q 52.203125 43.703125 52.203125 31.203125 
z
" id="DejaVuSans-97"></path><path d="M 18.3125 70.21875 
L 18.3125 54.6875 
L 36.8125 54.6875 
L 36.8125 47.703125 
L 18.3125 47.703125 
L 18.3125 18.015625 
Q 18.3125 11.328125 20.140625 9.421875 
Q 21.96875 7.515625 27.59375 7.515625 
L 36.8125 7.515625 
L 36.8125 0 
L 27.59375 0 
Q 17.1875 0 13.234375 3.875 
Q 9.28125 7.765625 9.28125 18.015625 
L 9.28125 47.703125 
L 2.6875 47.703125 
L 2.6875 54.6875 
L 9.28125 54.6875 
L 9.28125 70.21875 
z
" id="DejaVuSans-116"></path><path d="M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 0 
L 9.421875 0 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
" id="DejaVuSans-105"></path><path d="M 2.984375 54.6875 
L 12.5 54.6875 
L 29.59375 8.796875 
L 46.6875 54.6875 
L 56.203125 54.6875 
L 35.6875 0 
L 23.484375 0 
z
" id="DejaVuSans-118"></path><path d="M 44.28125 53.078125 
L 44.28125 44.578125 
Q 40.484375 46.53125 36.375 47.5 
Q 32.28125 48.484375 27.875 48.484375 
Q 21.1875 48.484375 17.84375 46.4375 
Q 14.5 44.390625 14.5 40.28125 
Q 14.5 37.15625 16.890625 35.375 
Q 19.28125 33.59375 26.515625 31.984375 
L 29.59375 31.296875 
Q 39.15625 29.25 43.1875 25.515625 
Q 47.21875 21.78125 47.21875 15.09375 
Q 47.21875 7.46875 41.1875 3.015625 
Q 35.15625 -1.421875 24.609375 -1.421875 
Q 20.21875 -1.421875 15.453125 -0.5625 
Q 10.6875 0.296875 5.421875 2 
L 5.421875 11.28125 
Q 10.40625 8.6875 15.234375 7.390625 
Q 20.0625 6.109375 24.8125 6.109375 
Q 31.15625 6.109375 34.5625 8.28125 
Q 37.984375 10.453125 37.984375 14.40625 
Q 37.984375 18.0625 35.515625 20.015625 
Q 33.0625 21.96875 24.703125 23.78125 
L 21.578125 24.515625 
Q 13.234375 26.265625 9.515625 29.90625 
Q 5.8125 33.546875 5.8125 39.890625 
Q 5.8125 47.609375 11.28125 51.796875 
Q 16.75 56 26.8125 56 
Q 31.78125 56 36.171875 55.265625 
Q 40.578125 54.546875 44.28125 53.078125 
z
" id="DejaVuSans-115"></path><path d="M 48.78125 52.59375 
L 48.78125 44.1875 
Q 44.96875 46.296875 41.140625 47.34375 
Q 37.3125 48.390625 33.40625 48.390625 
Q 24.65625 48.390625 19.8125 42.84375 
Q 14.984375 37.3125 14.984375 27.296875 
Q 14.984375 17.28125 19.8125 11.734375 
Q 24.65625 6.203125 33.40625 6.203125 
Q 37.3125 6.203125 41.140625 7.25 
Q 44.96875 8.296875 48.78125 10.40625 
L 48.78125 2.09375 
Q 45.015625 0.34375 40.984375 -0.53125 
Q 36.96875 -1.421875 32.421875 -1.421875 
Q 20.0625 -1.421875 12.78125 6.34375 
Q 5.515625 14.109375 5.515625 27.296875 
Q 5.515625 40.671875 12.859375 48.328125 
Q 20.21875 56 33.015625 56 
Q 37.15625 56 41.109375 55.140625 
Q 45.0625 54.296875 48.78125 52.59375 
z
" id="DejaVuSans-99"></path></defs><use xlink:href="#DejaVuSans-114"></use><use x="38.863281" xlink:href="#DejaVuSans-101"></use><use x="100.386719" xlink:href="#DejaVuSans-108"></use><use x="128.169922" xlink:href="#DejaVuSans-97"></use><use x="189.449219" xlink:href="#DejaVuSans-116"></use><use x="228.658203" xlink:href="#DejaVuSans-105"></use><use x="256.441406" xlink:href="#DejaVuSans-118"></use><use x="315.621094" xlink:href="#DejaVuSans-101"></use><use x="377.144531" xlink:href="#DejaVuSans-32"></use><use x="408.931641" xlink:href="#DejaVuSans-115"></use><use x="461.03125" xlink:href="#DejaVuSans-99"></use><use x="516.011719" xlink:href="#DejaVuSans-97"></use><use x="577.291016" xlink:href="#DejaVuSans-116"></use><use x="616.5" xlink:href="#DejaVuSans-116"></use><use x="655.708984" xlink:href="#DejaVuSans-101"></use><use x="717.232422" xlink:href="#DejaVuSans-114"></use></g></g></g><g id="LineCollection_1"><path clip-path="url(#p447c2c13d7)" d="M 194.524432 556.041906 
L 194.524432 38.767864 
" style="fill:none;stroke:#0000ff;stroke-dasharray:18.5,8;stroke-dashoffset:0;stroke-opacity:0.3;stroke-width:5;"></path></g><g id="LineCollection_2"><path clip-path="url(#p447c2c13d7)" d="M 391.624432 556.041906 
L 391.624432 38.767864 
" style="fill:none;stroke:#008000;stroke-dasharray:18.5,8;stroke-dashoffset:0;stroke-opacity:0.3;stroke-width:5;"></path></g><g id="LineCollection_3"><path clip-path="url(#p447c2c13d7)" d="M 472.25625 556.041906 
L 472.25625 38.767864 
" style="fill:none;stroke:#ff0000;stroke-dasharray:18.5,8;stroke-dashoffset:0;stroke-opacity:0.3;stroke-width:5;"></path></g><g id="line2d_53"><path clip-path="url(#p447c2c13d7)" d="M 113.892614 29.954888 
L 124.697547 35.271395 
L 135.502481 40.824206 
L 146.307415 46.589733 
L 160.713993 54.571366 
L 175.120572 62.848203 
L 189.52715 71.380493 
L 207.535373 82.352137 
L 225.543596 93.609011 
L 247.153463 107.422444 
L 268.763331 121.498774 
L 293.974843 138.170616 
L 326.389644 159.876819 
L 376.812668 193.955477 
L 459.650494 249.946084 
L 502.870229 278.871553 
L 542.488319 305.107774 
L 578.504765 328.686272 
L 614.521211 351.978842 
L 646.936012 372.682676 
L 679.350814 393.131053 
L 711.765615 413.317724 
L 744.180416 433.238799 
L 776.595218 452.892277 
L 809.010019 472.27767 
L 830.619886 485.052643 
L 830.619886 485.052643 
" style="fill:none;stroke:#000000;stroke-dasharray:5.55,2.4;stroke-dashoffset:0;stroke-width:1.5;"></path></g><g id="patch_3"><path d="M 78.05625 507.807531 
L 78.05625 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_4"><path d="M 866.45625 507.807531 
L 866.45625 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_5"><path d="M 78.05625 507.807531 
L 866.45625 507.807531 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_6"><path d="M 78.05625 7.2 
L 866.45625 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g></g></g><defs><clippath id="p447c2c13d7"><rect height="500.607531" width="788.4" x="78.05625" y="7.2"></rect></clippath></defs></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Combined, this gives the spectrum of a blue sky in the range of visible wavelengths:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">380e-9</span><span class="p">,</span> <span class="mf">780e-9</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span> 
<span class="n">intensity5800</span> <span class="o">=</span> <span class="n">planck</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">5800.</span><span class="p">)</span>
<span class="n">absorption</span> <span class="o">=</span> <span class="n">scattering</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">)</span>
<span class="n">intensity</span> <span class="o">=</span> <span class="n">intensity5800</span> <span class="o">*</span> <span class="n">scatter</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="o">**</span><span class="n">adjustprops</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelengths</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="n">intensity</span> <span class="o">/</span> <span class="n">intensity</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="s1">'k-'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">445</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">555</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">'g'</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">'r'</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$\lambda$ (nm)'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'relative spectral radiance of blue sky'</span><span class="p">)</span>
<span class="c1">#ax.set_ylim(0)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">'log'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?><!-- Created with matplotlib (https://matplotlib.org/) --><svg height="555.041906pt" version="1.1" viewbox="0 0 883.2 555.041906" width="883.2pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><metadata><rdf xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><work><type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></type><date>2020-07-28T21:35:00.340676</date><format>image/svg+xml</format><creator><agent><title>Matplotlib v3.3.0, https://matplotlib.org/</title></agent></creator></work></rdf></metadata><defs><style type="text/css">*{stroke-linecap:butt;stroke-linejoin:round;}</style></defs><g id="figure_1"><g id="patch_1"><path d="M 0 555.041906 
L 883.2 555.041906 
L 883.2 0 
L 0 0 
z
" style="fill:none;"></path></g><g id="axes_1"><g id="patch_2"><path d="M 78.05625 507.807531 
L 866.45625 507.807531 
L 866.45625 7.2 
L 78.05625 7.2 
z
" style="fill:#ffffff;"></path></g><g id="matplotlib.axis_1"><g id="xtick_1"><g id="line2d_1"><defs><path d="M 0 0 
L 0 3.5 
" id="mab400f8b85" style="stroke:#000000;stroke-width:0.8;"></path></defs><g><use style="stroke:#000000;stroke-width:0.8;" x="149.728977" xlink:href="#mab400f8b85" y="507.807531"></use></g></g><g id="text_1"><!-- 400 --><g transform="translate(140.185227 522.405968)scale(0.1 -0.1)"><defs><path d="M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
" id="DejaVuSans-52"></path><path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path></defs><use xlink:href="#DejaVuSans-52"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_2"><g id="line2d_2"><g><use style="stroke:#000000;stroke-width:0.8;" x="239.319886" xlink:href="#mab400f8b85" y="507.807531"></use></g></g><g id="text_2"><!-- 450 --><g transform="translate(229.776136 522.405968)scale(0.1 -0.1)"><defs><path d="M 10.796875 72.90625 
L 49.515625 72.90625 
L 49.515625 64.59375 
L 19.828125 64.59375 
L 19.828125 46.734375 
Q 21.96875 47.46875 24.109375 47.828125 
Q 26.265625 48.1875 28.421875 48.1875 
Q 40.625 48.1875 47.75 41.5 
Q 54.890625 34.8125 54.890625 23.390625 
Q 54.890625 11.625 47.5625 5.09375 
Q 40.234375 -1.421875 26.90625 -1.421875 
Q 22.3125 -1.421875 17.546875 -0.640625 
Q 12.796875 0.140625 7.71875 1.703125 
L 7.71875 11.625 
Q 12.109375 9.234375 16.796875 8.0625 
Q 21.484375 6.890625 26.703125 6.890625 
Q 35.15625 6.890625 40.078125 11.328125 
Q 45.015625 15.765625 45.015625 23.390625 
Q 45.015625 31 40.078125 35.4375 
Q 35.15625 39.890625 26.703125 39.890625 
Q 22.75 39.890625 18.8125 39.015625 
Q 14.890625 38.140625 10.796875 36.28125 
z
" id="DejaVuSans-53"></path></defs><use xlink:href="#DejaVuSans-52"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_3"><g id="line2d_3"><g><use style="stroke:#000000;stroke-width:0.8;" x="328.910795" xlink:href="#mab400f8b85" y="507.807531"></use></g></g><g id="text_3"><!-- 500 --><g transform="translate(319.367045 522.405968)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-53"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_4"><g id="line2d_4"><g><use style="stroke:#000000;stroke-width:0.8;" x="418.501705" xlink:href="#mab400f8b85" y="507.807531"></use></g></g><g id="text_4"><!-- 550 --><g transform="translate(408.957955 522.405968)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-53"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_5"><g id="line2d_5"><g><use style="stroke:#000000;stroke-width:0.8;" x="508.092614" xlink:href="#mab400f8b85" y="507.807531"></use></g></g><g id="text_5"><!-- 600 --><g transform="translate(498.548864 522.405968)scale(0.1 -0.1)"><defs><path d="M 33.015625 40.375 
Q 26.375 40.375 22.484375 35.828125 
Q 18.609375 31.296875 18.609375 23.390625 
Q 18.609375 15.53125 22.484375 10.953125 
Q 26.375 6.390625 33.015625 6.390625 
Q 39.65625 6.390625 43.53125 10.953125 
Q 47.40625 15.53125 47.40625 23.390625 
Q 47.40625 31.296875 43.53125 35.828125 
Q 39.65625 40.375 33.015625 40.375 
z
M 52.59375 71.296875 
L 52.59375 62.3125 
Q 48.875 64.0625 45.09375 64.984375 
Q 41.3125 65.921875 37.59375 65.921875 
Q 27.828125 65.921875 22.671875 59.328125 
Q 17.53125 52.734375 16.796875 39.40625 
Q 19.671875 43.65625 24.015625 45.921875 
Q 28.375 48.1875 33.59375 48.1875 
Q 44.578125 48.1875 50.953125 41.515625 
Q 57.328125 34.859375 57.328125 23.390625 
Q 57.328125 12.15625 50.6875 5.359375 
Q 44.046875 -1.421875 33.015625 -1.421875 
Q 20.359375 -1.421875 13.671875 8.265625 
Q 6.984375 17.96875 6.984375 36.375 
Q 6.984375 53.65625 15.1875 63.9375 
Q 23.390625 74.21875 37.203125 74.21875 
Q 40.921875 74.21875 44.703125 73.484375 
Q 48.484375 72.75 52.59375 71.296875 
z
" id="DejaVuSans-54"></path></defs><use xlink:href="#DejaVuSans-54"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_6"><g id="line2d_6"><g><use style="stroke:#000000;stroke-width:0.8;" x="597.683523" xlink:href="#mab400f8b85" y="507.807531"></use></g></g><g id="text_6"><!-- 650 --><g transform="translate(588.139773 522.405968)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-54"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_7"><g id="line2d_7"><g><use style="stroke:#000000;stroke-width:0.8;" x="687.274432" xlink:href="#mab400f8b85" y="507.807531"></use></g></g><g id="text_7"><!-- 700 --><g transform="translate(677.730682 522.405968)scale(0.1 -0.1)"><defs><path d="M 8.203125 72.90625 
L 55.078125 72.90625 
L 55.078125 68.703125 
L 28.609375 0 
L 18.3125 0 
L 43.21875 64.59375 
L 8.203125 64.59375 
z
" id="DejaVuSans-55"></path></defs><use xlink:href="#DejaVuSans-55"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_8"><g id="line2d_8"><g><use style="stroke:#000000;stroke-width:0.8;" x="776.865341" xlink:href="#mab400f8b85" y="507.807531"></use></g></g><g id="text_8"><!-- 750 --><g transform="translate(767.321591 522.405968)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-55"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_9"><g id="line2d_9"><g><use style="stroke:#000000;stroke-width:0.8;" x="866.45625" xlink:href="#mab400f8b85" y="507.807531"></use></g></g><g id="text_9"><!-- 800 --><g transform="translate(856.9125 522.405968)scale(0.1 -0.1)"><defs><path d="M 31.78125 34.625 
Q 24.75 34.625 20.71875 30.859375 
Q 16.703125 27.09375 16.703125 20.515625 
Q 16.703125 13.921875 20.71875 10.15625 
Q 24.75 6.390625 31.78125 6.390625 
Q 38.8125 6.390625 42.859375 10.171875 
Q 46.921875 13.96875 46.921875 20.515625 
Q 46.921875 27.09375 42.890625 30.859375 
Q 38.875 34.625 31.78125 34.625 
z
M 21.921875 38.8125 
Q 15.578125 40.375 12.03125 44.71875 
Q 8.5 49.078125 8.5 55.328125 
Q 8.5 64.0625 14.71875 69.140625 
Q 20.953125 74.21875 31.78125 74.21875 
Q 42.671875 74.21875 48.875 69.140625 
Q 55.078125 64.0625 55.078125 55.328125 
Q 55.078125 49.078125 51.53125 44.71875 
Q 48 40.375 41.703125 38.8125 
Q 48.828125 37.15625 52.796875 32.3125 
Q 56.78125 27.484375 56.78125 20.515625 
Q 56.78125 9.90625 50.3125 4.234375 
Q 43.84375 -1.421875 31.78125 -1.421875 
Q 19.734375 -1.421875 13.25 4.234375 
Q 6.78125 9.90625 6.78125 20.515625 
Q 6.78125 27.484375 10.78125 32.3125 
Q 14.796875 37.15625 21.921875 38.8125 
z
M 18.3125 54.390625 
Q 18.3125 48.734375 21.84375 45.5625 
Q 25.390625 42.390625 31.78125 42.390625 
Q 38.140625 42.390625 41.71875 45.5625 
Q 45.3125 48.734375 45.3125 54.390625 
Q 45.3125 60.0625 41.71875 63.234375 
Q 38.140625 66.40625 31.78125 66.40625 
Q 25.390625 66.40625 21.84375 63.234375 
Q 18.3125 60.0625 18.3125 54.390625 
z
" id="DejaVuSans-56"></path></defs><use xlink:href="#DejaVuSans-56"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_10"><g id="line2d_10"><defs><path d="M 0 0 
L 0 2 
" id="me0627562b2" style="stroke:#000000;stroke-width:0.6;"></path></defs><g><use style="stroke:#000000;stroke-width:0.6;" x="95.974432" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_11"><g id="line2d_11"><g><use style="stroke:#000000;stroke-width:0.6;" x="113.892614" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_12"><g id="line2d_12"><g><use style="stroke:#000000;stroke-width:0.6;" x="131.810795" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_13"><g id="line2d_13"><g><use style="stroke:#000000;stroke-width:0.6;" x="167.647159" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_14"><g id="line2d_14"><g><use style="stroke:#000000;stroke-width:0.6;" x="185.565341" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_15"><g id="line2d_15"><g><use style="stroke:#000000;stroke-width:0.6;" x="203.483523" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_16"><g id="line2d_16"><g><use style="stroke:#000000;stroke-width:0.6;" x="221.401705" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_17"><g id="line2d_17"><g><use style="stroke:#000000;stroke-width:0.6;" x="257.238068" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_18"><g id="line2d_18"><g><use style="stroke:#000000;stroke-width:0.6;" x="275.15625" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_19"><g id="line2d_19"><g><use style="stroke:#000000;stroke-width:0.6;" x="293.074432" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_20"><g id="line2d_20"><g><use style="stroke:#000000;stroke-width:0.6;" x="310.992614" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_21"><g id="line2d_21"><g><use style="stroke:#000000;stroke-width:0.6;" x="346.828977" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_22"><g id="line2d_22"><g><use style="stroke:#000000;stroke-width:0.6;" x="364.747159" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_23"><g id="line2d_23"><g><use style="stroke:#000000;stroke-width:0.6;" x="382.665341" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_24"><g id="line2d_24"><g><use style="stroke:#000000;stroke-width:0.6;" x="400.583523" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_25"><g id="line2d_25"><g><use style="stroke:#000000;stroke-width:0.6;" x="436.419886" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_26"><g id="line2d_26"><g><use style="stroke:#000000;stroke-width:0.6;" x="454.338068" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_27"><g id="line2d_27"><g><use style="stroke:#000000;stroke-width:0.6;" x="472.25625" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_28"><g id="line2d_28"><g><use style="stroke:#000000;stroke-width:0.6;" x="490.174432" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_29"><g id="line2d_29"><g><use style="stroke:#000000;stroke-width:0.6;" x="526.010795" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_30"><g id="line2d_30"><g><use style="stroke:#000000;stroke-width:0.6;" x="543.928977" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_31"><g id="line2d_31"><g><use style="stroke:#000000;stroke-width:0.6;" x="561.847159" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_32"><g id="line2d_32"><g><use style="stroke:#000000;stroke-width:0.6;" x="579.765341" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_33"><g id="line2d_33"><g><use style="stroke:#000000;stroke-width:0.6;" x="615.601705" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_34"><g id="line2d_34"><g><use style="stroke:#000000;stroke-width:0.6;" x="633.519886" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_35"><g id="line2d_35"><g><use style="stroke:#000000;stroke-width:0.6;" x="651.438068" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_36"><g id="line2d_36"><g><use style="stroke:#000000;stroke-width:0.6;" x="669.35625" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_37"><g id="line2d_37"><g><use style="stroke:#000000;stroke-width:0.6;" x="705.192614" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_38"><g id="line2d_38"><g><use style="stroke:#000000;stroke-width:0.6;" x="723.110795" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_39"><g id="line2d_39"><g><use style="stroke:#000000;stroke-width:0.6;" x="741.028977" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_40"><g id="line2d_40"><g><use style="stroke:#000000;stroke-width:0.6;" x="758.947159" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_41"><g id="line2d_41"><g><use style="stroke:#000000;stroke-width:0.6;" x="794.783523" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_42"><g id="line2d_42"><g><use style="stroke:#000000;stroke-width:0.6;" x="812.701705" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_43"><g id="line2d_43"><g><use style="stroke:#000000;stroke-width:0.6;" x="830.619886" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="xtick_44"><g id="line2d_44"><g><use style="stroke:#000000;stroke-width:0.6;" x="848.538068" xlink:href="#me0627562b2" y="507.807531"></use></g></g></g><g id="text_10"><!-- $\lambda$ (nm) --><g transform="translate(439.25625 543.682531)scale(0.2 -0.2)"><defs><path d="M 36.71875 67.4375 
L 48.828125 0 
L 39.3125 0 
L 31.84375 40.4375 
L 5.125 0 
L -4.390625 0 
L 29.734375 52.4375 
L 28.03125 62.109375 
Q 26.953125 68.265625 21.734375 68.265625 
L 17.046875 68.265625 
L 18.5 75.984375 
L 24.21875 75.875 
Q 35.203125 75.734375 36.71875 67.4375 
z
" id="DejaVuSans-Oblique-955"></path><path id="DejaVuSans-32"></path><path d="M 31 75.875 
Q 24.46875 64.65625 21.28125 53.65625 
Q 18.109375 42.671875 18.109375 31.390625 
Q 18.109375 20.125 21.3125 9.0625 
Q 24.515625 -2 31 -13.1875 
L 23.1875 -13.1875 
Q 15.875 -1.703125 12.234375 9.375 
Q 8.59375 20.453125 8.59375 31.390625 
Q 8.59375 42.28125 12.203125 53.3125 
Q 15.828125 64.359375 23.1875 75.875 
z
" id="DejaVuSans-40"></path><path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-110"></path><path d="M 52 44.1875 
Q 55.375 50.25 60.0625 53.125 
Q 64.75 56 71.09375 56 
Q 79.640625 56 84.28125 50.015625 
Q 88.921875 44.046875 88.921875 33.015625 
L 88.921875 0 
L 79.890625 0 
L 79.890625 32.71875 
Q 79.890625 40.578125 77.09375 44.375 
Q 74.3125 48.1875 68.609375 48.1875 
Q 61.625 48.1875 57.5625 43.546875 
Q 53.515625 38.921875 53.515625 30.90625 
L 53.515625 0 
L 44.484375 0 
L 44.484375 32.71875 
Q 44.484375 40.625 41.703125 44.40625 
Q 38.921875 48.1875 33.109375 48.1875 
Q 26.21875 48.1875 22.15625 43.53125 
Q 18.109375 38.875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.1875 51.21875 25.484375 53.609375 
Q 29.78125 56 35.6875 56 
Q 41.65625 56 45.828125 52.96875 
Q 50 49.953125 52 44.1875 
z
" id="DejaVuSans-109"></path><path d="M 8.015625 75.875 
L 15.828125 75.875 
Q 23.140625 64.359375 26.78125 53.3125 
Q 30.421875 42.28125 30.421875 31.390625 
Q 30.421875 20.453125 26.78125 9.375 
Q 23.140625 -1.703125 15.828125 -13.1875 
L 8.015625 -13.1875 
Q 14.5 -2 17.703125 9.0625 
Q 20.90625 20.125 20.90625 31.390625 
Q 20.90625 42.671875 17.703125 53.65625 
Q 14.5 64.65625 8.015625 75.875 
z
" id="DejaVuSans-41"></path></defs><use transform="translate(0 0.015625)" xlink:href="#DejaVuSans-Oblique-955"></use><use transform="translate(59.179688 0.015625)" xlink:href="#DejaVuSans-32"></use><use transform="translate(90.966797 0.015625)" xlink:href="#DejaVuSans-40"></use><use transform="translate(129.980469 0.015625)" xlink:href="#DejaVuSans-110"></use><use transform="translate(193.359375 0.015625)" xlink:href="#DejaVuSans-109"></use><use transform="translate(290.771484 0.015625)" xlink:href="#DejaVuSans-41"></use></g></g></g><g id="matplotlib.axis_2"><g id="ytick_1"><g id="line2d_45"><defs><path d="M 0 0 
L -3.5 0 
" id="mf605d95fb5" style="stroke:#000000;stroke-width:0.8;"></path></defs><g><use style="stroke:#000000;stroke-width:0.8;" x="78.05625" xlink:href="#mf605d95fb5" y="188.057921"></use></g></g><g id="text_11"><!-- $\mathdefault{10^{0}}$ --><g transform="translate(53.45625 191.857139)scale(0.1 -0.1)"><defs><path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path></defs><use transform="translate(0 0.765625)" xlink:href="#DejaVuSans-49"></use><use transform="translate(63.623047 0.765625)" xlink:href="#DejaVuSans-48"></use><use transform="translate(128.203125 39.046875)scale(0.7)" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_2"><g id="line2d_46"><defs><path d="M 0 0 
L -2 0 
" id="m189b9f2c0e" style="stroke:#000000;stroke-width:0.6;"></path></defs><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m189b9f2c0e" y="462.677449"></use></g></g><g id="text_12"><!-- $\mathdefault{3\times10^{-1}}$ --><g transform="translate(30.55625 466.476668)scale(0.1 -0.1)"><defs><path d="M 40.578125 39.3125 
Q 47.65625 37.796875 51.625 33 
Q 55.609375 28.21875 55.609375 21.1875 
Q 55.609375 10.40625 48.1875 4.484375 
Q 40.765625 -1.421875 27.09375 -1.421875 
Q 22.515625 -1.421875 17.65625 -0.515625 
Q 12.796875 0.390625 7.625 2.203125 
L 7.625 11.71875 
Q 11.71875 9.328125 16.59375 8.109375 
Q 21.484375 6.890625 26.8125 6.890625 
Q 36.078125 6.890625 40.9375 10.546875 
Q 45.796875 14.203125 45.796875 21.1875 
Q 45.796875 27.640625 41.28125 31.265625 
Q 36.765625 34.90625 28.71875 34.90625 
L 20.21875 34.90625 
L 20.21875 43.015625 
L 29.109375 43.015625 
Q 36.375 43.015625 40.234375 45.921875 
Q 44.09375 48.828125 44.09375 54.296875 
Q 44.09375 59.90625 40.109375 62.90625 
Q 36.140625 65.921875 28.71875 65.921875 
Q 24.65625 65.921875 20.015625 65.03125 
Q 15.375 64.15625 9.8125 62.3125 
L 9.8125 71.09375 
Q 15.4375 72.65625 20.34375 73.4375 
Q 25.25 74.21875 29.59375 74.21875 
Q 40.828125 74.21875 47.359375 69.109375 
Q 53.90625 64.015625 53.90625 55.328125 
Q 53.90625 49.265625 50.4375 45.09375 
Q 46.96875 40.921875 40.578125 39.3125 
z
" id="DejaVuSans-51"></path><path d="M 70.125 53.71875 
L 47.796875 31.296875 
L 70.125 8.984375 
L 64.3125 3.078125 
L 41.890625 25.484375 
L 19.484375 3.078125 
L 13.71875 8.984375 
L 35.984375 31.296875 
L 13.71875 53.71875 
L 19.484375 59.625 
L 41.890625 37.203125 
L 64.3125 59.625 
z
" id="DejaVuSans-215"></path><path d="M 10.59375 35.5 
L 73.1875 35.5 
L 73.1875 27.203125 
L 10.59375 27.203125 
z
" id="DejaVuSans-8722"></path></defs><use transform="translate(0 0.684375)" xlink:href="#DejaVuSans-51"></use><use transform="translate(83.105469 0.684375)" xlink:href="#DejaVuSans-215"></use><use transform="translate(186.376953 0.684375)" xlink:href="#DejaVuSans-49"></use><use transform="translate(250 0.684375)" xlink:href="#DejaVuSans-48"></use><use transform="translate(314.580078 38.965625)scale(0.7)" xlink:href="#DejaVuSans-8722"></use><use transform="translate(373.232422 38.965625)scale(0.7)" xlink:href="#DejaVuSans-49"></use></g></g></g><g id="ytick_3"><g id="line2d_47"><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m189b9f2c0e" y="397.058762"></use></g></g><g id="text_13"><!-- $\mathdefault{4\times10^{-1}}$ --><g transform="translate(30.55625 400.85798)scale(0.1 -0.1)"><use transform="translate(0 0.684375)" xlink:href="#DejaVuSans-52"></use><use transform="translate(83.105469 0.684375)" xlink:href="#DejaVuSans-215"></use><use transform="translate(186.376953 0.684375)" xlink:href="#DejaVuSans-49"></use><use transform="translate(250 0.684375)" xlink:href="#DejaVuSans-48"></use><use transform="translate(314.580078 38.965625)scale(0.7)" xlink:href="#DejaVuSans-8722"></use><use transform="translate(373.232422 38.965625)scale(0.7)" xlink:href="#DejaVuSans-49"></use></g></g></g><g id="ytick_4"><g id="line2d_48"><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m189b9f2c0e" y="346.160953"></use></g></g></g><g id="ytick_5"><g id="line2d_49"><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m189b9f2c0e" y="304.574416"></use></g></g><g id="text_14"><!-- $\mathdefault{6\times10^{-1}}$ --><g transform="translate(30.55625 308.373635)scale(0.1 -0.1)"><use transform="translate(0 0.684375)" xlink:href="#DejaVuSans-54"></use><use transform="translate(83.105469 0.684375)" xlink:href="#DejaVuSans-215"></use><use transform="translate(186.376953 0.684375)" xlink:href="#DejaVuSans-49"></use><use transform="translate(250 0.684375)" xlink:href="#DejaVuSans-48"></use><use transform="translate(314.580078 38.965625)scale(0.7)" xlink:href="#DejaVuSans-8722"></use><use transform="translate(373.232422 38.965625)scale(0.7)" xlink:href="#DejaVuSans-49"></use></g></g></g><g id="ytick_6"><g id="line2d_50"><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m189b9f2c0e" y="269.4135"></use></g></g></g><g id="ytick_7"><g id="line2d_51"><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m189b9f2c0e" y="238.955729"></use></g></g></g><g id="ytick_8"><g id="line2d_52"><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m189b9f2c0e" y="212.090071"></use></g></g></g><g id="ytick_9"><g id="line2d_53"><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m189b9f2c0e" y="29.954888"></use></g></g><g id="text_15"><!-- $\mathdefault{2\times10^{0}}$ --><g transform="translate(36.45625 33.754107)scale(0.1 -0.1)"><defs><path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path></defs><use transform="translate(0 0.765625)" xlink:href="#DejaVuSans-50"></use><use transform="translate(83.105469 0.765625)" xlink:href="#DejaVuSans-215"></use><use transform="translate(186.376953 0.765625)" xlink:href="#DejaVuSans-49"></use><use transform="translate(250 0.765625)" xlink:href="#DejaVuSans-48"></use><use transform="translate(314.580078 39.046875)scale(0.7)" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="text_16"><!-- relative spectral radiance of blue sky --><g transform="translate(22.396875 442.552203)rotate(-90)scale(0.2 -0.2)"><defs><path d="M 41.109375 46.296875 
Q 39.59375 47.171875 37.8125 47.578125 
Q 36.03125 48 33.890625 48 
Q 26.265625 48 22.1875 43.046875 
Q 18.109375 38.09375 18.109375 28.8125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 20.953125 51.171875 25.484375 53.578125 
Q 30.03125 56 36.53125 56 
Q 37.453125 56 38.578125 55.875 
Q 39.703125 55.765625 41.0625 55.515625 
z
" id="DejaVuSans-114"></path><path d="M 56.203125 29.59375 
L 56.203125 25.203125 
L 14.890625 25.203125 
Q 15.484375 15.921875 20.484375 11.0625 
Q 25.484375 6.203125 34.421875 6.203125 
Q 39.59375 6.203125 44.453125 7.46875 
Q 49.3125 8.734375 54.109375 11.28125 
L 54.109375 2.78125 
Q 49.265625 0.734375 44.1875 -0.34375 
Q 39.109375 -1.421875 33.890625 -1.421875 
Q 20.796875 -1.421875 13.15625 6.1875 
Q 5.515625 13.8125 5.515625 26.8125 
Q 5.515625 40.234375 12.765625 48.109375 
Q 20.015625 56 32.328125 56 
Q 43.359375 56 49.78125 48.890625 
Q 56.203125 41.796875 56.203125 29.59375 
z
M 47.21875 32.234375 
Q 47.125 39.59375 43.09375 43.984375 
Q 39.0625 48.390625 32.421875 48.390625 
Q 24.90625 48.390625 20.390625 44.140625 
Q 15.875 39.890625 15.1875 32.171875 
z
" id="DejaVuSans-101"></path><path d="M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 0 
L 9.421875 0 
z
" id="DejaVuSans-108"></path><path d="M 34.28125 27.484375 
Q 23.390625 27.484375 19.1875 25 
Q 14.984375 22.515625 14.984375 16.5 
Q 14.984375 11.71875 18.140625 8.90625 
Q 21.296875 6.109375 26.703125 6.109375 
Q 34.1875 6.109375 38.703125 11.40625 
Q 43.21875 16.703125 43.21875 25.484375 
L 43.21875 27.484375 
z
M 52.203125 31.203125 
L 52.203125 0 
L 43.21875 0 
L 43.21875 8.296875 
Q 40.140625 3.328125 35.546875 0.953125 
Q 30.953125 -1.421875 24.3125 -1.421875 
Q 15.921875 -1.421875 10.953125 3.296875 
Q 6 8.015625 6 15.921875 
Q 6 25.140625 12.171875 29.828125 
Q 18.359375 34.515625 30.609375 34.515625 
L 43.21875 34.515625 
L 43.21875 35.40625 
Q 43.21875 41.609375 39.140625 45 
Q 35.0625 48.390625 27.6875 48.390625 
Q 23 48.390625 18.546875 47.265625 
Q 14.109375 46.140625 10.015625 43.890625 
L 10.015625 52.203125 
Q 14.9375 54.109375 19.578125 55.046875 
Q 24.21875 56 28.609375 56 
Q 40.484375 56 46.34375 49.84375 
Q 52.203125 43.703125 52.203125 31.203125 
z
" id="DejaVuSans-97"></path><path d="M 18.3125 70.21875 
L 18.3125 54.6875 
L 36.8125 54.6875 
L 36.8125 47.703125 
L 18.3125 47.703125 
L 18.3125 18.015625 
Q 18.3125 11.328125 20.140625 9.421875 
Q 21.96875 7.515625 27.59375 7.515625 
L 36.8125 7.515625 
L 36.8125 0 
L 27.59375 0 
Q 17.1875 0 13.234375 3.875 
Q 9.28125 7.765625 9.28125 18.015625 
L 9.28125 47.703125 
L 2.6875 47.703125 
L 2.6875 54.6875 
L 9.28125 54.6875 
L 9.28125 70.21875 
z
" id="DejaVuSans-116"></path><path d="M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 0 
L 9.421875 0 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
" id="DejaVuSans-105"></path><path d="M 2.984375 54.6875 
L 12.5 54.6875 
L 29.59375 8.796875 
L 46.6875 54.6875 
L 56.203125 54.6875 
L 35.6875 0 
L 23.484375 0 
z
" id="DejaVuSans-118"></path><path d="M 44.28125 53.078125 
L 44.28125 44.578125 
Q 40.484375 46.53125 36.375 47.5 
Q 32.28125 48.484375 27.875 48.484375 
Q 21.1875 48.484375 17.84375 46.4375 
Q 14.5 44.390625 14.5 40.28125 
Q 14.5 37.15625 16.890625 35.375 
Q 19.28125 33.59375 26.515625 31.984375 
L 29.59375 31.296875 
Q 39.15625 29.25 43.1875 25.515625 
Q 47.21875 21.78125 47.21875 15.09375 
Q 47.21875 7.46875 41.1875 3.015625 
Q 35.15625 -1.421875 24.609375 -1.421875 
Q 20.21875 -1.421875 15.453125 -0.5625 
Q 10.6875 0.296875 5.421875 2 
L 5.421875 11.28125 
Q 10.40625 8.6875 15.234375 7.390625 
Q 20.0625 6.109375 24.8125 6.109375 
Q 31.15625 6.109375 34.5625 8.28125 
Q 37.984375 10.453125 37.984375 14.40625 
Q 37.984375 18.0625 35.515625 20.015625 
Q 33.0625 21.96875 24.703125 23.78125 
L 21.578125 24.515625 
Q 13.234375 26.265625 9.515625 29.90625 
Q 5.8125 33.546875 5.8125 39.890625 
Q 5.8125 47.609375 11.28125 51.796875 
Q 16.75 56 26.8125 56 
Q 31.78125 56 36.171875 55.265625 
Q 40.578125 54.546875 44.28125 53.078125 
z
" id="DejaVuSans-115"></path><path d="M 18.109375 8.203125 
L 18.109375 -20.796875 
L 9.078125 -20.796875 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.390625 
Q 20.953125 51.265625 25.265625 53.625 
Q 29.59375 56 35.59375 56 
Q 45.5625 56 51.78125 48.09375 
Q 58.015625 40.1875 58.015625 27.296875 
Q 58.015625 14.40625 51.78125 6.484375 
Q 45.5625 -1.421875 35.59375 -1.421875 
Q 29.59375 -1.421875 25.265625 0.953125 
Q 20.953125 3.328125 18.109375 8.203125 
z
M 48.6875 27.296875 
Q 48.6875 37.203125 44.609375 42.84375 
Q 40.53125 48.484375 33.40625 48.484375 
Q 26.265625 48.484375 22.1875 42.84375 
Q 18.109375 37.203125 18.109375 27.296875 
Q 18.109375 17.390625 22.1875 11.75 
Q 26.265625 6.109375 33.40625 6.109375 
Q 40.53125 6.109375 44.609375 11.75 
Q 48.6875 17.390625 48.6875 27.296875 
z
" id="DejaVuSans-112"></path><path d="M 48.78125 52.59375 
L 48.78125 44.1875 
Q 44.96875 46.296875 41.140625 47.34375 
Q 37.3125 48.390625 33.40625 48.390625 
Q 24.65625 48.390625 19.8125 42.84375 
Q 14.984375 37.3125 14.984375 27.296875 
Q 14.984375 17.28125 19.8125 11.734375 
Q 24.65625 6.203125 33.40625 6.203125 
Q 37.3125 6.203125 41.140625 7.25 
Q 44.96875 8.296875 48.78125 10.40625 
L 48.78125 2.09375 
Q 45.015625 0.34375 40.984375 -0.53125 
Q 36.96875 -1.421875 32.421875 -1.421875 
Q 20.0625 -1.421875 12.78125 6.34375 
Q 5.515625 14.109375 5.515625 27.296875 
Q 5.515625 40.671875 12.859375 48.328125 
Q 20.21875 56 33.015625 56 
Q 37.15625 56 41.109375 55.140625 
Q 45.0625 54.296875 48.78125 52.59375 
z
" id="DejaVuSans-99"></path><path d="M 45.40625 46.390625 
L 45.40625 75.984375 
L 54.390625 75.984375 
L 54.390625 0 
L 45.40625 0 
L 45.40625 8.203125 
Q 42.578125 3.328125 38.25 0.953125 
Q 33.9375 -1.421875 27.875 -1.421875 
Q 17.96875 -1.421875 11.734375 6.484375 
Q 5.515625 14.40625 5.515625 27.296875 
Q 5.515625 40.1875 11.734375 48.09375 
Q 17.96875 56 27.875 56 
Q 33.9375 56 38.25 53.625 
Q 42.578125 51.265625 45.40625 46.390625 
z
M 14.796875 27.296875 
Q 14.796875 17.390625 18.875 11.75 
Q 22.953125 6.109375 30.078125 6.109375 
Q 37.203125 6.109375 41.296875 11.75 
Q 45.40625 17.390625 45.40625 27.296875 
Q 45.40625 37.203125 41.296875 42.84375 
Q 37.203125 48.484375 30.078125 48.484375 
Q 22.953125 48.484375 18.875 42.84375 
Q 14.796875 37.203125 14.796875 27.296875 
z
" id="DejaVuSans-100"></path><path d="M 30.609375 48.390625 
Q 23.390625 48.390625 19.1875 42.75 
Q 14.984375 37.109375 14.984375 27.296875 
Q 14.984375 17.484375 19.15625 11.84375 
Q 23.34375 6.203125 30.609375 6.203125 
Q 37.796875 6.203125 41.984375 11.859375 
Q 46.1875 17.53125 46.1875 27.296875 
Q 46.1875 37.015625 41.984375 42.703125 
Q 37.796875 48.390625 30.609375 48.390625 
z
M 30.609375 56 
Q 42.328125 56 49.015625 48.375 
Q 55.71875 40.765625 55.71875 27.296875 
Q 55.71875 13.875 49.015625 6.21875 
Q 42.328125 -1.421875 30.609375 -1.421875 
Q 18.84375 -1.421875 12.171875 6.21875 
Q 5.515625 13.875 5.515625 27.296875 
Q 5.515625 40.765625 12.171875 48.375 
Q 18.84375 56 30.609375 56 
z
" id="DejaVuSans-111"></path><path d="M 37.109375 75.984375 
L 37.109375 68.5 
L 28.515625 68.5 
Q 23.6875 68.5 21.796875 66.546875 
Q 19.921875 64.59375 19.921875 59.515625 
L 19.921875 54.6875 
L 34.71875 54.6875 
L 34.71875 47.703125 
L 19.921875 47.703125 
L 19.921875 0 
L 10.890625 0 
L 10.890625 47.703125 
L 2.296875 47.703125 
L 2.296875 54.6875 
L 10.890625 54.6875 
L 10.890625 58.5 
Q 10.890625 67.625 15.140625 71.796875 
Q 19.390625 75.984375 28.609375 75.984375 
z
" id="DejaVuSans-102"></path><path d="M 48.6875 27.296875 
Q 48.6875 37.203125 44.609375 42.84375 
Q 40.53125 48.484375 33.40625 48.484375 
Q 26.265625 48.484375 22.1875 42.84375 
Q 18.109375 37.203125 18.109375 27.296875 
Q 18.109375 17.390625 22.1875 11.75 
Q 26.265625 6.109375 33.40625 6.109375 
Q 40.53125 6.109375 44.609375 11.75 
Q 48.6875 17.390625 48.6875 27.296875 
z
M 18.109375 46.390625 
Q 20.953125 51.265625 25.265625 53.625 
Q 29.59375 56 35.59375 56 
Q 45.5625 56 51.78125 48.09375 
Q 58.015625 40.1875 58.015625 27.296875 
Q 58.015625 14.40625 51.78125 6.484375 
Q 45.5625 -1.421875 35.59375 -1.421875 
Q 29.59375 -1.421875 25.265625 0.953125 
Q 20.953125 3.328125 18.109375 8.203125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 75.984375 
L 18.109375 75.984375 
z
" id="DejaVuSans-98"></path><path d="M 8.5 21.578125 
L 8.5 54.6875 
L 17.484375 54.6875 
L 17.484375 21.921875 
Q 17.484375 14.15625 20.5 10.265625 
Q 23.53125 6.390625 29.59375 6.390625 
Q 36.859375 6.390625 41.078125 11.03125 
Q 45.3125 15.671875 45.3125 23.6875 
L 45.3125 54.6875 
L 54.296875 54.6875 
L 54.296875 0 
L 45.3125 0 
L 45.3125 8.40625 
Q 42.046875 3.421875 37.71875 1 
Q 33.40625 -1.421875 27.6875 -1.421875 
Q 18.265625 -1.421875 13.375 4.4375 
Q 8.5 10.296875 8.5 21.578125 
z
M 31.109375 56 
z
" id="DejaVuSans-117"></path><path d="M 9.078125 75.984375 
L 18.109375 75.984375 
L 18.109375 31.109375 
L 44.921875 54.6875 
L 56.390625 54.6875 
L 27.390625 29.109375 
L 57.625 0 
L 45.90625 0 
L 18.109375 26.703125 
L 18.109375 0 
L 9.078125 0 
z
" id="DejaVuSans-107"></path><path d="M 32.171875 -5.078125 
Q 28.375 -14.84375 24.75 -17.8125 
Q 21.140625 -20.796875 15.09375 -20.796875 
L 7.90625 -20.796875 
L 7.90625 -13.28125 
L 13.1875 -13.28125 
Q 16.890625 -13.28125 18.9375 -11.515625 
Q 21 -9.765625 23.484375 -3.21875 
L 25.09375 0.875 
L 2.984375 54.6875 
L 12.5 54.6875 
L 29.59375 11.921875 
L 46.6875 54.6875 
L 56.203125 54.6875 
z
" id="DejaVuSans-121"></path></defs><use xlink:href="#DejaVuSans-114"></use><use x="38.863281" xlink:href="#DejaVuSans-101"></use><use x="100.386719" xlink:href="#DejaVuSans-108"></use><use x="128.169922" xlink:href="#DejaVuSans-97"></use><use x="189.449219" xlink:href="#DejaVuSans-116"></use><use x="228.658203" xlink:href="#DejaVuSans-105"></use><use x="256.441406" xlink:href="#DejaVuSans-118"></use><use x="315.621094" xlink:href="#DejaVuSans-101"></use><use x="377.144531" xlink:href="#DejaVuSans-32"></use><use x="408.931641" xlink:href="#DejaVuSans-115"></use><use x="461.03125" xlink:href="#DejaVuSans-112"></use><use x="524.507812" xlink:href="#DejaVuSans-101"></use><use x="586.03125" xlink:href="#DejaVuSans-99"></use><use x="641.011719" xlink:href="#DejaVuSans-116"></use><use x="680.220703" xlink:href="#DejaVuSans-114"></use><use x="721.333984" xlink:href="#DejaVuSans-97"></use><use x="782.613281" xlink:href="#DejaVuSans-108"></use><use x="810.396484" xlink:href="#DejaVuSans-32"></use><use x="842.183594" xlink:href="#DejaVuSans-114"></use><use x="883.296875" xlink:href="#DejaVuSans-97"></use><use x="944.576172" xlink:href="#DejaVuSans-100"></use><use x="1008.052734" xlink:href="#DejaVuSans-105"></use><use x="1035.835938" xlink:href="#DejaVuSans-97"></use><use x="1097.115234" xlink:href="#DejaVuSans-110"></use><use x="1160.494141" xlink:href="#DejaVuSans-99"></use><use x="1215.474609" xlink:href="#DejaVuSans-101"></use><use x="1276.998047" xlink:href="#DejaVuSans-32"></use><use x="1308.785156" xlink:href="#DejaVuSans-111"></use><use x="1369.966797" xlink:href="#DejaVuSans-102"></use><use x="1405.171875" xlink:href="#DejaVuSans-32"></use><use x="1436.958984" xlink:href="#DejaVuSans-98"></use><use x="1500.435547" xlink:href="#DejaVuSans-108"></use><use x="1528.21875" xlink:href="#DejaVuSans-117"></use><use x="1591.597656" xlink:href="#DejaVuSans-101"></use><use x="1653.121094" xlink:href="#DejaVuSans-32"></use><use x="1684.908203" xlink:href="#DejaVuSans-115"></use><use x="1737.007812" xlink:href="#DejaVuSans-107"></use><use x="1791.292969" xlink:href="#DejaVuSans-121"></use></g></g></g><g id="LineCollection_1"><path clip-path="url(#pb6827b721a)" d="M 230.360795 556.041906 
L 230.360795 29.954888 
" style="fill:none;stroke:#0000ff;stroke-dasharray:18.5,8;stroke-dashoffset:0;stroke-opacity:0.3;stroke-width:5;"></path></g><g id="LineCollection_2"><path clip-path="url(#pb6827b721a)" d="M 427.460795 556.041906 
L 427.460795 29.954888 
" style="fill:none;stroke:#008000;stroke-dasharray:18.5,8;stroke-dashoffset:0;stroke-opacity:0.3;stroke-width:5;"></path></g><g id="LineCollection_3"><path clip-path="url(#pb6827b721a)" d="M 508.092614 556.041906 
L 508.092614 29.954888 
" style="fill:none;stroke:#ff0000;stroke-dasharray:18.5,8;stroke-dashoffset:0;stroke-opacity:0.3;stroke-width:5;"></path></g><g id="line2d_54"><path clip-path="url(#pb6827b721a)" d="M 113.892614 47.8167 
L 121.095903 47.221504 
L 128.299192 46.916329 
L 135.502481 46.887498 
L 142.70577 47.122069 
L 149.90906 47.607781 
L 157.112349 48.333018 
L 164.315638 49.286763 
L 171.518927 50.458567 
L 178.722216 51.838511 
L 185.925505 53.417174 
L 193.128795 55.185606 
L 200.332084 57.135298 
L 207.535373 59.258156 
L 214.738662 61.546481 
L 225.543596 65.273278 
L 236.34853 69.332673 
L 247.153463 73.702998 
L 257.958397 78.364076 
L 268.763331 83.297102 
L 279.568265 88.484533 
L 290.373198 93.909991 
L 301.178132 99.558171 
L 311.983066 105.414764 
L 326.389644 113.524729 
L 340.796223 121.952076 
L 355.202801 130.669819 
L 369.609379 139.653175 
L 384.015958 148.879359 
L 402.024181 160.72178 
L 420.032403 172.873608 
L 438.040626 185.301068 
L 456.048849 197.973591 
L 477.658717 213.465279 
L 499.268584 229.22706 
L 524.480097 247.906229 
L 553.293253 269.571458 
L 585.708054 294.266925 
L 621.7245 322.007252 
L 664.944235 355.581271 
L 733.375483 409.064044 
L 830.619886 485.052643 
L 830.619886 485.052643 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-width:1.5;"></path></g><g id="patch_3"><path d="M 78.05625 507.807531 
L 78.05625 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_4"><path d="M 866.45625 507.807531 
L 866.45625 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_5"><path d="M 78.05625 507.807531 
L 866.45625 507.807531 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_6"><path d="M 78.05625 7.2 
L 866.45625 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g></g></g><defs><clippath id="pb6827b721a"><rect height="500.607531" width="788.4" x="78.05625" y="7.2"></rect></clippath></defs></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Converting-a-spectrum-to-a-colour">Converting a spectrum to a colour<a class="anchor-link" href="2020-07-04-colors-of-the-sky.html#Converting-a-spectrum-to-a-colour">¶</a>
</h3>
<p>Knowing this spectrum, how do we convert that into a color on the screen?</p>
<p>Colors are represented on computer screens by (R, G, B) values and I will follow this <a href="https://scipython.com/blog/converting-a-spectrum-to-a-colour/">blog post</a>. Let's first load the file describe the relative sensitivity of cones to the light spectrum which gives the CIE colour matching function for 380 - 780 nm in 5 nm intervals:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">CMF_str</span> <span class="o">=</span> <span class="s2">"""380 0.0014 0.0000 0.0065</span>
<span class="s2">385 0.0022 0.0001 0.0105</span>
<span class="s2">390 0.0042 0.0001 0.0201</span>
<span class="s2">395 0.0076 0.0002 0.0362</span>
<span class="s2">400 0.0143 0.0004 0.0679</span>
<span class="s2">405 0.0232 0.0006 0.1102</span>
<span class="s2">410 0.0435 0.0012 0.2074</span>
<span class="s2">415 0.0776 0.0022 0.3713</span>
<span class="s2">420 0.1344 0.0040 0.6456</span>
<span class="s2">425 0.2148 0.0073 1.0391</span>
<span class="s2">430 0.2839 0.0116 1.3856</span>
<span class="s2">435 0.3285 0.0168 1.6230</span>
<span class="s2">440 0.3483 0.0230 1.7471</span>
<span class="s2">445 0.3481 0.0298 1.7826</span>
<span class="s2">450 0.3362 0.0380 1.7721</span>
<span class="s2">455 0.3187 0.0480 1.7441</span>
<span class="s2">460 0.2908 0.0600 1.6692</span>
<span class="s2">465 0.2511 0.0739 1.5281</span>
<span class="s2">470 0.1954 0.0910 1.2876</span>
<span class="s2">475 0.1421 0.1126 1.0419</span>
<span class="s2">480 0.0956 0.1390 0.8130</span>
<span class="s2">485 0.0580 0.1693 0.6162</span>
<span class="s2">490 0.0320 0.2080 0.4652</span>
<span class="s2">495 0.0147 0.2586 0.3533</span>
<span class="s2">500 0.0049 0.3230 0.2720</span>
<span class="s2">505 0.0024 0.4073 0.2123</span>
<span class="s2">510 0.0093 0.5030 0.1582</span>
<span class="s2">515 0.0291 0.6082 0.1117</span>
<span class="s2">520 0.0633 0.7100 0.0782</span>
<span class="s2">525 0.1096 0.7932 0.0573</span>
<span class="s2">530 0.1655 0.8620 0.0422</span>
<span class="s2">535 0.2257 0.9149 0.0298</span>
<span class="s2">540 0.2904 0.9540 0.0203</span>
<span class="s2">545 0.3597 0.9803 0.0134</span>
<span class="s2">550 0.4334 0.9950 0.0087</span>
<span class="s2">555 0.5121 1.0000 0.0057</span>
<span class="s2">560 0.5945 0.9950 0.0039</span>
<span class="s2">565 0.6784 0.9786 0.0027</span>
<span class="s2">570 0.7621 0.9520 0.0021</span>
<span class="s2">575 0.8425 0.9154 0.0018</span>
<span class="s2">580 0.9163 0.8700 0.0017</span>
<span class="s2">585 0.9786 0.8163 0.0014</span>
<span class="s2">590 1.0263 0.7570 0.0011</span>
<span class="s2">595 1.0567 0.6949 0.0010</span>
<span class="s2">600 1.0622 0.6310 0.0008</span>
<span class="s2">605 1.0456 0.5668 0.0006</span>
<span class="s2">610 1.0026 0.5030 0.0003</span>
<span class="s2">615 0.9384 0.4412 0.0002</span>
<span class="s2">620 0.8544 0.3810 0.0002</span>
<span class="s2">625 0.7514 0.3210 0.0001</span>
<span class="s2">630 0.6424 0.2650 0.0000</span>
<span class="s2">635 0.5419 0.2170 0.0000</span>
<span class="s2">640 0.4479 0.1750 0.0000</span>
<span class="s2">645 0.3608 0.1382 0.0000</span>
<span class="s2">650 0.2835 0.1070 0.0000</span>
<span class="s2">655 0.2187 0.0816 0.0000</span>
<span class="s2">660 0.1649 0.0610 0.0000</span>
<span class="s2">665 0.1212 0.0446 0.0000</span>
<span class="s2">670 0.0874 0.0320 0.0000</span>
<span class="s2">675 0.0636 0.0232 0.0000</span>
<span class="s2">680 0.0468 0.0170 0.0000</span>
<span class="s2">685 0.0329 0.0119 0.0000</span>
<span class="s2">690 0.0227 0.0082 0.0000</span>
<span class="s2">695 0.0158 0.0057 0.0000</span>
<span class="s2">700 0.0114 0.0041 0.0000</span>
<span class="s2">705 0.0081 0.0029 0.0000</span>
<span class="s2">710 0.0058 0.0021 0.0000</span>
<span class="s2">715 0.0041 0.0015 0.0000</span>
<span class="s2">720 0.0029 0.0010 0.0000</span>
<span class="s2">725 0.0020 0.0007 0.0000</span>
<span class="s2">730 0.0014 0.0005 0.0000</span>
<span class="s2">735 0.0010 0.0004 0.0000</span>
<span class="s2">740 0.0007 0.0002 0.0000</span>
<span class="s2">745 0.0005 0.0002 0.0000</span>
<span class="s2">750 0.0003 0.0001 0.0000</span>
<span class="s2">755 0.0002 0.0001 0.0000</span>
<span class="s2">760 0.0002 0.0001 0.0000</span>
<span class="s2">765 0.0001 0.0000 0.0000</span>
<span class="s2">770 0.0001 0.0000 0.0000</span>
<span class="s2">775 0.0001 0.0000 0.0000</span>
<span class="s2">780 0.0000 0.0000 0.0000"""</span>
<span class="n">CMF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">CMF_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)),</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">CMF_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)):</span> 
    <span class="n">CMF</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">' '</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is plotted as the different sensitivities to a novel color space called the <a href="https://en.wikipedia.org/wiki/CIE_1931_color_space">CIE 193 " XYZ" color space</a> :</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
<span class="n">wavelengths</span> <span class="o">=</span> <span class="n">CMF</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-9</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="o">**</span><span class="n">adjustprops</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i_color</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">'r'</span><span class="p">,</span> <span class="s1">'g'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelengths</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="n">CMF</span><span class="p">[:,</span> <span class="n">i_color</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">445</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">555</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">'g'</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">'r'</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$\lambda$ (nm)'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'relative sensitivity'</span><span class="p">)</span>
<span class="c1">#ax.set_ylim(0)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">'log'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?><!-- Created with matplotlib (https://matplotlib.org/) --><svg height="555.041906pt" version="1.1" viewbox="0 0 866.2 555.041906" width="866.2pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><metadata><rdf xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><work><type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></type><date>2020-07-28T21:35:01.587350</date><format>image/svg+xml</format><creator><agent><title>Matplotlib v3.3.0, https://matplotlib.org/</title></agent></creator></work></rdf></metadata><defs><style type="text/css">*{stroke-linecap:butt;stroke-linejoin:round;}</style></defs><g id="figure_1"><g id="patch_1"><path d="M 0 555.041906 
L 866.2 555.041906 
L 866.2 0 
L 0 0 
z
" style="fill:none;"></path></g><g id="axes_1"><g id="patch_2"><path d="M 61.05625 507.807531 
L 849.45625 507.807531 
L 849.45625 7.2 
L 61.05625 7.2 
z
" style="fill:#ffffff;"></path></g><g id="matplotlib.axis_1"><g id="xtick_1"><g id="line2d_1"><defs><path d="M 0 0 
L 0 3.5 
" id="m9da16bd114" style="stroke:#000000;stroke-width:0.8;"></path></defs><g><use style="stroke:#000000;stroke-width:0.8;" x="132.728977" xlink:href="#m9da16bd114" y="507.807531"></use></g></g><g id="text_1"><!-- 400 --><g transform="translate(123.185227 522.405968)scale(0.1 -0.1)"><defs><path d="M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
" id="DejaVuSans-52"></path><path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path></defs><use xlink:href="#DejaVuSans-52"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_2"><g id="line2d_2"><g><use style="stroke:#000000;stroke-width:0.8;" x="222.319886" xlink:href="#m9da16bd114" y="507.807531"></use></g></g><g id="text_2"><!-- 450 --><g transform="translate(212.776136 522.405968)scale(0.1 -0.1)"><defs><path d="M 10.796875 72.90625 
L 49.515625 72.90625 
L 49.515625 64.59375 
L 19.828125 64.59375 
L 19.828125 46.734375 
Q 21.96875 47.46875 24.109375 47.828125 
Q 26.265625 48.1875 28.421875 48.1875 
Q 40.625 48.1875 47.75 41.5 
Q 54.890625 34.8125 54.890625 23.390625 
Q 54.890625 11.625 47.5625 5.09375 
Q 40.234375 -1.421875 26.90625 -1.421875 
Q 22.3125 -1.421875 17.546875 -0.640625 
Q 12.796875 0.140625 7.71875 1.703125 
L 7.71875 11.625 
Q 12.109375 9.234375 16.796875 8.0625 
Q 21.484375 6.890625 26.703125 6.890625 
Q 35.15625 6.890625 40.078125 11.328125 
Q 45.015625 15.765625 45.015625 23.390625 
Q 45.015625 31 40.078125 35.4375 
Q 35.15625 39.890625 26.703125 39.890625 
Q 22.75 39.890625 18.8125 39.015625 
Q 14.890625 38.140625 10.796875 36.28125 
z
" id="DejaVuSans-53"></path></defs><use xlink:href="#DejaVuSans-52"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_3"><g id="line2d_3"><g><use style="stroke:#000000;stroke-width:0.8;" x="311.910795" xlink:href="#m9da16bd114" y="507.807531"></use></g></g><g id="text_3"><!-- 500 --><g transform="translate(302.367045 522.405968)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-53"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_4"><g id="line2d_4"><g><use style="stroke:#000000;stroke-width:0.8;" x="401.501705" xlink:href="#m9da16bd114" y="507.807531"></use></g></g><g id="text_4"><!-- 550 --><g transform="translate(391.957955 522.405968)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-53"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_5"><g id="line2d_5"><g><use style="stroke:#000000;stroke-width:0.8;" x="491.092614" xlink:href="#m9da16bd114" y="507.807531"></use></g></g><g id="text_5"><!-- 600 --><g transform="translate(481.548864 522.405968)scale(0.1 -0.1)"><defs><path d="M 33.015625 40.375 
Q 26.375 40.375 22.484375 35.828125 
Q 18.609375 31.296875 18.609375 23.390625 
Q 18.609375 15.53125 22.484375 10.953125 
Q 26.375 6.390625 33.015625 6.390625 
Q 39.65625 6.390625 43.53125 10.953125 
Q 47.40625 15.53125 47.40625 23.390625 
Q 47.40625 31.296875 43.53125 35.828125 
Q 39.65625 40.375 33.015625 40.375 
z
M 52.59375 71.296875 
L 52.59375 62.3125 
Q 48.875 64.0625 45.09375 64.984375 
Q 41.3125 65.921875 37.59375 65.921875 
Q 27.828125 65.921875 22.671875 59.328125 
Q 17.53125 52.734375 16.796875 39.40625 
Q 19.671875 43.65625 24.015625 45.921875 
Q 28.375 48.1875 33.59375 48.1875 
Q 44.578125 48.1875 50.953125 41.515625 
Q 57.328125 34.859375 57.328125 23.390625 
Q 57.328125 12.15625 50.6875 5.359375 
Q 44.046875 -1.421875 33.015625 -1.421875 
Q 20.359375 -1.421875 13.671875 8.265625 
Q 6.984375 17.96875 6.984375 36.375 
Q 6.984375 53.65625 15.1875 63.9375 
Q 23.390625 74.21875 37.203125 74.21875 
Q 40.921875 74.21875 44.703125 73.484375 
Q 48.484375 72.75 52.59375 71.296875 
z
" id="DejaVuSans-54"></path></defs><use xlink:href="#DejaVuSans-54"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_6"><g id="line2d_6"><g><use style="stroke:#000000;stroke-width:0.8;" x="580.683523" xlink:href="#m9da16bd114" y="507.807531"></use></g></g><g id="text_6"><!-- 650 --><g transform="translate(571.139773 522.405968)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-54"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_7"><g id="line2d_7"><g><use style="stroke:#000000;stroke-width:0.8;" x="670.274432" xlink:href="#m9da16bd114" y="507.807531"></use></g></g><g id="text_7"><!-- 700 --><g transform="translate(660.730682 522.405968)scale(0.1 -0.1)"><defs><path d="M 8.203125 72.90625 
L 55.078125 72.90625 
L 55.078125 68.703125 
L 28.609375 0 
L 18.3125 0 
L 43.21875 64.59375 
L 8.203125 64.59375 
z
" id="DejaVuSans-55"></path></defs><use xlink:href="#DejaVuSans-55"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_8"><g id="line2d_8"><g><use style="stroke:#000000;stroke-width:0.8;" x="759.865341" xlink:href="#m9da16bd114" y="507.807531"></use></g></g><g id="text_8"><!-- 750 --><g transform="translate(750.321591 522.405968)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-55"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_9"><g id="line2d_9"><g><use style="stroke:#000000;stroke-width:0.8;" x="849.45625" xlink:href="#m9da16bd114" y="507.807531"></use></g></g><g id="text_9"><!-- 800 --><g transform="translate(839.9125 522.405968)scale(0.1 -0.1)"><defs><path d="M 31.78125 34.625 
Q 24.75 34.625 20.71875 30.859375 
Q 16.703125 27.09375 16.703125 20.515625 
Q 16.703125 13.921875 20.71875 10.15625 
Q 24.75 6.390625 31.78125 6.390625 
Q 38.8125 6.390625 42.859375 10.171875 
Q 46.921875 13.96875 46.921875 20.515625 
Q 46.921875 27.09375 42.890625 30.859375 
Q 38.875 34.625 31.78125 34.625 
z
M 21.921875 38.8125 
Q 15.578125 40.375 12.03125 44.71875 
Q 8.5 49.078125 8.5 55.328125 
Q 8.5 64.0625 14.71875 69.140625 
Q 20.953125 74.21875 31.78125 74.21875 
Q 42.671875 74.21875 48.875 69.140625 
Q 55.078125 64.0625 55.078125 55.328125 
Q 55.078125 49.078125 51.53125 44.71875 
Q 48 40.375 41.703125 38.8125 
Q 48.828125 37.15625 52.796875 32.3125 
Q 56.78125 27.484375 56.78125 20.515625 
Q 56.78125 9.90625 50.3125 4.234375 
Q 43.84375 -1.421875 31.78125 -1.421875 
Q 19.734375 -1.421875 13.25 4.234375 
Q 6.78125 9.90625 6.78125 20.515625 
Q 6.78125 27.484375 10.78125 32.3125 
Q 14.796875 37.15625 21.921875 38.8125 
z
M 18.3125 54.390625 
Q 18.3125 48.734375 21.84375 45.5625 
Q 25.390625 42.390625 31.78125 42.390625 
Q 38.140625 42.390625 41.71875 45.5625 
Q 45.3125 48.734375 45.3125 54.390625 
Q 45.3125 60.0625 41.71875 63.234375 
Q 38.140625 66.40625 31.78125 66.40625 
Q 25.390625 66.40625 21.84375 63.234375 
Q 18.3125 60.0625 18.3125 54.390625 
z
" id="DejaVuSans-56"></path></defs><use xlink:href="#DejaVuSans-56"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_10"><g id="line2d_10"><defs><path d="M 0 0 
L 0 2 
" id="m4f82e8cdde" style="stroke:#000000;stroke-width:0.6;"></path></defs><g><use style="stroke:#000000;stroke-width:0.6;" x="78.974432" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_11"><g id="line2d_11"><g><use style="stroke:#000000;stroke-width:0.6;" x="96.892614" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_12"><g id="line2d_12"><g><use style="stroke:#000000;stroke-width:0.6;" x="114.810795" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_13"><g id="line2d_13"><g><use style="stroke:#000000;stroke-width:0.6;" x="150.647159" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_14"><g id="line2d_14"><g><use style="stroke:#000000;stroke-width:0.6;" x="168.565341" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_15"><g id="line2d_15"><g><use style="stroke:#000000;stroke-width:0.6;" x="186.483523" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_16"><g id="line2d_16"><g><use style="stroke:#000000;stroke-width:0.6;" x="204.401705" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_17"><g id="line2d_17"><g><use style="stroke:#000000;stroke-width:0.6;" x="240.238068" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_18"><g id="line2d_18"><g><use style="stroke:#000000;stroke-width:0.6;" x="258.15625" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_19"><g id="line2d_19"><g><use style="stroke:#000000;stroke-width:0.6;" x="276.074432" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_20"><g id="line2d_20"><g><use style="stroke:#000000;stroke-width:0.6;" x="293.992614" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_21"><g id="line2d_21"><g><use style="stroke:#000000;stroke-width:0.6;" x="329.828977" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_22"><g id="line2d_22"><g><use style="stroke:#000000;stroke-width:0.6;" x="347.747159" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_23"><g id="line2d_23"><g><use style="stroke:#000000;stroke-width:0.6;" x="365.665341" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_24"><g id="line2d_24"><g><use style="stroke:#000000;stroke-width:0.6;" x="383.583523" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_25"><g id="line2d_25"><g><use style="stroke:#000000;stroke-width:0.6;" x="419.419886" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_26"><g id="line2d_26"><g><use style="stroke:#000000;stroke-width:0.6;" x="437.338068" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_27"><g id="line2d_27"><g><use style="stroke:#000000;stroke-width:0.6;" x="455.25625" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_28"><g id="line2d_28"><g><use style="stroke:#000000;stroke-width:0.6;" x="473.174432" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_29"><g id="line2d_29"><g><use style="stroke:#000000;stroke-width:0.6;" x="509.010795" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_30"><g id="line2d_30"><g><use style="stroke:#000000;stroke-width:0.6;" x="526.928977" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_31"><g id="line2d_31"><g><use style="stroke:#000000;stroke-width:0.6;" x="544.847159" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_32"><g id="line2d_32"><g><use style="stroke:#000000;stroke-width:0.6;" x="562.765341" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_33"><g id="line2d_33"><g><use style="stroke:#000000;stroke-width:0.6;" x="598.601705" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_34"><g id="line2d_34"><g><use style="stroke:#000000;stroke-width:0.6;" x="616.519886" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_35"><g id="line2d_35"><g><use style="stroke:#000000;stroke-width:0.6;" x="634.438068" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_36"><g id="line2d_36"><g><use style="stroke:#000000;stroke-width:0.6;" x="652.35625" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_37"><g id="line2d_37"><g><use style="stroke:#000000;stroke-width:0.6;" x="688.192614" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_38"><g id="line2d_38"><g><use style="stroke:#000000;stroke-width:0.6;" x="706.110795" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_39"><g id="line2d_39"><g><use style="stroke:#000000;stroke-width:0.6;" x="724.028977" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_40"><g id="line2d_40"><g><use style="stroke:#000000;stroke-width:0.6;" x="741.947159" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_41"><g id="line2d_41"><g><use style="stroke:#000000;stroke-width:0.6;" x="777.783523" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_42"><g id="line2d_42"><g><use style="stroke:#000000;stroke-width:0.6;" x="795.701705" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_43"><g id="line2d_43"><g><use style="stroke:#000000;stroke-width:0.6;" x="813.619886" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="xtick_44"><g id="line2d_44"><g><use style="stroke:#000000;stroke-width:0.6;" x="831.538068" xlink:href="#m4f82e8cdde" y="507.807531"></use></g></g></g><g id="text_10"><!-- $\lambda$ (nm) --><g transform="translate(422.25625 543.682531)scale(0.2 -0.2)"><defs><path d="M 36.71875 67.4375 
L 48.828125 0 
L 39.3125 0 
L 31.84375 40.4375 
L 5.125 0 
L -4.390625 0 
L 29.734375 52.4375 
L 28.03125 62.109375 
Q 26.953125 68.265625 21.734375 68.265625 
L 17.046875 68.265625 
L 18.5 75.984375 
L 24.21875 75.875 
Q 35.203125 75.734375 36.71875 67.4375 
z
" id="DejaVuSans-Oblique-955"></path><path id="DejaVuSans-32"></path><path d="M 31 75.875 
Q 24.46875 64.65625 21.28125 53.65625 
Q 18.109375 42.671875 18.109375 31.390625 
Q 18.109375 20.125 21.3125 9.0625 
Q 24.515625 -2 31 -13.1875 
L 23.1875 -13.1875 
Q 15.875 -1.703125 12.234375 9.375 
Q 8.59375 20.453125 8.59375 31.390625 
Q 8.59375 42.28125 12.203125 53.3125 
Q 15.828125 64.359375 23.1875 75.875 
z
" id="DejaVuSans-40"></path><path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-110"></path><path d="M 52 44.1875 
Q 55.375 50.25 60.0625 53.125 
Q 64.75 56 71.09375 56 
Q 79.640625 56 84.28125 50.015625 
Q 88.921875 44.046875 88.921875 33.015625 
L 88.921875 0 
L 79.890625 0 
L 79.890625 32.71875 
Q 79.890625 40.578125 77.09375 44.375 
Q 74.3125 48.1875 68.609375 48.1875 
Q 61.625 48.1875 57.5625 43.546875 
Q 53.515625 38.921875 53.515625 30.90625 
L 53.515625 0 
L 44.484375 0 
L 44.484375 32.71875 
Q 44.484375 40.625 41.703125 44.40625 
Q 38.921875 48.1875 33.109375 48.1875 
Q 26.21875 48.1875 22.15625 43.53125 
Q 18.109375 38.875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.1875 51.21875 25.484375 53.609375 
Q 29.78125 56 35.6875 56 
Q 41.65625 56 45.828125 52.96875 
Q 50 49.953125 52 44.1875 
z
" id="DejaVuSans-109"></path><path d="M 8.015625 75.875 
L 15.828125 75.875 
Q 23.140625 64.359375 26.78125 53.3125 
Q 30.421875 42.28125 30.421875 31.390625 
Q 30.421875 20.453125 26.78125 9.375 
Q 23.140625 -1.703125 15.828125 -13.1875 
L 8.015625 -13.1875 
Q 14.5 -2 17.703125 9.0625 
Q 20.90625 20.125 20.90625 31.390625 
Q 20.90625 42.671875 17.703125 53.65625 
Q 14.5 64.65625 8.015625 75.875 
z
" id="DejaVuSans-41"></path></defs><use transform="translate(0 0.015625)" xlink:href="#DejaVuSans-Oblique-955"></use><use transform="translate(59.179688 0.015625)" xlink:href="#DejaVuSans-32"></use><use transform="translate(90.966797 0.015625)" xlink:href="#DejaVuSans-40"></use><use transform="translate(129.980469 0.015625)" xlink:href="#DejaVuSans-110"></use><use transform="translate(193.359375 0.015625)" xlink:href="#DejaVuSans-109"></use><use transform="translate(290.771484 0.015625)" xlink:href="#DejaVuSans-41"></use></g></g></g><g id="matplotlib.axis_2"><g id="ytick_1"><g id="line2d_45"><defs><path d="M 0 0 
L -3.5 0 
" id="m7b70621c74" style="stroke:#000000;stroke-width:0.8;"></path></defs><g><use style="stroke:#000000;stroke-width:0.8;" x="61.05625" xlink:href="#m7b70621c74" y="485.052643"></use></g></g><g id="text_11"><!-- $\mathdefault{10^{-4}}$ --><g transform="translate(30.55625 488.851862)scale(0.1 -0.1)"><defs><path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path><path d="M 10.59375 35.5 
L 73.1875 35.5 
L 73.1875 27.203125 
L 10.59375 27.203125 
z
" id="DejaVuSans-8722"></path></defs><use transform="translate(0 0.684375)" xlink:href="#DejaVuSans-49"></use><use transform="translate(63.623047 0.684375)" xlink:href="#DejaVuSans-48"></use><use transform="translate(128.203125 38.965625)scale(0.7)" xlink:href="#DejaVuSans-8722"></use><use transform="translate(186.855469 38.965625)scale(0.7)" xlink:href="#DejaVuSans-52"></use></g></g></g><g id="ytick_2"><g id="line2d_46"><g><use style="stroke:#000000;stroke-width:0.8;" x="61.05625" xlink:href="#m7b70621c74" y="379.241301"></use></g></g><g id="text_12"><!-- $\mathdefault{10^{-3}}$ --><g transform="translate(30.55625 383.04052)scale(0.1 -0.1)"><defs><path d="M 40.578125 39.3125 
Q 47.65625 37.796875 51.625 33 
Q 55.609375 28.21875 55.609375 21.1875 
Q 55.609375 10.40625 48.1875 4.484375 
Q 40.765625 -1.421875 27.09375 -1.421875 
Q 22.515625 -1.421875 17.65625 -0.515625 
Q 12.796875 0.390625 7.625 2.203125 
L 7.625 11.71875 
Q 11.71875 9.328125 16.59375 8.109375 
Q 21.484375 6.890625 26.8125 6.890625 
Q 36.078125 6.890625 40.9375 10.546875 
Q 45.796875 14.203125 45.796875 21.1875 
Q 45.796875 27.640625 41.28125 31.265625 
Q 36.765625 34.90625 28.71875 34.90625 
L 20.21875 34.90625 
L 20.21875 43.015625 
L 29.109375 43.015625 
Q 36.375 43.015625 40.234375 45.921875 
Q 44.09375 48.828125 44.09375 54.296875 
Q 44.09375 59.90625 40.109375 62.90625 
Q 36.140625 65.921875 28.71875 65.921875 
Q 24.65625 65.921875 20.015625 65.03125 
Q 15.375 64.15625 9.8125 62.3125 
L 9.8125 71.09375 
Q 15.4375 72.65625 20.34375 73.4375 
Q 25.25 74.21875 29.59375 74.21875 
Q 40.828125 74.21875 47.359375 69.109375 
Q 53.90625 64.015625 53.90625 55.328125 
Q 53.90625 49.265625 50.4375 45.09375 
Q 46.96875 40.921875 40.578125 39.3125 
z
" id="DejaVuSans-51"></path></defs><use transform="translate(0 0.765625)" xlink:href="#DejaVuSans-49"></use><use transform="translate(63.623047 0.765625)" xlink:href="#DejaVuSans-48"></use><use transform="translate(128.203125 39.046875)scale(0.7)" xlink:href="#DejaVuSans-8722"></use><use transform="translate(186.855469 39.046875)scale(0.7)" xlink:href="#DejaVuSans-51"></use></g></g></g><g id="ytick_3"><g id="line2d_47"><g><use style="stroke:#000000;stroke-width:0.8;" x="61.05625" xlink:href="#m7b70621c74" y="273.429959"></use></g></g><g id="text_13"><!-- $\mathdefault{10^{-2}}$ --><g transform="translate(30.55625 277.229178)scale(0.1 -0.1)"><defs><path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path></defs><use transform="translate(0 0.765625)" xlink:href="#DejaVuSans-49"></use><use transform="translate(63.623047 0.765625)" xlink:href="#DejaVuSans-48"></use><use transform="translate(128.203125 39.046875)scale(0.7)" xlink:href="#DejaVuSans-8722"></use><use transform="translate(186.855469 39.046875)scale(0.7)" xlink:href="#DejaVuSans-50"></use></g></g></g><g id="ytick_4"><g id="line2d_48"><g><use style="stroke:#000000;stroke-width:0.8;" x="61.05625" xlink:href="#m7b70621c74" y="167.618617"></use></g></g><g id="text_14"><!-- $\mathdefault{10^{-1}}$ --><g transform="translate(30.55625 171.417836)scale(0.1 -0.1)"><use transform="translate(0 0.684375)" xlink:href="#DejaVuSans-49"></use><use transform="translate(63.623047 0.684375)" xlink:href="#DejaVuSans-48"></use><use transform="translate(128.203125 38.965625)scale(0.7)" xlink:href="#DejaVuSans-8722"></use><use transform="translate(186.855469 38.965625)scale(0.7)" xlink:href="#DejaVuSans-49"></use></g></g></g><g id="ytick_5"><g id="line2d_49"><g><use style="stroke:#000000;stroke-width:0.8;" x="61.05625" xlink:href="#m7b70621c74" y="61.807276"></use></g></g><g id="text_15"><!-- $\mathdefault{10^{0}}$ --><g transform="translate(36.45625 65.606494)scale(0.1 -0.1)"><use transform="translate(0 0.765625)" xlink:href="#DejaVuSans-49"></use><use transform="translate(63.623047 0.765625)" xlink:href="#DejaVuSans-48"></use><use transform="translate(128.203125 39.046875)scale(0.7)" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_6"><g id="line2d_50"><defs><path d="M 0 0 
L -2 0 
" id="m4d618a560e" style="stroke:#000000;stroke-width:0.6;"></path></defs><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="501.443027"></use></g></g></g><g id="ytick_7"><g id="line2d_51"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="495.306822"></use></g></g></g><g id="ytick_8"><g id="line2d_52"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="489.894305"></use></g></g></g><g id="ytick_9"><g id="line2d_53"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="453.200255"></use></g></g></g><g id="ytick_10"><g id="line2d_54"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="434.567803"></use></g></g></g><g id="ytick_11"><g id="line2d_55"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="421.347868"></use></g></g></g><g id="ytick_12"><g id="line2d_56"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="411.093689"></use></g></g></g><g id="ytick_13"><g id="line2d_57"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="402.715415"></use></g></g></g><g id="ytick_14"><g id="line2d_58"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="395.631685"></use></g></g></g><g id="ytick_15"><g id="line2d_59"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="389.49548"></use></g></g></g><g id="ytick_16"><g id="line2d_60"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="384.082963"></use></g></g></g><g id="ytick_17"><g id="line2d_61"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="347.388913"></use></g></g></g><g id="ytick_18"><g id="line2d_62"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="328.756461"></use></g></g></g><g id="ytick_19"><g id="line2d_63"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="315.536526"></use></g></g></g><g id="ytick_20"><g id="line2d_64"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="305.282347"></use></g></g></g><g id="ytick_21"><g id="line2d_65"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="296.904073"></use></g></g></g><g id="ytick_22"><g id="line2d_66"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="289.820344"></use></g></g></g><g id="ytick_23"><g id="line2d_67"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="283.684138"></use></g></g></g><g id="ytick_24"><g id="line2d_68"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="278.271621"></use></g></g></g><g id="ytick_25"><g id="line2d_69"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="241.577572"></use></g></g></g><g id="ytick_26"><g id="line2d_70"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="222.945119"></use></g></g></g><g id="ytick_27"><g id="line2d_71"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="209.725184"></use></g></g></g><g id="ytick_28"><g id="line2d_72"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="199.471005"></use></g></g></g><g id="ytick_29"><g id="line2d_73"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="191.092731"></use></g></g></g><g id="ytick_30"><g id="line2d_74"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="184.009002"></use></g></g></g><g id="ytick_31"><g id="line2d_75"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="177.872796"></use></g></g></g><g id="ytick_32"><g id="line2d_76"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="172.460279"></use></g></g></g><g id="ytick_33"><g id="line2d_77"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="135.76623"></use></g></g></g><g id="ytick_34"><g id="line2d_78"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="117.133777"></use></g></g></g><g id="ytick_35"><g id="line2d_79"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="103.913842"></use></g></g></g><g id="ytick_36"><g id="line2d_80"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="93.659663"></use></g></g></g><g id="ytick_37"><g id="line2d_81"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="85.281389"></use></g></g></g><g id="ytick_38"><g id="line2d_82"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="78.19766"></use></g></g></g><g id="ytick_39"><g id="line2d_83"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="72.061454"></use></g></g></g><g id="ytick_40"><g id="line2d_84"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="66.648937"></use></g></g></g><g id="ytick_41"><g id="line2d_85"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="29.954888"></use></g></g></g><g id="ytick_42"><g id="line2d_86"><g><use style="stroke:#000000;stroke-width:0.6;" x="61.05625" xlink:href="#m4d618a560e" y="11.322435"></use></g></g></g><g id="text_16"><!-- relative sensitivity --><g transform="translate(22.396875 349.31939)rotate(-90)scale(0.2 -0.2)"><defs><path d="M 41.109375 46.296875 
Q 39.59375 47.171875 37.8125 47.578125 
Q 36.03125 48 33.890625 48 
Q 26.265625 48 22.1875 43.046875 
Q 18.109375 38.09375 18.109375 28.8125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 20.953125 51.171875 25.484375 53.578125 
Q 30.03125 56 36.53125 56 
Q 37.453125 56 38.578125 55.875 
Q 39.703125 55.765625 41.0625 55.515625 
z
" id="DejaVuSans-114"></path><path d="M 56.203125 29.59375 
L 56.203125 25.203125 
L 14.890625 25.203125 
Q 15.484375 15.921875 20.484375 11.0625 
Q 25.484375 6.203125 34.421875 6.203125 
Q 39.59375 6.203125 44.453125 7.46875 
Q 49.3125 8.734375 54.109375 11.28125 
L 54.109375 2.78125 
Q 49.265625 0.734375 44.1875 -0.34375 
Q 39.109375 -1.421875 33.890625 -1.421875 
Q 20.796875 -1.421875 13.15625 6.1875 
Q 5.515625 13.8125 5.515625 26.8125 
Q 5.515625 40.234375 12.765625 48.109375 
Q 20.015625 56 32.328125 56 
Q 43.359375 56 49.78125 48.890625 
Q 56.203125 41.796875 56.203125 29.59375 
z
M 47.21875 32.234375 
Q 47.125 39.59375 43.09375 43.984375 
Q 39.0625 48.390625 32.421875 48.390625 
Q 24.90625 48.390625 20.390625 44.140625 
Q 15.875 39.890625 15.1875 32.171875 
z
" id="DejaVuSans-101"></path><path d="M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 0 
L 9.421875 0 
z
" id="DejaVuSans-108"></path><path d="M 34.28125 27.484375 
Q 23.390625 27.484375 19.1875 25 
Q 14.984375 22.515625 14.984375 16.5 
Q 14.984375 11.71875 18.140625 8.90625 
Q 21.296875 6.109375 26.703125 6.109375 
Q 34.1875 6.109375 38.703125 11.40625 
Q 43.21875 16.703125 43.21875 25.484375 
L 43.21875 27.484375 
z
M 52.203125 31.203125 
L 52.203125 0 
L 43.21875 0 
L 43.21875 8.296875 
Q 40.140625 3.328125 35.546875 0.953125 
Q 30.953125 -1.421875 24.3125 -1.421875 
Q 15.921875 -1.421875 10.953125 3.296875 
Q 6 8.015625 6 15.921875 
Q 6 25.140625 12.171875 29.828125 
Q 18.359375 34.515625 30.609375 34.515625 
L 43.21875 34.515625 
L 43.21875 35.40625 
Q 43.21875 41.609375 39.140625 45 
Q 35.0625 48.390625 27.6875 48.390625 
Q 23 48.390625 18.546875 47.265625 
Q 14.109375 46.140625 10.015625 43.890625 
L 10.015625 52.203125 
Q 14.9375 54.109375 19.578125 55.046875 
Q 24.21875 56 28.609375 56 
Q 40.484375 56 46.34375 49.84375 
Q 52.203125 43.703125 52.203125 31.203125 
z
" id="DejaVuSans-97"></path><path d="M 18.3125 70.21875 
L 18.3125 54.6875 
L 36.8125 54.6875 
L 36.8125 47.703125 
L 18.3125 47.703125 
L 18.3125 18.015625 
Q 18.3125 11.328125 20.140625 9.421875 
Q 21.96875 7.515625 27.59375 7.515625 
L 36.8125 7.515625 
L 36.8125 0 
L 27.59375 0 
Q 17.1875 0 13.234375 3.875 
Q 9.28125 7.765625 9.28125 18.015625 
L 9.28125 47.703125 
L 2.6875 47.703125 
L 2.6875 54.6875 
L 9.28125 54.6875 
L 9.28125 70.21875 
z
" id="DejaVuSans-116"></path><path d="M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 0 
L 9.421875 0 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
" id="DejaVuSans-105"></path><path d="M 2.984375 54.6875 
L 12.5 54.6875 
L 29.59375 8.796875 
L 46.6875 54.6875 
L 56.203125 54.6875 
L 35.6875 0 
L 23.484375 0 
z
" id="DejaVuSans-118"></path><path d="M 44.28125 53.078125 
L 44.28125 44.578125 
Q 40.484375 46.53125 36.375 47.5 
Q 32.28125 48.484375 27.875 48.484375 
Q 21.1875 48.484375 17.84375 46.4375 
Q 14.5 44.390625 14.5 40.28125 
Q 14.5 37.15625 16.890625 35.375 
Q 19.28125 33.59375 26.515625 31.984375 
L 29.59375 31.296875 
Q 39.15625 29.25 43.1875 25.515625 
Q 47.21875 21.78125 47.21875 15.09375 
Q 47.21875 7.46875 41.1875 3.015625 
Q 35.15625 -1.421875 24.609375 -1.421875 
Q 20.21875 -1.421875 15.453125 -0.5625 
Q 10.6875 0.296875 5.421875 2 
L 5.421875 11.28125 
Q 10.40625 8.6875 15.234375 7.390625 
Q 20.0625 6.109375 24.8125 6.109375 
Q 31.15625 6.109375 34.5625 8.28125 
Q 37.984375 10.453125 37.984375 14.40625 
Q 37.984375 18.0625 35.515625 20.015625 
Q 33.0625 21.96875 24.703125 23.78125 
L 21.578125 24.515625 
Q 13.234375 26.265625 9.515625 29.90625 
Q 5.8125 33.546875 5.8125 39.890625 
Q 5.8125 47.609375 11.28125 51.796875 
Q 16.75 56 26.8125 56 
Q 31.78125 56 36.171875 55.265625 
Q 40.578125 54.546875 44.28125 53.078125 
z
" id="DejaVuSans-115"></path><path d="M 32.171875 -5.078125 
Q 28.375 -14.84375 24.75 -17.8125 
Q 21.140625 -20.796875 15.09375 -20.796875 
L 7.90625 -20.796875 
L 7.90625 -13.28125 
L 13.1875 -13.28125 
Q 16.890625 -13.28125 18.9375 -11.515625 
Q 21 -9.765625 23.484375 -3.21875 
L 25.09375 0.875 
L 2.984375 54.6875 
L 12.5 54.6875 
L 29.59375 11.921875 
L 46.6875 54.6875 
L 56.203125 54.6875 
z
" id="DejaVuSans-121"></path></defs><use xlink:href="#DejaVuSans-114"></use><use x="38.863281" xlink:href="#DejaVuSans-101"></use><use x="100.386719" xlink:href="#DejaVuSans-108"></use><use x="128.169922" xlink:href="#DejaVuSans-97"></use><use x="189.449219" xlink:href="#DejaVuSans-116"></use><use x="228.658203" xlink:href="#DejaVuSans-105"></use><use x="256.441406" xlink:href="#DejaVuSans-118"></use><use x="315.621094" xlink:href="#DejaVuSans-101"></use><use x="377.144531" xlink:href="#DejaVuSans-32"></use><use x="408.931641" xlink:href="#DejaVuSans-115"></use><use x="461.03125" xlink:href="#DejaVuSans-101"></use><use x="522.554688" xlink:href="#DejaVuSans-110"></use><use x="585.933594" xlink:href="#DejaVuSans-115"></use><use x="638.033203" xlink:href="#DejaVuSans-105"></use><use x="665.816406" xlink:href="#DejaVuSans-116"></use><use x="705.025391" xlink:href="#DejaVuSans-105"></use><use x="732.808594" xlink:href="#DejaVuSans-118"></use><use x="791.988281" xlink:href="#DejaVuSans-105"></use><use x="819.771484" xlink:href="#DejaVuSans-116"></use><use x="858.980469" xlink:href="#DejaVuSans-121"></use></g></g></g><g id="LineCollection_1"><path clip-path="url(#pbfb5e76b61)" d="M 213.360795 556.041906 
L 213.360795 29.954888 
" style="fill:none;stroke:#0000ff;stroke-dasharray:18.5,8;stroke-dashoffset:0;stroke-opacity:0.3;stroke-width:5;"></path></g><g id="LineCollection_2"><path clip-path="url(#pbfb5e76b61)" d="M 410.460795 556.041906 
L 410.460795 29.954888 
" style="fill:none;stroke:#008000;stroke-dasharray:18.5,8;stroke-dashoffset:0;stroke-opacity:0.3;stroke-width:5;"></path></g><g id="LineCollection_3"><path clip-path="url(#pbfb5e76b61)" d="M 491.092614 556.041906 
L 491.092614 29.954888 
" style="fill:none;stroke:#ff0000;stroke-dasharray:18.5,8;stroke-dashoffset:0;stroke-opacity:0.3;stroke-width:5;"></path></g><g id="line2d_87"><path clip-path="url(#pbfb5e76b61)" d="M 96.892614 363.779298 
L 105.851705 343.009098 
L 114.810795 313.294457 
L 123.769886 286.041233 
L 132.728977 256.993645 
L 141.688068 234.757185 
L 150.647159 205.870554 
L 159.60625 179.272497 
L 168.565341 154.032519 
L 177.524432 132.485625 
L 186.483523 119.668579 
L 195.442614 112.963316 
L 204.401705 110.273793 
L 213.360795 110.300188 
L 222.319886 111.898607 
L 231.278977 114.355086 
L 240.238068 118.565072 
L 249.197159 125.3103 
L 258.15625 136.835499 
L 267.115341 151.472433 
L 276.074432 169.686394 
L 285.033523 192.650619 
L 293.992614 219.979362 
L 302.951705 255.725888 
L 311.910795 306.210728 
L 320.869886 339.01064 
L 329.828977 276.764821 
L 338.788068 224.34482 
L 347.747159 188.632357 
L 356.70625 163.406209 
L 365.665341 144.467308 
L 374.624432 130.210969 
L 383.583523 118.628325 
L 392.542614 108.793814 
L 401.501705 100.228548 
L 410.460795 92.560837 
L 419.419886 85.70457 
L 428.378977 79.637985 
L 437.338068 74.291748 
L 446.297159 69.682823 
L 455.25625 65.824119 
L 464.215341 62.801351 
L 473.174432 60.614324 
L 482.133523 59.272913 
L 491.092614 59.034352 
L 500.051705 59.758178 
L 509.010795 61.687952 
L 517.969886 64.728938 
L 526.928977 69.038291 
L 535.888068 74.941511 
L 544.847159 82.14363 
L 553.80625 89.961647 
L 562.765341 98.716275 
L 571.724432 108.653498 
L 580.683523 119.733371 
L 589.642614 131.658762 
L 598.601705 144.634208 
L 607.560795 158.783093 
L 616.519886 173.807371 
L 625.478977 188.415084 
L 634.438068 202.510346 
L 643.397159 218.704767 
L 652.35625 235.758386 
L 661.315341 252.409786 
L 670.274432 267.408781 
L 679.233523 283.113282 
L 688.192614 298.461961 
L 697.151705 314.401819 
L 706.110795 330.314349 
L 715.069886 347.388913 
L 724.028977 363.779298 
L 732.988068 379.241301 
L 741.947159 395.631685 
L 750.90625 411.093689 
L 759.865341 434.567803 
L 768.824432 453.200255 
L 777.783523 453.200255 
L 786.742614 485.052643 
L 795.701705 485.052643 
L 804.660795 485.052643 
L 804.66683 556.041906 
" style="fill:none;stroke:#ff0000;stroke-linecap:square;stroke-width:1.5;"></path></g><g id="line2d_88"><path clip-path="url(#pbfb5e76b61)" d="M 105.84567 556.041906 
L 105.851705 485.052643 
L 114.810795 485.052643 
L 123.769886 453.200255 
L 132.728977 421.347868 
L 141.688068 402.715415 
L 150.647159 370.863027 
L 159.60625 343.009098 
L 168.565341 315.536526 
L 177.524432 287.891951 
L 186.483523 266.609573 
L 195.442614 249.589682 
L 204.401705 235.155052 
L 213.360795 223.2525 
L 222.319886 212.082279 
L 231.278977 201.34691 
L 240.238068 191.092731 
L 249.197159 181.517526 
L 258.15625 171.952503 
L 267.115341 162.165271 
L 276.074432 152.48603 
L 285.033523 143.424118 
L 293.992614 133.963909 
L 302.951705 123.95784 
L 311.910795 113.739215 
L 320.869886 103.082755 
L 329.828977 93.384768 
L 338.788068 84.657614 
L 347.747159 77.545829 
L 356.70625 72.453727 
L 365.665341 68.631338 
L 374.624432 65.894384 
L 383.583523 63.971289 
L 392.542614 62.721591 
L 401.501705 62.037618 
L 410.460795 61.807276 
L 419.419886 62.037618 
L 428.378977 62.801351 
L 437.338068 64.067729 
L 446.297159 65.869277 
L 455.25625 68.206825 
L 464.215341 71.134567 
L 473.174432 74.600303 
L 482.133523 78.533688 
L 491.092614 82.966437 
L 500.051705 87.897195 
L 509.010795 93.384768 
L 517.969886 99.40887 
L 526.928977 106.150166 
L 535.888068 114.02464 
L 544.847159 122.834404 
L 553.80625 132.017362 
L 562.765341 141.902435 
L 571.724432 152.751273 
L 580.683523 164.509481 
L 589.642614 176.9628 
L 598.601705 190.333156 
L 607.560795 204.722967 
L 616.519886 219.979362 
L 625.478977 234.757185 
L 634.438068 249.04585 
L 643.397159 265.436234 
L 652.35625 282.549431 
L 661.315341 299.261168 
L 670.274432 314.401819 
L 679.233523 330.314349 
L 688.192614 345.146845 
L 697.151705 360.608849 
L 706.110795 379.241301 
L 715.069886 395.631685 
L 724.028977 411.093689 
L 732.988068 421.347868 
L 741.947159 453.200255 
L 750.90625 453.200255 
L 759.865341 485.052643 
L 768.824432 485.052643 
L 777.783523 485.052643 
L 777.789558 556.041906 
" style="fill:none;stroke:#008000;stroke-linecap:square;stroke-width:1.5;"></path></g><g id="line2d_89"><path clip-path="url(#pbfb5e76b61)" d="M 96.892614 293.225848 
L 105.851705 271.187891 
L 114.810795 241.348378 
L 123.769886 214.312256 
L 132.728977 185.408702 
L 141.688068 163.155326 
L 150.647159 134.096658 
L 159.60625 107.335256 
L 168.565341 81.91529 
L 177.524432 60.04474 
L 186.483523 46.820382 
L 195.442614 39.553191 
L 204.401705 36.167308 
L 213.360795 35.242925 
L 222.319886 35.514403 
L 231.278977 36.246283 
L 240.238068 38.263366 
L 249.197159 42.321929 
L 258.15625 50.191204 
L 267.115341 59.921079 
L 276.074432 71.320716 
L 285.033523 84.057105 
L 293.992614 96.974764 
L 302.951705 109.618804 
L 311.910795 121.636299 
L 320.869886 133.0236 
L 329.828977 146.540313 
L 338.788068 162.534047 
L 347.747159 178.918554 
L 356.70625 193.208601 
L 365.665341 207.26481 
L 374.624432 223.2525 
L 383.583523 240.893391 
L 392.542614 259.98083 
L 401.501705 279.829508 
L 410.460795 299.261168 
L 419.419886 316.699962 
L 428.378977 333.598123 
L 437.338068 345.146845 
L 446.297159 352.230575 
L 455.25625 354.857192 
L 464.215341 363.779298 
L 473.174432 374.861486 
L 482.133523 379.241301 
L 491.092614 389.49548 
L 500.051705 402.715415 
L 509.010795 434.567803 
L 517.969886 453.200255 
L 526.928977 453.200255 
L 535.888068 485.052643 
L 535.894103 556.041906 
" style="fill:none;stroke:#0000ff;stroke-linecap:square;stroke-width:1.5;"></path></g><g id="patch_3"><path d="M 61.05625 507.807531 
L 61.05625 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_4"><path d="M 849.45625 507.807531 
L 849.45625 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_5"><path d="M 61.05625 507.807531 
L 849.45625 507.807531 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_6"><path d="M 61.05625 7.2 
L 849.45625 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g></g></g><defs><clippath id="pbfb5e76b61"><rect height="500.607531" width="788.4" x="61.05625" y="7.2"></rect></clippath></defs></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Such that we may obtain a RGB value fro a given wavelength, adapting code from <a href="https://scipython.com/blog/converting-a-spectrum-to-a-colour/">https://scipython.com/blog/converting-a-spectrum-to-a-colour/</a> :</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">xyz_from_xy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sd">"""Return the vector (x, y, 1-x-y)."""</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">ColourSystem</span><span class="p">:</span>
    <span class="sd">"""A class representing a colour system.</span>

<span class="sd">    A colour system defined by the CIE x, y and z=1-x-y coordinates of</span>
<span class="sd">    its three primary illuminants and its "white point".</span>

<span class="sd">    TODO: Implement gamma correction</span>

<span class="sd">    """</span>

    <span class="c1"># CMF is the CIE colour matching function for 380 - 780 nm in 5 nm intervals</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">red</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">blue</span><span class="p">,</span> <span class="n">white</span><span class="p">,</span> <span class="n">CMF</span><span class="p">):</span>
        <span class="sd">"""Initialise the ColourSystem object.</span>

<span class="sd">        Pass vectors (ie NumPy arrays of shape (3,)) for each of the</span>
<span class="sd">        red, green, blue  chromaticities and the white illuminant</span>
<span class="sd">        defining the colour system.</span>

<span class="sd">        """</span>

        <span class="c1"># Chromaticities</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">red</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">green</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">blue</span> <span class="o">=</span> <span class="n">red</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">blue</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">white</span> <span class="o">=</span> <span class="n">white</span>
        <span class="c1"># The chromaticity matrix (rgb -&gt; xyz) and its inverse</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">red</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">green</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">blue</span><span class="p">))</span><span class="o">.</span><span class="n">T</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">MI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="p">)</span>
        <span class="c1"># White scaling array</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wscale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MI</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">white</span><span class="p">)</span>
        <span class="c1"># xyz -&gt; rgb transformation matrix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MI</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">wscale</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cmf</span> <span class="o">=</span> <span class="n">CMF</span>

    <span class="k">def</span> <span class="nf">xyz_to_rgb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">out_fmt</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">"""Transform from xyz to rgb representation of colour.</span>

<span class="sd">        The output rgb components are normalized on their maximum</span>
<span class="sd">        value. If xyz is out the rgb gamut, it is desaturated until it</span>
<span class="sd">        comes into gamut.</span>

<span class="sd">        By default, fractional rgb components are returned; if</span>
<span class="sd">        out_fmt='html', the HTML hex string '#rrggbb' is returned.</span>

<span class="sd">        """</span>

        <span class="n">rgb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">xyz</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">rgb</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="c1"># We're not in the RGB gamut: approximate by desaturating</span>
            <span class="n">w</span> <span class="o">=</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rgb</span><span class="p">)</span>
            <span class="n">rgb</span> <span class="o">+=</span> <span class="n">w</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">rgb</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span>
            <span class="c1"># Normalize the rgb vector</span>
            <span class="n">rgb</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rgb</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rgb</span>

    <span class="k">def</span> <span class="nf">spec_to_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spec</span><span class="p">):</span>
        <span class="sd">"""Convert a spectrum to an xyz point.</span>

<span class="sd">        The spectrum must be on the same grid of points as the colour-matching</span>
<span class="sd">        function, self.cmf: 380-780 nm in 5 nm steps.</span>

<span class="sd">        """</span>

        <span class="n">XYZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spec</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmf</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">den</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">XYZ</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">den</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">XYZ</span>
        <span class="k">return</span> <span class="n">XYZ</span> <span class="o">/</span> <span class="n">den</span>

    <span class="k">def</span> <span class="nf">spec_to_rgb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="n">out_fmt</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">"""Convert a spectrum to an rgb value."""</span>

        <span class="n">xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spec_to_xyz</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz_to_rgb</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span> <span class="n">out_fmt</span><span class="p">)</span>

<span class="c1"># a standard white:</span>
<span class="n">illuminant_D65</span> <span class="o">=</span> <span class="n">xyz_from_xy</span><span class="p">(</span><span class="mf">0.3127</span><span class="p">,</span> <span class="mf">0.3291</span><span class="p">)</span>
<span class="c1"># color conversion class</span>
<span class="n">cs_srgb</span> <span class="o">=</span> <span class="n">ColourSystem</span><span class="p">(</span><span class="n">red</span><span class="o">=</span><span class="n">xyz_from_xy</span><span class="p">(</span><span class="mf">0.64</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">),</span>
                       <span class="n">green</span><span class="o">=</span><span class="n">xyz_from_xy</span><span class="p">(</span><span class="mf">0.30</span><span class="p">,</span> <span class="mf">0.60</span><span class="p">),</span>
                       <span class="n">blue</span><span class="o">=</span><span class="n">xyz_from_xy</span><span class="p">(</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">),</span>
                       <span class="n">white</span><span class="o">=</span><span class="n">illuminant_D65</span><span class="p">,</span>
                       <span class="n">CMF</span><span class="o">=</span><span class="n">CMF</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Colors-of-pure-wavelengths">Colors of pure wavelengths<a class="anchor-link" href="2020-07-04-colors-of-the-sky.html#Colors-of-pure-wavelengths">¶</a>
</h3>
<p>To better understand what happens, let's render the color perceived for the spectrum of "pure" wavelengths (that is, a spectrum peaked at one wavelength):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wavelengths</span> <span class="o">=</span> <span class="n">CMF</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-9</span>
<span class="n">N_wavelengths</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">)</span>
<span class="n">hues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">N_wavelengths</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i_wavelengths</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N_wavelengths</span><span class="p">):</span>
    <span class="n">spec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_wavelengths</span><span class="p">)</span>
    <span class="n">spec</span><span class="p">[</span><span class="n">i_wavelengths</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">hues</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i_wavelengths</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">cs_srgb</span><span class="o">.</span><span class="n">spec_to_rgb</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="o">**</span><span class="n">adjustprops</span><span class="p">)</span>
<span class="c1">#ax.pcolormesh(wavelengths[:, None], np.ones((N_wavelengths, 1)), hues) </span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">hues</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'The colors of the spectrum'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?><!-- Created with matplotlib (https://matplotlib.org/) --><svg height="55.929583pt" version="1.1" viewbox="0 0 835.578646 55.929583" width="835.578646pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><metadata><rdf xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><work><type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></type><date>2020-07-28T21:35:02.416081</date><format>image/svg+xml</format><creator><agent><title>Matplotlib v3.3.0, https://matplotlib.org/</title></agent></creator></work></rdf></metadata><defs><style type="text/css">*{stroke-linecap:butt;stroke-linejoin:round;}</style></defs><g id="figure_1"><g id="patch_1"><path d="M 0 55.929583 
L 835.578646 55.929583 
L 835.578646 -0 
L 0 -0 
z
" style="fill:none;"></path></g><g id="axes_1"><g id="patch_2"><path d="M 38.482813 32.051458 
L 826.882812 32.051458 
L 826.882812 22.318125 
L 38.482813 22.318125 
z
" style="fill:#ffffff;"></path></g><g clip-path="url(#pa6046a9d86)"><image height="10" id="image0c1dc07a5d" transform="scale(1 -1)translate(0 -10)" width="789" x="38.482813" xlink:href="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAxUAAAAKCAYAAADCdXPZAAABJ0lEQVR4nO3XO0oEQRSG0du+YIxMzAxNTExMJhKNTV2rCzBzA4KxiKAI4/uB2G7hb6pgBM+JP+50Q9E1dzipcazAW9CsJIMmGDrOil5yQpf66dRUVX137r6C5iOclZyPqqqnsFusBtFOOGw37PbDbh40x+Gs7cswvAq7m6B5CGc9ht1z0LyGs17CLj5JQXMXTdqo26jbi6qqg6A5Cmedht3sLAwvgiY9ktdhdx92ybFMj9F72I1rYbgeNMnHbUqX3rzJjbqMW7znTd/bX362ZUn+JaVnt+dvVlV9Bs1WOGsRdptZNiR3c2g87DcrNNR51PX+ggAAAP+MpQIAAGhiqQAAAJpYKgAAgCaWCgAAoImlAgAAaGKpAAAAmlgqAACAJpYKAACgyS/FSioTdfgN2QAAAABJRU5ErkJggg==" y="-22.051458"></image></g><g id="matplotlib.axis_1"><g id="xtick_1"><g id="line2d_1"><defs><path d="M 0 0 
L 0 3.5 
" id="m178de0ae89" style="stroke:#000000;stroke-width:0.8;"></path></defs><g><use style="stroke:#000000;stroke-width:0.8;" x="43.349479" xlink:href="#m178de0ae89" y="32.051458"></use></g></g><g id="text_1"><!-- 0 --><g transform="translate(40.168229 46.649896)scale(0.1 -0.1)"><defs><path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path></defs><use xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_2"><g id="line2d_2"><g><use style="stroke:#000000;stroke-width:0.8;" x="140.682813" xlink:href="#m178de0ae89" y="32.051458"></use></g></g><g id="text_2"><!-- 10 --><g transform="translate(134.320312 46.649896)scale(0.1 -0.1)"><defs><path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path></defs><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_3"><g id="line2d_3"><g><use style="stroke:#000000;stroke-width:0.8;" x="238.016146" xlink:href="#m178de0ae89" y="32.051458"></use></g></g><g id="text_3"><!-- 20 --><g transform="translate(231.653646 46.649896)scale(0.1 -0.1)"><defs><path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path></defs><use xlink:href="#DejaVuSans-50"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_4"><g id="line2d_4"><g><use style="stroke:#000000;stroke-width:0.8;" x="335.349479" xlink:href="#m178de0ae89" y="32.051458"></use></g></g><g id="text_4"><!-- 30 --><g transform="translate(328.986979 46.649896)scale(0.1 -0.1)"><defs><path d="M 40.578125 39.3125 
Q 47.65625 37.796875 51.625 33 
Q 55.609375 28.21875 55.609375 21.1875 
Q 55.609375 10.40625 48.1875 4.484375 
Q 40.765625 -1.421875 27.09375 -1.421875 
Q 22.515625 -1.421875 17.65625 -0.515625 
Q 12.796875 0.390625 7.625 2.203125 
L 7.625 11.71875 
Q 11.71875 9.328125 16.59375 8.109375 
Q 21.484375 6.890625 26.8125 6.890625 
Q 36.078125 6.890625 40.9375 10.546875 
Q 45.796875 14.203125 45.796875 21.1875 
Q 45.796875 27.640625 41.28125 31.265625 
Q 36.765625 34.90625 28.71875 34.90625 
L 20.21875 34.90625 
L 20.21875 43.015625 
L 29.109375 43.015625 
Q 36.375 43.015625 40.234375 45.921875 
Q 44.09375 48.828125 44.09375 54.296875 
Q 44.09375 59.90625 40.109375 62.90625 
Q 36.140625 65.921875 28.71875 65.921875 
Q 24.65625 65.921875 20.015625 65.03125 
Q 15.375 64.15625 9.8125 62.3125 
L 9.8125 71.09375 
Q 15.4375 72.65625 20.34375 73.4375 
Q 25.25 74.21875 29.59375 74.21875 
Q 40.828125 74.21875 47.359375 69.109375 
Q 53.90625 64.015625 53.90625 55.328125 
Q 53.90625 49.265625 50.4375 45.09375 
Q 46.96875 40.921875 40.578125 39.3125 
z
" id="DejaVuSans-51"></path></defs><use xlink:href="#DejaVuSans-51"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_5"><g id="line2d_5"><g><use style="stroke:#000000;stroke-width:0.8;" x="432.682813" xlink:href="#m178de0ae89" y="32.051458"></use></g></g><g id="text_5"><!-- 40 --><g transform="translate(426.320312 46.649896)scale(0.1 -0.1)"><defs><path d="M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
" id="DejaVuSans-52"></path></defs><use xlink:href="#DejaVuSans-52"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_6"><g id="line2d_6"><g><use style="stroke:#000000;stroke-width:0.8;" x="530.016146" xlink:href="#m178de0ae89" y="32.051458"></use></g></g><g id="text_6"><!-- 50 --><g transform="translate(523.653646 46.649896)scale(0.1 -0.1)"><defs><path d="M 10.796875 72.90625 
L 49.515625 72.90625 
L 49.515625 64.59375 
L 19.828125 64.59375 
L 19.828125 46.734375 
Q 21.96875 47.46875 24.109375 47.828125 
Q 26.265625 48.1875 28.421875 48.1875 
Q 40.625 48.1875 47.75 41.5 
Q 54.890625 34.8125 54.890625 23.390625 
Q 54.890625 11.625 47.5625 5.09375 
Q 40.234375 -1.421875 26.90625 -1.421875 
Q 22.3125 -1.421875 17.546875 -0.640625 
Q 12.796875 0.140625 7.71875 1.703125 
L 7.71875 11.625 
Q 12.109375 9.234375 16.796875 8.0625 
Q 21.484375 6.890625 26.703125 6.890625 
Q 35.15625 6.890625 40.078125 11.328125 
Q 45.015625 15.765625 45.015625 23.390625 
Q 45.015625 31 40.078125 35.4375 
Q 35.15625 39.890625 26.703125 39.890625 
Q 22.75 39.890625 18.8125 39.015625 
Q 14.890625 38.140625 10.796875 36.28125 
z
" id="DejaVuSans-53"></path></defs><use xlink:href="#DejaVuSans-53"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_7"><g id="line2d_7"><g><use style="stroke:#000000;stroke-width:0.8;" x="627.349479" xlink:href="#m178de0ae89" y="32.051458"></use></g></g><g id="text_7"><!-- 60 --><g transform="translate(620.986979 46.649896)scale(0.1 -0.1)"><defs><path d="M 33.015625 40.375 
Q 26.375 40.375 22.484375 35.828125 
Q 18.609375 31.296875 18.609375 23.390625 
Q 18.609375 15.53125 22.484375 10.953125 
Q 26.375 6.390625 33.015625 6.390625 
Q 39.65625 6.390625 43.53125 10.953125 
Q 47.40625 15.53125 47.40625 23.390625 
Q 47.40625 31.296875 43.53125 35.828125 
Q 39.65625 40.375 33.015625 40.375 
z
M 52.59375 71.296875 
L 52.59375 62.3125 
Q 48.875 64.0625 45.09375 64.984375 
Q 41.3125 65.921875 37.59375 65.921875 
Q 27.828125 65.921875 22.671875 59.328125 
Q 17.53125 52.734375 16.796875 39.40625 
Q 19.671875 43.65625 24.015625 45.921875 
Q 28.375 48.1875 33.59375 48.1875 
Q 44.578125 48.1875 50.953125 41.515625 
Q 57.328125 34.859375 57.328125 23.390625 
Q 57.328125 12.15625 50.6875 5.359375 
Q 44.046875 -1.421875 33.015625 -1.421875 
Q 20.359375 -1.421875 13.671875 8.265625 
Q 6.984375 17.96875 6.984375 36.375 
Q 6.984375 53.65625 15.1875 63.9375 
Q 23.390625 74.21875 37.203125 74.21875 
Q 40.921875 74.21875 44.703125 73.484375 
Q 48.484375 72.75 52.59375 71.296875 
z
" id="DejaVuSans-54"></path></defs><use xlink:href="#DejaVuSans-54"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_8"><g id="line2d_8"><g><use style="stroke:#000000;stroke-width:0.8;" x="724.682812" xlink:href="#m178de0ae89" y="32.051458"></use></g></g><g id="text_8"><!-- 70 --><g transform="translate(718.320312 46.649896)scale(0.1 -0.1)"><defs><path d="M 8.203125 72.90625 
L 55.078125 72.90625 
L 55.078125 68.703125 
L 28.609375 0 
L 18.3125 0 
L 43.21875 64.59375 
L 8.203125 64.59375 
z
" id="DejaVuSans-55"></path></defs><use xlink:href="#DejaVuSans-55"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_9"><g id="line2d_9"><g><use style="stroke:#000000;stroke-width:0.8;" x="822.016146" xlink:href="#m178de0ae89" y="32.051458"></use></g></g><g id="text_9"><!-- 80 --><g transform="translate(815.653646 46.649896)scale(0.1 -0.1)"><defs><path d="M 31.78125 34.625 
Q 24.75 34.625 20.71875 30.859375 
Q 16.703125 27.09375 16.703125 20.515625 
Q 16.703125 13.921875 20.71875 10.15625 
Q 24.75 6.390625 31.78125 6.390625 
Q 38.8125 6.390625 42.859375 10.171875 
Q 46.921875 13.96875 46.921875 20.515625 
Q 46.921875 27.09375 42.890625 30.859375 
Q 38.875 34.625 31.78125 34.625 
z
M 21.921875 38.8125 
Q 15.578125 40.375 12.03125 44.71875 
Q 8.5 49.078125 8.5 55.328125 
Q 8.5 64.0625 14.71875 69.140625 
Q 20.953125 74.21875 31.78125 74.21875 
Q 42.671875 74.21875 48.875 69.140625 
Q 55.078125 64.0625 55.078125 55.328125 
Q 55.078125 49.078125 51.53125 44.71875 
Q 48 40.375 41.703125 38.8125 
Q 48.828125 37.15625 52.796875 32.3125 
Q 56.78125 27.484375 56.78125 20.515625 
Q 56.78125 9.90625 50.3125 4.234375 
Q 43.84375 -1.421875 31.78125 -1.421875 
Q 19.734375 -1.421875 13.25 4.234375 
Q 6.78125 9.90625 6.78125 20.515625 
Q 6.78125 27.484375 10.78125 32.3125 
Q 14.796875 37.15625 21.921875 38.8125 
z
M 18.3125 54.390625 
Q 18.3125 48.734375 21.84375 45.5625 
Q 25.390625 42.390625 31.78125 42.390625 
Q 38.140625 42.390625 41.71875 45.5625 
Q 45.3125 48.734375 45.3125 54.390625 
Q 45.3125 60.0625 41.71875 63.234375 
Q 38.140625 66.40625 31.78125 66.40625 
Q 25.390625 66.40625 21.84375 63.234375 
Q 18.3125 60.0625 18.3125 54.390625 
z
" id="DejaVuSans-56"></path></defs><use xlink:href="#DejaVuSans-56"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use></g></g></g></g><g id="matplotlib.axis_2"><g id="ytick_1"><g id="line2d_10"><defs><path d="M 0 0 
L -3.5 0 
" id="m4bc0c730b2" style="stroke:#000000;stroke-width:0.8;"></path></defs><g><use style="stroke:#000000;stroke-width:0.8;" x="38.482813" xlink:href="#m4bc0c730b2" y="22.318125"></use></g></g><g id="text_10"><!-- −0.5 --><g transform="translate(7.2 26.117344)scale(0.1 -0.1)"><defs><path d="M 10.59375 35.5 
L 73.1875 35.5 
L 73.1875 27.203125 
L 10.59375 27.203125 
z
" id="DejaVuSans-8722"></path><path d="M 10.6875 12.40625 
L 21 12.40625 
L 21 0 
L 10.6875 0 
z
" id="DejaVuSans-46"></path></defs><use xlink:href="#DejaVuSans-8722"></use><use x="83.789062" xlink:href="#DejaVuSans-48"></use><use x="147.412109" xlink:href="#DejaVuSans-46"></use><use x="179.199219" xlink:href="#DejaVuSans-53"></use></g></g></g><g id="ytick_2"><g id="line2d_11"><g><use style="stroke:#000000;stroke-width:0.8;" x="38.482813" xlink:href="#m4bc0c730b2" y="27.184792"></use></g></g><g id="text_11"><!-- 0.0 --><g transform="translate(15.579688 30.98401)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_3"><g id="line2d_12"><g><use style="stroke:#000000;stroke-width:0.8;" x="38.482813" xlink:href="#m4bc0c730b2" y="32.051458"></use></g></g><g id="text_12"><!-- 0.5 --><g transform="translate(15.579688 35.850677)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-53"></use></g></g></g></g><g id="patch_3"><path d="M 38.482813 32.051458 
L 38.482813 22.318125 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_4"><path d="M 826.882812 32.051458 
L 826.882812 22.318125 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_5"><path d="M 38.482813 32.051458 
L 826.882812 32.051458 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_6"><path d="M 38.482813 22.318125 
L 826.882812 22.318125 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="text_13"><!-- The colors of the spectrum --><g transform="translate(351.974375 16.318125)scale(0.12 -0.12)"><defs><path d="M -0.296875 72.90625 
L 61.375 72.90625 
L 61.375 64.59375 
L 35.5 64.59375 
L 35.5 0 
L 25.59375 0 
L 25.59375 64.59375 
L -0.296875 64.59375 
z
" id="DejaVuSans-84"></path><path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 75.984375 
L 18.109375 75.984375 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-104"></path><path d="M 56.203125 29.59375 
L 56.203125 25.203125 
L 14.890625 25.203125 
Q 15.484375 15.921875 20.484375 11.0625 
Q 25.484375 6.203125 34.421875 6.203125 
Q 39.59375 6.203125 44.453125 7.46875 
Q 49.3125 8.734375 54.109375 11.28125 
L 54.109375 2.78125 
Q 49.265625 0.734375 44.1875 -0.34375 
Q 39.109375 -1.421875 33.890625 -1.421875 
Q 20.796875 -1.421875 13.15625 6.1875 
Q 5.515625 13.8125 5.515625 26.8125 
Q 5.515625 40.234375 12.765625 48.109375 
Q 20.015625 56 32.328125 56 
Q 43.359375 56 49.78125 48.890625 
Q 56.203125 41.796875 56.203125 29.59375 
z
M 47.21875 32.234375 
Q 47.125 39.59375 43.09375 43.984375 
Q 39.0625 48.390625 32.421875 48.390625 
Q 24.90625 48.390625 20.390625 44.140625 
Q 15.875 39.890625 15.1875 32.171875 
z
" id="DejaVuSans-101"></path><path id="DejaVuSans-32"></path><path d="M 48.78125 52.59375 
L 48.78125 44.1875 
Q 44.96875 46.296875 41.140625 47.34375 
Q 37.3125 48.390625 33.40625 48.390625 
Q 24.65625 48.390625 19.8125 42.84375 
Q 14.984375 37.3125 14.984375 27.296875 
Q 14.984375 17.28125 19.8125 11.734375 
Q 24.65625 6.203125 33.40625 6.203125 
Q 37.3125 6.203125 41.140625 7.25 
Q 44.96875 8.296875 48.78125 10.40625 
L 48.78125 2.09375 
Q 45.015625 0.34375 40.984375 -0.53125 
Q 36.96875 -1.421875 32.421875 -1.421875 
Q 20.0625 -1.421875 12.78125 6.34375 
Q 5.515625 14.109375 5.515625 27.296875 
Q 5.515625 40.671875 12.859375 48.328125 
Q 20.21875 56 33.015625 56 
Q 37.15625 56 41.109375 55.140625 
Q 45.0625 54.296875 48.78125 52.59375 
z
" id="DejaVuSans-99"></path><path d="M 30.609375 48.390625 
Q 23.390625 48.390625 19.1875 42.75 
Q 14.984375 37.109375 14.984375 27.296875 
Q 14.984375 17.484375 19.15625 11.84375 
Q 23.34375 6.203125 30.609375 6.203125 
Q 37.796875 6.203125 41.984375 11.859375 
Q 46.1875 17.53125 46.1875 27.296875 
Q 46.1875 37.015625 41.984375 42.703125 
Q 37.796875 48.390625 30.609375 48.390625 
z
M 30.609375 56 
Q 42.328125 56 49.015625 48.375 
Q 55.71875 40.765625 55.71875 27.296875 
Q 55.71875 13.875 49.015625 6.21875 
Q 42.328125 -1.421875 30.609375 -1.421875 
Q 18.84375 -1.421875 12.171875 6.21875 
Q 5.515625 13.875 5.515625 27.296875 
Q 5.515625 40.765625 12.171875 48.375 
Q 18.84375 56 30.609375 56 
z
" id="DejaVuSans-111"></path><path d="M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 0 
L 9.421875 0 
z
" id="DejaVuSans-108"></path><path d="M 41.109375 46.296875 
Q 39.59375 47.171875 37.8125 47.578125 
Q 36.03125 48 33.890625 48 
Q 26.265625 48 22.1875 43.046875 
Q 18.109375 38.09375 18.109375 28.8125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 20.953125 51.171875 25.484375 53.578125 
Q 30.03125 56 36.53125 56 
Q 37.453125 56 38.578125 55.875 
Q 39.703125 55.765625 41.0625 55.515625 
z
" id="DejaVuSans-114"></path><path d="M 44.28125 53.078125 
L 44.28125 44.578125 
Q 40.484375 46.53125 36.375 47.5 
Q 32.28125 48.484375 27.875 48.484375 
Q 21.1875 48.484375 17.84375 46.4375 
Q 14.5 44.390625 14.5 40.28125 
Q 14.5 37.15625 16.890625 35.375 
Q 19.28125 33.59375 26.515625 31.984375 
L 29.59375 31.296875 
Q 39.15625 29.25 43.1875 25.515625 
Q 47.21875 21.78125 47.21875 15.09375 
Q 47.21875 7.46875 41.1875 3.015625 
Q 35.15625 -1.421875 24.609375 -1.421875 
Q 20.21875 -1.421875 15.453125 -0.5625 
Q 10.6875 0.296875 5.421875 2 
L 5.421875 11.28125 
Q 10.40625 8.6875 15.234375 7.390625 
Q 20.0625 6.109375 24.8125 6.109375 
Q 31.15625 6.109375 34.5625 8.28125 
Q 37.984375 10.453125 37.984375 14.40625 
Q 37.984375 18.0625 35.515625 20.015625 
Q 33.0625 21.96875 24.703125 23.78125 
L 21.578125 24.515625 
Q 13.234375 26.265625 9.515625 29.90625 
Q 5.8125 33.546875 5.8125 39.890625 
Q 5.8125 47.609375 11.28125 51.796875 
Q 16.75 56 26.8125 56 
Q 31.78125 56 36.171875 55.265625 
Q 40.578125 54.546875 44.28125 53.078125 
z
" id="DejaVuSans-115"></path><path d="M 37.109375 75.984375 
L 37.109375 68.5 
L 28.515625 68.5 
Q 23.6875 68.5 21.796875 66.546875 
Q 19.921875 64.59375 19.921875 59.515625 
L 19.921875 54.6875 
L 34.71875 54.6875 
L 34.71875 47.703125 
L 19.921875 47.703125 
L 19.921875 0 
L 10.890625 0 
L 10.890625 47.703125 
L 2.296875 47.703125 
L 2.296875 54.6875 
L 10.890625 54.6875 
L 10.890625 58.5 
Q 10.890625 67.625 15.140625 71.796875 
Q 19.390625 75.984375 28.609375 75.984375 
z
" id="DejaVuSans-102"></path><path d="M 18.3125 70.21875 
L 18.3125 54.6875 
L 36.8125 54.6875 
L 36.8125 47.703125 
L 18.3125 47.703125 
L 18.3125 18.015625 
Q 18.3125 11.328125 20.140625 9.421875 
Q 21.96875 7.515625 27.59375 7.515625 
L 36.8125 7.515625 
L 36.8125 0 
L 27.59375 0 
Q 17.1875 0 13.234375 3.875 
Q 9.28125 7.765625 9.28125 18.015625 
L 9.28125 47.703125 
L 2.6875 47.703125 
L 2.6875 54.6875 
L 9.28125 54.6875 
L 9.28125 70.21875 
z
" id="DejaVuSans-116"></path><path d="M 18.109375 8.203125 
L 18.109375 -20.796875 
L 9.078125 -20.796875 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.390625 
Q 20.953125 51.265625 25.265625 53.625 
Q 29.59375 56 35.59375 56 
Q 45.5625 56 51.78125 48.09375 
Q 58.015625 40.1875 58.015625 27.296875 
Q 58.015625 14.40625 51.78125 6.484375 
Q 45.5625 -1.421875 35.59375 -1.421875 
Q 29.59375 -1.421875 25.265625 0.953125 
Q 20.953125 3.328125 18.109375 8.203125 
z
M 48.6875 27.296875 
Q 48.6875 37.203125 44.609375 42.84375 
Q 40.53125 48.484375 33.40625 48.484375 
Q 26.265625 48.484375 22.1875 42.84375 
Q 18.109375 37.203125 18.109375 27.296875 
Q 18.109375 17.390625 22.1875 11.75 
Q 26.265625 6.109375 33.40625 6.109375 
Q 40.53125 6.109375 44.609375 11.75 
Q 48.6875 17.390625 48.6875 27.296875 
z
" id="DejaVuSans-112"></path><path d="M 8.5 21.578125 
L 8.5 54.6875 
L 17.484375 54.6875 
L 17.484375 21.921875 
Q 17.484375 14.15625 20.5 10.265625 
Q 23.53125 6.390625 29.59375 6.390625 
Q 36.859375 6.390625 41.078125 11.03125 
Q 45.3125 15.671875 45.3125 23.6875 
L 45.3125 54.6875 
L 54.296875 54.6875 
L 54.296875 0 
L 45.3125 0 
L 45.3125 8.40625 
Q 42.046875 3.421875 37.71875 1 
Q 33.40625 -1.421875 27.6875 -1.421875 
Q 18.265625 -1.421875 13.375 4.4375 
Q 8.5 10.296875 8.5 21.578125 
z
M 31.109375 56 
z
" id="DejaVuSans-117"></path><path d="M 52 44.1875 
Q 55.375 50.25 60.0625 53.125 
Q 64.75 56 71.09375 56 
Q 79.640625 56 84.28125 50.015625 
Q 88.921875 44.046875 88.921875 33.015625 
L 88.921875 0 
L 79.890625 0 
L 79.890625 32.71875 
Q 79.890625 40.578125 77.09375 44.375 
Q 74.3125 48.1875 68.609375 48.1875 
Q 61.625 48.1875 57.5625 43.546875 
Q 53.515625 38.921875 53.515625 30.90625 
L 53.515625 0 
L 44.484375 0 
L 44.484375 32.71875 
Q 44.484375 40.625 41.703125 44.40625 
Q 38.921875 48.1875 33.109375 48.1875 
Q 26.21875 48.1875 22.15625 43.53125 
Q 18.109375 38.875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.1875 51.21875 25.484375 53.609375 
Q 29.78125 56 35.6875 56 
Q 41.65625 56 45.828125 52.96875 
Q 50 49.953125 52 44.1875 
z
" id="DejaVuSans-109"></path></defs><use xlink:href="#DejaVuSans-84"></use><use x="61.083984" xlink:href="#DejaVuSans-104"></use><use x="124.462891" xlink:href="#DejaVuSans-101"></use><use x="185.986328" xlink:href="#DejaVuSans-32"></use><use x="217.773438" xlink:href="#DejaVuSans-99"></use><use x="272.753906" xlink:href="#DejaVuSans-111"></use><use x="333.935547" xlink:href="#DejaVuSans-108"></use><use x="361.71875" xlink:href="#DejaVuSans-111"></use><use x="422.900391" xlink:href="#DejaVuSans-114"></use><use x="464.013672" xlink:href="#DejaVuSans-115"></use><use x="516.113281" xlink:href="#DejaVuSans-32"></use><use x="547.900391" xlink:href="#DejaVuSans-111"></use><use x="609.082031" xlink:href="#DejaVuSans-102"></use><use x="644.287109" xlink:href="#DejaVuSans-32"></use><use x="676.074219" xlink:href="#DejaVuSans-116"></use><use x="715.283203" xlink:href="#DejaVuSans-104"></use><use x="778.662109" xlink:href="#DejaVuSans-101"></use><use x="840.185547" xlink:href="#DejaVuSans-32"></use><use x="871.972656" xlink:href="#DejaVuSans-115"></use><use x="924.072266" xlink:href="#DejaVuSans-112"></use><use x="987.548828" xlink:href="#DejaVuSans-101"></use><use x="1049.072266" xlink:href="#DejaVuSans-99"></use><use x="1104.052734" xlink:href="#DejaVuSans-116"></use><use x="1143.261719" xlink:href="#DejaVuSans-114"></use><use x="1184.375" xlink:href="#DejaVuSans-117"></use><use x="1247.753906" xlink:href="#DejaVuSans-109"></use></g></g></g></g><defs><clippath id="pa6046a9d86"><rect height="9.733333" width="788.4" x="38.482813" y="22.318125"></rect></clippath></defs></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Getting-the-final-color">Getting the final color<a class="anchor-link" href="2020-07-04-colors-of-the-sky.html#Getting-the-final-color">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wavelengths</span> <span class="o">=</span> <span class="n">CMF</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-9</span>
<span class="n">intensity5800</span> <span class="o">=</span> <span class="n">planck</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="mf">5800.</span><span class="p">)</span>
<span class="n">scatter</span> <span class="o">=</span> <span class="n">scattering</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">intensity5800</span> <span class="o">*</span> <span class="n">scatter</span>
<span class="n">cs_srgb</span><span class="o">.</span><span class="n">spec_to_rgb</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[10]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([0.488779, 0.672615, 1.      ])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="o">**</span><span class="n">adjustprops</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cs_srgb</span><span class="o">.</span><span class="n">spec_to_rgb</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:])</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'The color of the sky'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?><!-- Created with matplotlib (https://matplotlib.org/) --><svg height="546.803781pt" version="1.1" viewbox="0 0 546.290343 546.803781" width="546.290343pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><metadata><rdf xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><work><type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></type><date>2020-07-28T21:35:02.828512</date><format>image/svg+xml</format><creator><agent><title>Matplotlib v3.3.0, https://matplotlib.org/</title></agent></creator></work></rdf></metadata><defs><style type="text/css">*{stroke-linecap:butt;stroke-linejoin:round;}</style></defs><g id="figure_1"><g id="patch_1"><path d="M 0 546.803781 
L 546.290343 546.803781 
L 546.290343 0 
L 0 0 
z
" style="fill:none;"></path></g><g id="axes_1"><g id="patch_2"><path d="M 38.482812 522.925656 
L 539.090343 522.925656 
L 539.090343 22.318125 
L 38.482812 22.318125 
z
" style="fill:#ffffff;"></path></g><g clip-path="url(#p5d02af7b24)"><image height="501" id="image8189ed5710" transform="scale(1 -1)translate(0 -501)" width="501" x="38.482812" xlink:href="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAfUAAAH1CAYAAADvSGcRAAAH9klEQVR4nO3VQQ3AIADAQIZuHE0kM0FC1twp6K/PevceAMDvzdsBAMAZpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AEaYOABGmDgARpg4AER+iIwcP/EkdNgAAAABJRU5ErkJggg==" y="-21.925656"></image></g><g id="matplotlib.axis_1"><g id="xtick_1"><g id="line2d_1"><defs><path d="M 0 0 
L 0 3.5 
" id="mc215258dc5" style="stroke:#000000;stroke-width:0.8;"></path></defs><g><use style="stroke:#000000;stroke-width:0.8;" x="88.543566" xlink:href="#mc215258dc5" y="522.925656"></use></g></g><g id="text_1"><!-- −0.4 --><g transform="translate(76.402159 537.524093)scale(0.1 -0.1)"><defs><path d="M 10.59375 35.5 
L 73.1875 35.5 
L 73.1875 27.203125 
L 10.59375 27.203125 
z
" id="DejaVuSans-8722"></path><path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path><path d="M 10.6875 12.40625 
L 21 12.40625 
L 21 0 
L 10.6875 0 
z
" id="DejaVuSans-46"></path><path d="M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
" id="DejaVuSans-52"></path></defs><use xlink:href="#DejaVuSans-8722"></use><use x="83.789062" xlink:href="#DejaVuSans-48"></use><use x="147.412109" xlink:href="#DejaVuSans-46"></use><use x="179.199219" xlink:href="#DejaVuSans-52"></use></g></g></g><g id="xtick_2"><g id="line2d_2"><g><use style="stroke:#000000;stroke-width:0.8;" x="188.665072" xlink:href="#mc215258dc5" y="522.925656"></use></g></g><g id="text_2"><!-- −0.2 --><g transform="translate(176.523666 537.524093)scale(0.1 -0.1)"><defs><path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path></defs><use xlink:href="#DejaVuSans-8722"></use><use x="83.789062" xlink:href="#DejaVuSans-48"></use><use x="147.412109" xlink:href="#DejaVuSans-46"></use><use x="179.199219" xlink:href="#DejaVuSans-50"></use></g></g></g><g id="xtick_3"><g id="line2d_3"><g><use style="stroke:#000000;stroke-width:0.8;" x="288.786578" xlink:href="#mc215258dc5" y="522.925656"></use></g></g><g id="text_3"><!-- 0.0 --><g transform="translate(280.835015 537.524093)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_4"><g id="line2d_4"><g><use style="stroke:#000000;stroke-width:0.8;" x="388.908084" xlink:href="#mc215258dc5" y="522.925656"></use></g></g><g id="text_4"><!-- 0.2 --><g transform="translate(380.956522 537.524093)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-50"></use></g></g></g><g id="xtick_5"><g id="line2d_5"><g><use style="stroke:#000000;stroke-width:0.8;" x="489.02959" xlink:href="#mc215258dc5" y="522.925656"></use></g></g><g id="text_5"><!-- 0.4 --><g transform="translate(481.078028 537.524093)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-52"></use></g></g></g></g><g id="matplotlib.axis_2"><g id="ytick_1"><g id="line2d_6"><defs><path d="M 0 0 
L -3.5 0 
" id="m81e316639f" style="stroke:#000000;stroke-width:0.8;"></path></defs><g><use style="stroke:#000000;stroke-width:0.8;" x="38.482812" xlink:href="#m81e316639f" y="72.378878"></use></g></g><g id="text_6"><!-- −0.4 --><g transform="translate(7.2 76.178097)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-8722"></use><use x="83.789062" xlink:href="#DejaVuSans-48"></use><use x="147.412109" xlink:href="#DejaVuSans-46"></use><use x="179.199219" xlink:href="#DejaVuSans-52"></use></g></g></g><g id="ytick_2"><g id="line2d_7"><g><use style="stroke:#000000;stroke-width:0.8;" x="38.482812" xlink:href="#m81e316639f" y="172.500384"></use></g></g><g id="text_7"><!-- −0.2 --><g transform="translate(7.2 176.299603)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-8722"></use><use x="83.789062" xlink:href="#DejaVuSans-48"></use><use x="147.412109" xlink:href="#DejaVuSans-46"></use><use x="179.199219" xlink:href="#DejaVuSans-50"></use></g></g></g><g id="ytick_3"><g id="line2d_8"><g><use style="stroke:#000000;stroke-width:0.8;" x="38.482812" xlink:href="#m81e316639f" y="272.62189"></use></g></g><g id="text_8"><!-- 0.0 --><g transform="translate(15.579687 276.421109)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_4"><g id="line2d_9"><g><use style="stroke:#000000;stroke-width:0.8;" x="38.482812" xlink:href="#m81e316639f" y="372.743397"></use></g></g><g id="text_9"><!-- 0.2 --><g transform="translate(15.579687 376.542615)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-50"></use></g></g></g><g id="ytick_5"><g id="line2d_10"><g><use style="stroke:#000000;stroke-width:0.8;" x="38.482812" xlink:href="#m81e316639f" y="472.864903"></use></g></g><g id="text_10"><!-- 0.4 --><g transform="translate(15.579687 476.664122)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-52"></use></g></g></g></g><g id="patch_3"><path d="M 38.482812 522.925656 
L 38.482812 22.318125 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_4"><path d="M 539.090343 522.925656 
L 539.090343 22.318125 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_5"><path d="M 38.482812 522.925656 
L 539.090343 522.925656 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_6"><path d="M 38.482812 22.318125 
L 539.090343 22.318125 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="text_11"><!-- The color of the sky --><g transform="translate(229.661265 16.318125)scale(0.12 -0.12)"><defs><path d="M -0.296875 72.90625 
L 61.375 72.90625 
L 61.375 64.59375 
L 35.5 64.59375 
L 35.5 0 
L 25.59375 0 
L 25.59375 64.59375 
L -0.296875 64.59375 
z
" id="DejaVuSans-84"></path><path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 75.984375 
L 18.109375 75.984375 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-104"></path><path d="M 56.203125 29.59375 
L 56.203125 25.203125 
L 14.890625 25.203125 
Q 15.484375 15.921875 20.484375 11.0625 
Q 25.484375 6.203125 34.421875 6.203125 
Q 39.59375 6.203125 44.453125 7.46875 
Q 49.3125 8.734375 54.109375 11.28125 
L 54.109375 2.78125 
Q 49.265625 0.734375 44.1875 -0.34375 
Q 39.109375 -1.421875 33.890625 -1.421875 
Q 20.796875 -1.421875 13.15625 6.1875 
Q 5.515625 13.8125 5.515625 26.8125 
Q 5.515625 40.234375 12.765625 48.109375 
Q 20.015625 56 32.328125 56 
Q 43.359375 56 49.78125 48.890625 
Q 56.203125 41.796875 56.203125 29.59375 
z
M 47.21875 32.234375 
Q 47.125 39.59375 43.09375 43.984375 
Q 39.0625 48.390625 32.421875 48.390625 
Q 24.90625 48.390625 20.390625 44.140625 
Q 15.875 39.890625 15.1875 32.171875 
z
" id="DejaVuSans-101"></path><path id="DejaVuSans-32"></path><path d="M 48.78125 52.59375 
L 48.78125 44.1875 
Q 44.96875 46.296875 41.140625 47.34375 
Q 37.3125 48.390625 33.40625 48.390625 
Q 24.65625 48.390625 19.8125 42.84375 
Q 14.984375 37.3125 14.984375 27.296875 
Q 14.984375 17.28125 19.8125 11.734375 
Q 24.65625 6.203125 33.40625 6.203125 
Q 37.3125 6.203125 41.140625 7.25 
Q 44.96875 8.296875 48.78125 10.40625 
L 48.78125 2.09375 
Q 45.015625 0.34375 40.984375 -0.53125 
Q 36.96875 -1.421875 32.421875 -1.421875 
Q 20.0625 -1.421875 12.78125 6.34375 
Q 5.515625 14.109375 5.515625 27.296875 
Q 5.515625 40.671875 12.859375 48.328125 
Q 20.21875 56 33.015625 56 
Q 37.15625 56 41.109375 55.140625 
Q 45.0625 54.296875 48.78125 52.59375 
z
" id="DejaVuSans-99"></path><path d="M 30.609375 48.390625 
Q 23.390625 48.390625 19.1875 42.75 
Q 14.984375 37.109375 14.984375 27.296875 
Q 14.984375 17.484375 19.15625 11.84375 
Q 23.34375 6.203125 30.609375 6.203125 
Q 37.796875 6.203125 41.984375 11.859375 
Q 46.1875 17.53125 46.1875 27.296875 
Q 46.1875 37.015625 41.984375 42.703125 
Q 37.796875 48.390625 30.609375 48.390625 
z
M 30.609375 56 
Q 42.328125 56 49.015625 48.375 
Q 55.71875 40.765625 55.71875 27.296875 
Q 55.71875 13.875 49.015625 6.21875 
Q 42.328125 -1.421875 30.609375 -1.421875 
Q 18.84375 -1.421875 12.171875 6.21875 
Q 5.515625 13.875 5.515625 27.296875 
Q 5.515625 40.765625 12.171875 48.375 
Q 18.84375 56 30.609375 56 
z
" id="DejaVuSans-111"></path><path d="M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 0 
L 9.421875 0 
z
" id="DejaVuSans-108"></path><path d="M 41.109375 46.296875 
Q 39.59375 47.171875 37.8125 47.578125 
Q 36.03125 48 33.890625 48 
Q 26.265625 48 22.1875 43.046875 
Q 18.109375 38.09375 18.109375 28.8125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 20.953125 51.171875 25.484375 53.578125 
Q 30.03125 56 36.53125 56 
Q 37.453125 56 38.578125 55.875 
Q 39.703125 55.765625 41.0625 55.515625 
z
" id="DejaVuSans-114"></path><path d="M 37.109375 75.984375 
L 37.109375 68.5 
L 28.515625 68.5 
Q 23.6875 68.5 21.796875 66.546875 
Q 19.921875 64.59375 19.921875 59.515625 
L 19.921875 54.6875 
L 34.71875 54.6875 
L 34.71875 47.703125 
L 19.921875 47.703125 
L 19.921875 0 
L 10.890625 0 
L 10.890625 47.703125 
L 2.296875 47.703125 
L 2.296875 54.6875 
L 10.890625 54.6875 
L 10.890625 58.5 
Q 10.890625 67.625 15.140625 71.796875 
Q 19.390625 75.984375 28.609375 75.984375 
z
" id="DejaVuSans-102"></path><path d="M 18.3125 70.21875 
L 18.3125 54.6875 
L 36.8125 54.6875 
L 36.8125 47.703125 
L 18.3125 47.703125 
L 18.3125 18.015625 
Q 18.3125 11.328125 20.140625 9.421875 
Q 21.96875 7.515625 27.59375 7.515625 
L 36.8125 7.515625 
L 36.8125 0 
L 27.59375 0 
Q 17.1875 0 13.234375 3.875 
Q 9.28125 7.765625 9.28125 18.015625 
L 9.28125 47.703125 
L 2.6875 47.703125 
L 2.6875 54.6875 
L 9.28125 54.6875 
L 9.28125 70.21875 
z
" id="DejaVuSans-116"></path><path d="M 44.28125 53.078125 
L 44.28125 44.578125 
Q 40.484375 46.53125 36.375 47.5 
Q 32.28125 48.484375 27.875 48.484375 
Q 21.1875 48.484375 17.84375 46.4375 
Q 14.5 44.390625 14.5 40.28125 
Q 14.5 37.15625 16.890625 35.375 
Q 19.28125 33.59375 26.515625 31.984375 
L 29.59375 31.296875 
Q 39.15625 29.25 43.1875 25.515625 
Q 47.21875 21.78125 47.21875 15.09375 
Q 47.21875 7.46875 41.1875 3.015625 
Q 35.15625 -1.421875 24.609375 -1.421875 
Q 20.21875 -1.421875 15.453125 -0.5625 
Q 10.6875 0.296875 5.421875 2 
L 5.421875 11.28125 
Q 10.40625 8.6875 15.234375 7.390625 
Q 20.0625 6.109375 24.8125 6.109375 
Q 31.15625 6.109375 34.5625 8.28125 
Q 37.984375 10.453125 37.984375 14.40625 
Q 37.984375 18.0625 35.515625 20.015625 
Q 33.0625 21.96875 24.703125 23.78125 
L 21.578125 24.515625 
Q 13.234375 26.265625 9.515625 29.90625 
Q 5.8125 33.546875 5.8125 39.890625 
Q 5.8125 47.609375 11.28125 51.796875 
Q 16.75 56 26.8125 56 
Q 31.78125 56 36.171875 55.265625 
Q 40.578125 54.546875 44.28125 53.078125 
z
" id="DejaVuSans-115"></path><path d="M 9.078125 75.984375 
L 18.109375 75.984375 
L 18.109375 31.109375 
L 44.921875 54.6875 
L 56.390625 54.6875 
L 27.390625 29.109375 
L 57.625 0 
L 45.90625 0 
L 18.109375 26.703125 
L 18.109375 0 
L 9.078125 0 
z
" id="DejaVuSans-107"></path><path d="M 32.171875 -5.078125 
Q 28.375 -14.84375 24.75 -17.8125 
Q 21.140625 -20.796875 15.09375 -20.796875 
L 7.90625 -20.796875 
L 7.90625 -13.28125 
L 13.1875 -13.28125 
Q 16.890625 -13.28125 18.9375 -11.515625 
Q 21 -9.765625 23.484375 -3.21875 
L 25.09375 0.875 
L 2.984375 54.6875 
L 12.5 54.6875 
L 29.59375 11.921875 
L 46.6875 54.6875 
L 56.203125 54.6875 
z
" id="DejaVuSans-121"></path></defs><use xlink:href="#DejaVuSans-84"></use><use x="61.083984" xlink:href="#DejaVuSans-104"></use><use x="124.462891" xlink:href="#DejaVuSans-101"></use><use x="185.986328" xlink:href="#DejaVuSans-32"></use><use x="217.773438" xlink:href="#DejaVuSans-99"></use><use x="272.753906" xlink:href="#DejaVuSans-111"></use><use x="333.935547" xlink:href="#DejaVuSans-108"></use><use x="361.71875" xlink:href="#DejaVuSans-111"></use><use x="422.900391" xlink:href="#DejaVuSans-114"></use><use x="464.013672" xlink:href="#DejaVuSans-32"></use><use x="495.800781" xlink:href="#DejaVuSans-111"></use><use x="556.982422" xlink:href="#DejaVuSans-102"></use><use x="592.1875" xlink:href="#DejaVuSans-32"></use><use x="623.974609" xlink:href="#DejaVuSans-116"></use><use x="663.183594" xlink:href="#DejaVuSans-104"></use><use x="726.5625" xlink:href="#DejaVuSans-101"></use><use x="788.085938" xlink:href="#DejaVuSans-32"></use><use x="819.873047" xlink:href="#DejaVuSans-115"></use><use x="871.972656" xlink:href="#DejaVuSans-107"></use><use x="926.257812" xlink:href="#DejaVuSans-121"></use></g></g></g></g><defs><clippath id="p5d02af7b24"><rect height="500.607531" width="500.607531" x="38.482812" y="22.318125"></rect></clippath></defs></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So that we can compare the extra-terrestrial color of the sun vs the color of the sky:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># again borrowing code from https://scipython.com/blog/converting-a-spectrum-to-a-colour/</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Circle</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_width</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([[</span><span class="s1">'sun'</span><span class="p">,</span> <span class="n">intensity5800</span><span class="p">],</span> <span class="p">[</span><span class="s1">'sky'</span><span class="p">,</span> <span class="n">spectrum</span><span class="p">]]):</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="mf">1.2</span>
    <span class="n">html_rgb</span> <span class="o">=</span> <span class="n">cs_srgb</span><span class="o">.</span><span class="n">spec_to_rgb</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">out_fmt</span><span class="o">=</span><span class="s1">'html'</span><span class="p">)</span>

    <span class="c1"># Place and label a circle with the colour of a black body at temperature T</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">radius</span><span class="o">*.</span><span class="mi">75</span> <span class="o">+</span> <span class="mf">2.5</span><span class="o">*</span><span class="n">radius</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="n">radius</span>
    <span class="n">circle</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">(</span><span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">*</span><span class="mf">1.2</span><span class="p">),</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="n">html_rgb</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">va</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>

<span class="c1"># Set the limits and background colour; remove the ticks</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">5.25</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.75</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">'k'</span><span class="p">)</span>
<span class="c1"># Make sure our circles are circular!</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">"equal"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?><!-- Created with matplotlib (https://matplotlib.org/) --><svg height="418.204348pt" version="1.1" viewbox="0 0 854.9 418.204348" width="854.9pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><metadata><rdf xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><work><type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></type><date>2020-07-28T21:35:03.471150</date><format>image/svg+xml</format><creator><agent><title>Matplotlib v3.3.0, https://matplotlib.org/</title></agent></creator></work></rdf></metadata><defs><style type="text/css">*{stroke-linecap:butt;stroke-linejoin:round;}</style></defs><g id="figure_1"><g id="patch_1"><path d="M 0 418.204348 
L 854.9 418.204348 
L 854.9 0 
L 0 0 
z
" style="fill:none;"></path></g><g id="axes_1"><g id="patch_2"><path d="M 10.7 407.504348 
L 847.7 407.504348 
L 847.7 7.2 
L 10.7 7.2 
z
"></path></g><g id="patch_3"><path clip-path="url(#p00e552db87)" d="M 214.491304 391.492174 
C 260.816521 391.492174 305.250613 373.08697 338.007487 340.330096 
C 370.764362 307.573221 389.169565 263.139129 389.169565 216.813913 
C 389.169565 170.488697 370.764362 126.054605 338.007487 93.29773 
C 305.250613 60.540856 260.816521 42.135652 214.491304 42.135652 
C 168.166088 42.135652 123.731996 60.540856 90.975122 93.29773 
C 58.218247 126.054605 39.813043 170.488697 39.813043 216.813913 
C 39.813043 263.139129 58.218247 307.573221 90.975122 340.330096 
C 123.731996 373.08697 168.166088 391.492174 214.491304 391.492174 
z
" style="fill:#ffe0d3;"></path></g><g id="patch_4"><path clip-path="url(#p00e552db87)" d="M 651.186957 391.492174 
C 697.512173 391.492174 741.946265 373.08697 774.703139 340.330096 
C 807.460014 307.573221 825.865217 263.139129 825.865217 216.813913 
C 825.865217 170.488697 807.460014 126.054605 774.703139 93.29773 
C 741.946265 60.540856 697.512173 42.135652 651.186957 42.135652 
C 604.86174 42.135652 560.427648 60.540856 527.670774 93.29773 
C 494.913899 126.054605 476.508696 170.488697 476.508696 216.813913 
C 476.508696 263.139129 494.913899 307.573221 527.670774 340.330096 
C 560.427648 373.08697 604.86174 391.492174 651.186957 391.492174 
z
" style="fill:#7dacff;"></path></g><g id="matplotlib.axis_1"></g><g id="matplotlib.axis_2"></g><g id="patch_5"><path d="M 10.7 407.504348 
L 10.7 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_6"><path d="M 847.7 407.504348 
L 847.7 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_7"><path d="M 10.7 407.504348 
L 847.7 407.504348 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_8"><path d="M 10.7 7.2 
L 847.7 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="text_1"><!-- sun --><g transform="translate(182.299429 191.812011)scale(0.36 -0.36)"><defs><path d="M 44.28125 53.078125 
L 44.28125 44.578125 
Q 40.484375 46.53125 36.375 47.5 
Q 32.28125 48.484375 27.875 48.484375 
Q 21.1875 48.484375 17.84375 46.4375 
Q 14.5 44.390625 14.5 40.28125 
Q 14.5 37.15625 16.890625 35.375 
Q 19.28125 33.59375 26.515625 31.984375 
L 29.59375 31.296875 
Q 39.15625 29.25 43.1875 25.515625 
Q 47.21875 21.78125 47.21875 15.09375 
Q 47.21875 7.46875 41.1875 3.015625 
Q 35.15625 -1.421875 24.609375 -1.421875 
Q 20.21875 -1.421875 15.453125 -0.5625 
Q 10.6875 0.296875 5.421875 2 
L 5.421875 11.28125 
Q 10.40625 8.6875 15.234375 7.390625 
Q 20.0625 6.109375 24.8125 6.109375 
Q 31.15625 6.109375 34.5625 8.28125 
Q 37.984375 10.453125 37.984375 14.40625 
Q 37.984375 18.0625 35.515625 20.015625 
Q 33.0625 21.96875 24.703125 23.78125 
L 21.578125 24.515625 
Q 13.234375 26.265625 9.515625 29.90625 
Q 5.8125 33.546875 5.8125 39.890625 
Q 5.8125 47.609375 11.28125 51.796875 
Q 16.75 56 26.8125 56 
Q 31.78125 56 36.171875 55.265625 
Q 40.578125 54.546875 44.28125 53.078125 
z
" id="DejaVuSans-115"></path><path d="M 8.5 21.578125 
L 8.5 54.6875 
L 17.484375 54.6875 
L 17.484375 21.921875 
Q 17.484375 14.15625 20.5 10.265625 
Q 23.53125 6.390625 29.59375 6.390625 
Q 36.859375 6.390625 41.078125 11.03125 
Q 45.3125 15.671875 45.3125 23.6875 
L 45.3125 54.6875 
L 54.296875 54.6875 
L 54.296875 0 
L 45.3125 0 
L 45.3125 8.40625 
Q 42.046875 3.421875 37.71875 1 
Q 33.40625 -1.421875 27.6875 -1.421875 
Q 18.265625 -1.421875 13.375 4.4375 
Q 8.5 10.296875 8.5 21.578125 
z
M 31.109375 56 
z
" id="DejaVuSans-117"></path><path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-110"></path></defs><use xlink:href="#DejaVuSans-115"></use><use x="52.099609" xlink:href="#DejaVuSans-117"></use><use x="115.478516" xlink:href="#DejaVuSans-110"></use></g></g><g id="text_2"><!-- sky --><g transform="translate(621.385707 191.812011)scale(0.36 -0.36)"><defs><path d="M 9.078125 75.984375 
L 18.109375 75.984375 
L 18.109375 31.109375 
L 44.921875 54.6875 
L 56.390625 54.6875 
L 27.390625 29.109375 
L 57.625 0 
L 45.90625 0 
L 18.109375 26.703125 
L 18.109375 0 
L 9.078125 0 
z
" id="DejaVuSans-107"></path><path d="M 32.171875 -5.078125 
Q 28.375 -14.84375 24.75 -17.8125 
Q 21.140625 -20.796875 15.09375 -20.796875 
L 7.90625 -20.796875 
L 7.90625 -13.28125 
L 13.1875 -13.28125 
Q 16.890625 -13.28125 18.9375 -11.515625 
Q 21 -9.765625 23.484375 -3.21875 
L 25.09375 0.875 
L 2.984375 54.6875 
L 12.5 54.6875 
L 29.59375 11.921875 
L 46.6875 54.6875 
L 56.203125 54.6875 
z
" id="DejaVuSans-121"></path></defs><use xlink:href="#DejaVuSans-115"></use><use x="52.099609" xlink:href="#DejaVuSans-107"></use><use x="106.384766" xlink:href="#DejaVuSans-121"></use></g></g></g></g><defs><clippath id="p00e552db87"><rect height="400.304348" width="837" x="10.7" y="7.2"></rect></clippath></defs></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>both may be compared with each other to give an idea of their relative colors:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># again borrowing code from https://scipython.com/blog/converting-a-spectrum-to-a-colour/</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Circle</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_width</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([[</span><span class="s1">'sky'</span><span class="p">,</span> <span class="n">spectrum</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="s1">'sun'</span><span class="p">,</span> <span class="n">intensity5800</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">]]):</span>
    <span class="n">html_rgb</span> <span class="o">=</span> <span class="n">cs_srgb</span><span class="o">.</span><span class="n">spec_to_rgb</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">out_fmt</span><span class="o">=</span><span class="s1">'html'</span><span class="p">)</span>

    <span class="c1"># Place and label a circle with the colour of a black body at temperature T</span>
    <span class="n">circle</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">(</span><span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="n">html_rgb</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.25</span><span class="o">*</span><span class="p">(</span><span class="n">radius</span><span class="o">/</span><span class="mi">2</span><span class="o">-.</span><span class="mi">05</span><span class="p">)),</span> <span class="n">va</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>

<span class="c1"># Set the limits and background colour; remove the ticks</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">'k'</span><span class="p">)</span>
<span class="c1"># Make sure our circles are circular!</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">"equal"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?><!-- Created with matplotlib (https://matplotlib.org/) --><svg height="833.3pt" version="1.1" viewbox="0 0 833.3 833.3" width="833.3pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><metadata><rdf xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><work><type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></type><date>2020-07-28T21:35:04.224028</date><format>image/svg+xml</format><creator><agent><title>Matplotlib v3.3.0, https://matplotlib.org/</title></agent></creator></work></rdf></metadata><defs><style type="text/css">*{stroke-linecap:butt;stroke-linejoin:round;}</style></defs><g id="figure_1"><g id="patch_1"><path d="M 0 833.3 
L 833.3 833.3 
L 833.3 0 
L 0 0 
z
" style="fill:none;"></path></g><g id="axes_1"><g id="patch_2"><path d="M 10.7 822.6 
L 826.1 822.6 
L 826.1 7.2 
L 10.7 7.2 
z
"></path></g><g id="patch_3"><path clip-path="url(#p00aae19dd3)" d="M 418.4 781.83 
C 515.710973 781.83 609.049442 743.16794 677.858691 674.358691 
C 746.66794 605.549442 785.33 512.210973 785.33 414.9 
C 785.33 317.589027 746.66794 224.250558 677.858691 155.441309 
C 609.049442 86.63206 515.710973 47.97 418.4 47.97 
C 321.089027 47.97 227.750558 86.63206 158.941309 155.441309 
C 90.13206 224.250558 51.47 317.589027 51.47 414.9 
C 51.47 512.210973 90.13206 605.549442 158.941309 674.358691 
C 227.750558 743.16794 321.089027 781.83 418.4 781.83 
z
" style="fill:#7dacff;"></path></g><g id="patch_4"><path clip-path="url(#p00aae19dd3)" d="M 418.4 455.67 
C 429.21233 455.67 439.583271 451.374216 447.228743 443.728743 
C 454.874216 436.083271 459.17 425.71233 459.17 414.9 
C 459.17 404.08767 454.874216 393.716729 447.228743 386.071257 
C 439.583271 378.425784 429.21233 374.13 418.4 374.13 
C 407.58767 374.13 397.216729 378.425784 389.571257 386.071257 
C 381.925784 393.716729 377.63 404.08767 377.63 414.9 
C 377.63 425.71233 381.925784 436.083271 389.571257 443.728743 
C 397.216729 451.374216 407.58767 455.67 418.4 455.67 
z
" style="fill:#ffe0d3;"></path></g><g id="matplotlib.axis_1"></g><g id="matplotlib.axis_2"></g><g id="patch_5"><path d="M 10.7 822.6 
L 10.7 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_6"><path d="M 826.1 822.6 
L 826.1 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_7"><path d="M 10.7 822.6 
L 826.1 822.6 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_8"><path d="M 10.7 7.2 
L 826.1 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="text_1"><!-- sky --><g transform="translate(388.59875 220.98375)scale(0.36 -0.36)"><defs><path d="M 44.28125 53.078125 
L 44.28125 44.578125 
Q 40.484375 46.53125 36.375 47.5 
Q 32.28125 48.484375 27.875 48.484375 
Q 21.1875 48.484375 17.84375 46.4375 
Q 14.5 44.390625 14.5 40.28125 
Q 14.5 37.15625 16.890625 35.375 
Q 19.28125 33.59375 26.515625 31.984375 
L 29.59375 31.296875 
Q 39.15625 29.25 43.1875 25.515625 
Q 47.21875 21.78125 47.21875 15.09375 
Q 47.21875 7.46875 41.1875 3.015625 
Q 35.15625 -1.421875 24.609375 -1.421875 
Q 20.21875 -1.421875 15.453125 -0.5625 
Q 10.6875 0.296875 5.421875 2 
L 5.421875 11.28125 
Q 10.40625 8.6875 15.234375 7.390625 
Q 20.0625 6.109375 24.8125 6.109375 
Q 31.15625 6.109375 34.5625 8.28125 
Q 37.984375 10.453125 37.984375 14.40625 
Q 37.984375 18.0625 35.515625 20.015625 
Q 33.0625 21.96875 24.703125 23.78125 
L 21.578125 24.515625 
Q 13.234375 26.265625 9.515625 29.90625 
Q 5.8125 33.546875 5.8125 39.890625 
Q 5.8125 47.609375 11.28125 51.796875 
Q 16.75 56 26.8125 56 
Q 31.78125 56 36.171875 55.265625 
Q 40.578125 54.546875 44.28125 53.078125 
z
" id="DejaVuSans-115"></path><path d="M 9.078125 75.984375 
L 18.109375 75.984375 
L 18.109375 31.109375 
L 44.921875 54.6875 
L 56.390625 54.6875 
L 27.390625 29.109375 
L 57.625 0 
L 45.90625 0 
L 18.109375 26.703125 
L 18.109375 0 
L 9.078125 0 
z
" id="DejaVuSans-107"></path><path d="M 32.171875 -5.078125 
Q 28.375 -14.84375 24.75 -17.8125 
Q 21.140625 -20.796875 15.09375 -20.796875 
L 7.90625 -20.796875 
L 7.90625 -13.28125 
L 13.1875 -13.28125 
Q 16.890625 -13.28125 18.9375 -11.515625 
Q 21 -9.765625 23.484375 -3.21875 
L 25.09375 0.875 
L 2.984375 54.6875 
L 12.5 54.6875 
L 29.59375 11.921875 
L 46.6875 54.6875 
L 56.203125 54.6875 
z
" id="DejaVuSans-121"></path></defs><use xlink:href="#DejaVuSans-115"></use><use x="52.099609" xlink:href="#DejaVuSans-107"></use><use x="106.384766" xlink:href="#DejaVuSans-121"></use></g></g><g id="text_2"><!-- sun --><g transform="translate(386.208125 424.83375)scale(0.36 -0.36)"><defs><path d="M 8.5 21.578125 
L 8.5 54.6875 
L 17.484375 54.6875 
L 17.484375 21.921875 
Q 17.484375 14.15625 20.5 10.265625 
Q 23.53125 6.390625 29.59375 6.390625 
Q 36.859375 6.390625 41.078125 11.03125 
Q 45.3125 15.671875 45.3125 23.6875 
L 45.3125 54.6875 
L 54.296875 54.6875 
L 54.296875 0 
L 45.3125 0 
L 45.3125 8.40625 
Q 42.046875 3.421875 37.71875 1 
Q 33.40625 -1.421875 27.6875 -1.421875 
Q 18.265625 -1.421875 13.375 4.4375 
Q 8.5 10.296875 8.5 21.578125 
z
M 31.109375 56 
z
" id="DejaVuSans-117"></path><path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-110"></path></defs><use xlink:href="#DejaVuSans-115"></use><use x="52.099609" xlink:href="#DejaVuSans-117"></use><use x="115.478516" xlink:href="#DejaVuSans-110"></use></g></g></g></g><defs><clippath id="p00aae19dd3"><rect height="815.4" width="815.4" x="10.7" y="7.2"></rect></clippath></defs></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="and-what-about-sunset?">and what about sunset?<a class="anchor-link" href="2020-07-04-colors-of-the-sky.html#and-what-about-sunset?">¶</a>
</h3>
<p>"At the other end of the visible spectrum the reason for the red color of the horizon at sunrise or sunset is still an open  question." [<a href="https://file.scirp.org/pdf/ACS20120400011_46715429.pdf">Zagury, 2012</a>] - did you know that the sky can also have shades of <a href="https://physics.stackexchange.com/questions/137189/why-is-the-sky-never-green-it-can-be-blue-or-orange-and-green-is-in-between/192408#192408">green</a>? Or the reason for the "<a href="https://physics.stackexchange.com/questions/461187/is-there-a-difference-between-the-red-sky-in-the-morning-and-in-the-evening/461225#461225">Red sky at night, sailors delight</a>" proverb?</p>
<p>At sunset, light as to travel a larger path through the atmosphere, and is in particular relatively more absorbed in the <a href="https://en.wikipedia.org/wiki/Chappuis_absorption">Chappuis bands</a>.</p>
<p>still, an approximation can be made for the effect of sunset as Rayleigh extinction</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">chappuis</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">lambda_NO3</span><span class="o">=</span><span class="mf">550e-9</span><span class="p">,</span> <span class="n">B_NO3</span><span class="o">=</span><span class="mf">80e-9</span><span class="p">,</span> <span class="n">lambda_N2</span><span class="o">=</span><span class="mf">680e-9</span><span class="p">,</span> <span class="n">B_N2</span><span class="o">=</span><span class="mf">100e-9</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">1.</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    # The absorption maximum lies around 603 nm</span>
<span class="sd">    # with a cross-section of 5.23 10−21 cm2</span>
<span class="sd">    </span>
<span class="sd">    N_O3  is  the  ozone  column  density  along  the  path  of  sunlight,  </span>
<span class="sd">    sigma_O3 is  the  wavelength dependent ozone absorption cross-section.</span>
<span class="sd">    </span>
<span class="sd">    """</span>
    <span class="n">c_absorption</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">factor</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-.</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">wavelengths</span><span class="o">-</span><span class="n">lambda_NO3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">B_NO3</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">c_absorption</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-.</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">wavelengths</span><span class="o">-</span><span class="n">lambda_N2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">B_N2</span><span class="o">/</span><span class="n">factor</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">c_absorption</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
<span class="c1"># borrowed from https://github.com/gummiks/gummiks.github.io/blob/master/scripts/astro/planck.py</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="o">**</span><span class="n">adjustprops</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>

<span class="n">wavelengths</span> <span class="o">=</span> <span class="n">CMF</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-9</span>
<span class="n">intensity5800</span> <span class="o">=</span> <span class="n">planck</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="mf">5800.</span><span class="p">)</span>
<span class="k">for</span> <span class="n">factor</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">spectrum</span> <span class="o">=</span> <span class="n">intensity5800</span> <span class="o">*</span> <span class="n">scattering</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">)</span> <span class="o">*</span> <span class="n">chappuis</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="n">factor</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelengths</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="n">spectrum</span> <span class="o">/</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">ls</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">'factor=</span><span class="si">{</span><span class="n">factor</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">445</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">555</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">'g'</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">'r'</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$\lambda$ (nm)'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'relative spectral radiance of blue sky'</span><span class="p">)</span>
<span class="c1">#ax.set_ylim(0)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">'log'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?><!-- Created with matplotlib (https://matplotlib.org/) --><svg height="555.041906pt" version="1.1" viewbox="0 0 883.2 555.041906" width="883.2pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><metadata><rdf xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><work><type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></type><date>2020-07-28T21:35:07.025011</date><format>image/svg+xml</format><creator><agent><title>Matplotlib v3.3.0, https://matplotlib.org/</title></agent></creator></work></rdf></metadata><defs><style type="text/css">*{stroke-linecap:butt;stroke-linejoin:round;}</style></defs><g id="figure_1"><g id="patch_1"><path d="M 0 555.041906 
L 883.2 555.041906 
L 883.2 0 
L 0 0 
z
" style="fill:none;"></path></g><g id="axes_1"><g id="patch_2"><path d="M 78.05625 507.807531 
L 866.45625 507.807531 
L 866.45625 7.2 
L 78.05625 7.2 
z
" style="fill:#ffffff;"></path></g><g id="matplotlib.axis_1"><g id="xtick_1"><g id="line2d_1"><defs><path d="M 0 0 
L 0 3.5 
" id="m98190d0cf6" style="stroke:#000000;stroke-width:0.8;"></path></defs><g><use style="stroke:#000000;stroke-width:0.8;" x="149.728977" xlink:href="#m98190d0cf6" y="507.807531"></use></g></g><g id="text_1"><!-- 400 --><g transform="translate(140.185227 522.405968)scale(0.1 -0.1)"><defs><path d="M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
" id="DejaVuSans-52"></path><path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path></defs><use xlink:href="#DejaVuSans-52"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_2"><g id="line2d_2"><g><use style="stroke:#000000;stroke-width:0.8;" x="239.319886" xlink:href="#m98190d0cf6" y="507.807531"></use></g></g><g id="text_2"><!-- 450 --><g transform="translate(229.776136 522.405968)scale(0.1 -0.1)"><defs><path d="M 10.796875 72.90625 
L 49.515625 72.90625 
L 49.515625 64.59375 
L 19.828125 64.59375 
L 19.828125 46.734375 
Q 21.96875 47.46875 24.109375 47.828125 
Q 26.265625 48.1875 28.421875 48.1875 
Q 40.625 48.1875 47.75 41.5 
Q 54.890625 34.8125 54.890625 23.390625 
Q 54.890625 11.625 47.5625 5.09375 
Q 40.234375 -1.421875 26.90625 -1.421875 
Q 22.3125 -1.421875 17.546875 -0.640625 
Q 12.796875 0.140625 7.71875 1.703125 
L 7.71875 11.625 
Q 12.109375 9.234375 16.796875 8.0625 
Q 21.484375 6.890625 26.703125 6.890625 
Q 35.15625 6.890625 40.078125 11.328125 
Q 45.015625 15.765625 45.015625 23.390625 
Q 45.015625 31 40.078125 35.4375 
Q 35.15625 39.890625 26.703125 39.890625 
Q 22.75 39.890625 18.8125 39.015625 
Q 14.890625 38.140625 10.796875 36.28125 
z
" id="DejaVuSans-53"></path></defs><use xlink:href="#DejaVuSans-52"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_3"><g id="line2d_3"><g><use style="stroke:#000000;stroke-width:0.8;" x="328.910795" xlink:href="#m98190d0cf6" y="507.807531"></use></g></g><g id="text_3"><!-- 500 --><g transform="translate(319.367045 522.405968)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-53"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_4"><g id="line2d_4"><g><use style="stroke:#000000;stroke-width:0.8;" x="418.501705" xlink:href="#m98190d0cf6" y="507.807531"></use></g></g><g id="text_4"><!-- 550 --><g transform="translate(408.957955 522.405968)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-53"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_5"><g id="line2d_5"><g><use style="stroke:#000000;stroke-width:0.8;" x="508.092614" xlink:href="#m98190d0cf6" y="507.807531"></use></g></g><g id="text_5"><!-- 600 --><g transform="translate(498.548864 522.405968)scale(0.1 -0.1)"><defs><path d="M 33.015625 40.375 
Q 26.375 40.375 22.484375 35.828125 
Q 18.609375 31.296875 18.609375 23.390625 
Q 18.609375 15.53125 22.484375 10.953125 
Q 26.375 6.390625 33.015625 6.390625 
Q 39.65625 6.390625 43.53125 10.953125 
Q 47.40625 15.53125 47.40625 23.390625 
Q 47.40625 31.296875 43.53125 35.828125 
Q 39.65625 40.375 33.015625 40.375 
z
M 52.59375 71.296875 
L 52.59375 62.3125 
Q 48.875 64.0625 45.09375 64.984375 
Q 41.3125 65.921875 37.59375 65.921875 
Q 27.828125 65.921875 22.671875 59.328125 
Q 17.53125 52.734375 16.796875 39.40625 
Q 19.671875 43.65625 24.015625 45.921875 
Q 28.375 48.1875 33.59375 48.1875 
Q 44.578125 48.1875 50.953125 41.515625 
Q 57.328125 34.859375 57.328125 23.390625 
Q 57.328125 12.15625 50.6875 5.359375 
Q 44.046875 -1.421875 33.015625 -1.421875 
Q 20.359375 -1.421875 13.671875 8.265625 
Q 6.984375 17.96875 6.984375 36.375 
Q 6.984375 53.65625 15.1875 63.9375 
Q 23.390625 74.21875 37.203125 74.21875 
Q 40.921875 74.21875 44.703125 73.484375 
Q 48.484375 72.75 52.59375 71.296875 
z
" id="DejaVuSans-54"></path></defs><use xlink:href="#DejaVuSans-54"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_6"><g id="line2d_6"><g><use style="stroke:#000000;stroke-width:0.8;" x="597.683523" xlink:href="#m98190d0cf6" y="507.807531"></use></g></g><g id="text_6"><!-- 650 --><g transform="translate(588.139773 522.405968)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-54"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_7"><g id="line2d_7"><g><use style="stroke:#000000;stroke-width:0.8;" x="687.274432" xlink:href="#m98190d0cf6" y="507.807531"></use></g></g><g id="text_7"><!-- 700 --><g transform="translate(677.730682 522.405968)scale(0.1 -0.1)"><defs><path d="M 8.203125 72.90625 
L 55.078125 72.90625 
L 55.078125 68.703125 
L 28.609375 0 
L 18.3125 0 
L 43.21875 64.59375 
L 8.203125 64.59375 
z
" id="DejaVuSans-55"></path></defs><use xlink:href="#DejaVuSans-55"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_8"><g id="line2d_8"><g><use style="stroke:#000000;stroke-width:0.8;" x="776.865341" xlink:href="#m98190d0cf6" y="507.807531"></use></g></g><g id="text_8"><!-- 750 --><g transform="translate(767.321591 522.405968)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-55"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_9"><g id="line2d_9"><g><use style="stroke:#000000;stroke-width:0.8;" x="866.45625" xlink:href="#m98190d0cf6" y="507.807531"></use></g></g><g id="text_9"><!-- 800 --><g transform="translate(856.9125 522.405968)scale(0.1 -0.1)"><defs><path d="M 31.78125 34.625 
Q 24.75 34.625 20.71875 30.859375 
Q 16.703125 27.09375 16.703125 20.515625 
Q 16.703125 13.921875 20.71875 10.15625 
Q 24.75 6.390625 31.78125 6.390625 
Q 38.8125 6.390625 42.859375 10.171875 
Q 46.921875 13.96875 46.921875 20.515625 
Q 46.921875 27.09375 42.890625 30.859375 
Q 38.875 34.625 31.78125 34.625 
z
M 21.921875 38.8125 
Q 15.578125 40.375 12.03125 44.71875 
Q 8.5 49.078125 8.5 55.328125 
Q 8.5 64.0625 14.71875 69.140625 
Q 20.953125 74.21875 31.78125 74.21875 
Q 42.671875 74.21875 48.875 69.140625 
Q 55.078125 64.0625 55.078125 55.328125 
Q 55.078125 49.078125 51.53125 44.71875 
Q 48 40.375 41.703125 38.8125 
Q 48.828125 37.15625 52.796875 32.3125 
Q 56.78125 27.484375 56.78125 20.515625 
Q 56.78125 9.90625 50.3125 4.234375 
Q 43.84375 -1.421875 31.78125 -1.421875 
Q 19.734375 -1.421875 13.25 4.234375 
Q 6.78125 9.90625 6.78125 20.515625 
Q 6.78125 27.484375 10.78125 32.3125 
Q 14.796875 37.15625 21.921875 38.8125 
z
M 18.3125 54.390625 
Q 18.3125 48.734375 21.84375 45.5625 
Q 25.390625 42.390625 31.78125 42.390625 
Q 38.140625 42.390625 41.71875 45.5625 
Q 45.3125 48.734375 45.3125 54.390625 
Q 45.3125 60.0625 41.71875 63.234375 
Q 38.140625 66.40625 31.78125 66.40625 
Q 25.390625 66.40625 21.84375 63.234375 
Q 18.3125 60.0625 18.3125 54.390625 
z
" id="DejaVuSans-56"></path></defs><use xlink:href="#DejaVuSans-56"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_10"><g id="line2d_10"><defs><path d="M 0 0 
L 0 2 
" id="m010d431f0c" style="stroke:#000000;stroke-width:0.6;"></path></defs><g><use style="stroke:#000000;stroke-width:0.6;" x="95.974432" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_11"><g id="line2d_11"><g><use style="stroke:#000000;stroke-width:0.6;" x="113.892614" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_12"><g id="line2d_12"><g><use style="stroke:#000000;stroke-width:0.6;" x="131.810795" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_13"><g id="line2d_13"><g><use style="stroke:#000000;stroke-width:0.6;" x="167.647159" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_14"><g id="line2d_14"><g><use style="stroke:#000000;stroke-width:0.6;" x="185.565341" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_15"><g id="line2d_15"><g><use style="stroke:#000000;stroke-width:0.6;" x="203.483523" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_16"><g id="line2d_16"><g><use style="stroke:#000000;stroke-width:0.6;" x="221.401705" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_17"><g id="line2d_17"><g><use style="stroke:#000000;stroke-width:0.6;" x="257.238068" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_18"><g id="line2d_18"><g><use style="stroke:#000000;stroke-width:0.6;" x="275.15625" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_19"><g id="line2d_19"><g><use style="stroke:#000000;stroke-width:0.6;" x="293.074432" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_20"><g id="line2d_20"><g><use style="stroke:#000000;stroke-width:0.6;" x="310.992614" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_21"><g id="line2d_21"><g><use style="stroke:#000000;stroke-width:0.6;" x="346.828977" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_22"><g id="line2d_22"><g><use style="stroke:#000000;stroke-width:0.6;" x="364.747159" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_23"><g id="line2d_23"><g><use style="stroke:#000000;stroke-width:0.6;" x="382.665341" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_24"><g id="line2d_24"><g><use style="stroke:#000000;stroke-width:0.6;" x="400.583523" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_25"><g id="line2d_25"><g><use style="stroke:#000000;stroke-width:0.6;" x="436.419886" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_26"><g id="line2d_26"><g><use style="stroke:#000000;stroke-width:0.6;" x="454.338068" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_27"><g id="line2d_27"><g><use style="stroke:#000000;stroke-width:0.6;" x="472.25625" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_28"><g id="line2d_28"><g><use style="stroke:#000000;stroke-width:0.6;" x="490.174432" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_29"><g id="line2d_29"><g><use style="stroke:#000000;stroke-width:0.6;" x="526.010795" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_30"><g id="line2d_30"><g><use style="stroke:#000000;stroke-width:0.6;" x="543.928977" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_31"><g id="line2d_31"><g><use style="stroke:#000000;stroke-width:0.6;" x="561.847159" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_32"><g id="line2d_32"><g><use style="stroke:#000000;stroke-width:0.6;" x="579.765341" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_33"><g id="line2d_33"><g><use style="stroke:#000000;stroke-width:0.6;" x="615.601705" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_34"><g id="line2d_34"><g><use style="stroke:#000000;stroke-width:0.6;" x="633.519886" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_35"><g id="line2d_35"><g><use style="stroke:#000000;stroke-width:0.6;" x="651.438068" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_36"><g id="line2d_36"><g><use style="stroke:#000000;stroke-width:0.6;" x="669.35625" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_37"><g id="line2d_37"><g><use style="stroke:#000000;stroke-width:0.6;" x="705.192614" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_38"><g id="line2d_38"><g><use style="stroke:#000000;stroke-width:0.6;" x="723.110795" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_39"><g id="line2d_39"><g><use style="stroke:#000000;stroke-width:0.6;" x="741.028977" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_40"><g id="line2d_40"><g><use style="stroke:#000000;stroke-width:0.6;" x="758.947159" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_41"><g id="line2d_41"><g><use style="stroke:#000000;stroke-width:0.6;" x="794.783523" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_42"><g id="line2d_42"><g><use style="stroke:#000000;stroke-width:0.6;" x="812.701705" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_43"><g id="line2d_43"><g><use style="stroke:#000000;stroke-width:0.6;" x="830.619886" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="xtick_44"><g id="line2d_44"><g><use style="stroke:#000000;stroke-width:0.6;" x="848.538068" xlink:href="#m010d431f0c" y="507.807531"></use></g></g></g><g id="text_10"><!-- $\lambda$ (nm) --><g transform="translate(439.25625 543.682531)scale(0.2 -0.2)"><defs><path d="M 36.71875 67.4375 
L 48.828125 0 
L 39.3125 0 
L 31.84375 40.4375 
L 5.125 0 
L -4.390625 0 
L 29.734375 52.4375 
L 28.03125 62.109375 
Q 26.953125 68.265625 21.734375 68.265625 
L 17.046875 68.265625 
L 18.5 75.984375 
L 24.21875 75.875 
Q 35.203125 75.734375 36.71875 67.4375 
z
" id="DejaVuSans-Oblique-955"></path><path id="DejaVuSans-32"></path><path d="M 31 75.875 
Q 24.46875 64.65625 21.28125 53.65625 
Q 18.109375 42.671875 18.109375 31.390625 
Q 18.109375 20.125 21.3125 9.0625 
Q 24.515625 -2 31 -13.1875 
L 23.1875 -13.1875 
Q 15.875 -1.703125 12.234375 9.375 
Q 8.59375 20.453125 8.59375 31.390625 
Q 8.59375 42.28125 12.203125 53.3125 
Q 15.828125 64.359375 23.1875 75.875 
z
" id="DejaVuSans-40"></path><path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-110"></path><path d="M 52 44.1875 
Q 55.375 50.25 60.0625 53.125 
Q 64.75 56 71.09375 56 
Q 79.640625 56 84.28125 50.015625 
Q 88.921875 44.046875 88.921875 33.015625 
L 88.921875 0 
L 79.890625 0 
L 79.890625 32.71875 
Q 79.890625 40.578125 77.09375 44.375 
Q 74.3125 48.1875 68.609375 48.1875 
Q 61.625 48.1875 57.5625 43.546875 
Q 53.515625 38.921875 53.515625 30.90625 
L 53.515625 0 
L 44.484375 0 
L 44.484375 32.71875 
Q 44.484375 40.625 41.703125 44.40625 
Q 38.921875 48.1875 33.109375 48.1875 
Q 26.21875 48.1875 22.15625 43.53125 
Q 18.109375 38.875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.1875 51.21875 25.484375 53.609375 
Q 29.78125 56 35.6875 56 
Q 41.65625 56 45.828125 52.96875 
Q 50 49.953125 52 44.1875 
z
" id="DejaVuSans-109"></path><path d="M 8.015625 75.875 
L 15.828125 75.875 
Q 23.140625 64.359375 26.78125 53.3125 
Q 30.421875 42.28125 30.421875 31.390625 
Q 30.421875 20.453125 26.78125 9.375 
Q 23.140625 -1.703125 15.828125 -13.1875 
L 8.015625 -13.1875 
Q 14.5 -2 17.703125 9.0625 
Q 20.90625 20.125 20.90625 31.390625 
Q 20.90625 42.671875 17.703125 53.65625 
Q 14.5 64.65625 8.015625 75.875 
z
" id="DejaVuSans-41"></path></defs><use transform="translate(0 0.015625)" xlink:href="#DejaVuSans-Oblique-955"></use><use transform="translate(59.179688 0.015625)" xlink:href="#DejaVuSans-32"></use><use transform="translate(90.966797 0.015625)" xlink:href="#DejaVuSans-40"></use><use transform="translate(129.980469 0.015625)" xlink:href="#DejaVuSans-110"></use><use transform="translate(193.359375 0.015625)" xlink:href="#DejaVuSans-109"></use><use transform="translate(290.771484 0.015625)" xlink:href="#DejaVuSans-41"></use></g></g></g><g id="matplotlib.axis_2"><g id="ytick_1"><g id="line2d_45"><defs><path d="M 0 0 
L -3.5 0 
" id="m938dffee45" style="stroke:#000000;stroke-width:0.8;"></path></defs><g><use style="stroke:#000000;stroke-width:0.8;" x="78.05625" xlink:href="#m938dffee45" y="179.43233"></use></g></g><g id="text_11"><!-- $\mathdefault{10^{0}}$ --><g transform="translate(53.45625 183.231549)scale(0.1 -0.1)"><defs><path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path></defs><use transform="translate(0 0.765625)" xlink:href="#DejaVuSans-49"></use><use transform="translate(63.623047 0.765625)" xlink:href="#DejaVuSans-48"></use><use transform="translate(128.203125 39.046875)scale(0.7)" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_2"><g id="line2d_46"><defs><path d="M 0 0 
L -2 0 
" id="m34c01319aa" style="stroke:#000000;stroke-width:0.6;"></path></defs><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m34c01319aa" y="462.263472"></use></g></g><g id="text_12"><!-- $\mathdefault{3\times10^{-1}}$ --><g transform="translate(30.55625 466.062691)scale(0.1 -0.1)"><defs><path d="M 40.578125 39.3125 
Q 47.65625 37.796875 51.625 33 
Q 55.609375 28.21875 55.609375 21.1875 
Q 55.609375 10.40625 48.1875 4.484375 
Q 40.765625 -1.421875 27.09375 -1.421875 
Q 22.515625 -1.421875 17.65625 -0.515625 
Q 12.796875 0.390625 7.625 2.203125 
L 7.625 11.71875 
Q 11.71875 9.328125 16.59375 8.109375 
Q 21.484375 6.890625 26.8125 6.890625 
Q 36.078125 6.890625 40.9375 10.546875 
Q 45.796875 14.203125 45.796875 21.1875 
Q 45.796875 27.640625 41.28125 31.265625 
Q 36.765625 34.90625 28.71875 34.90625 
L 20.21875 34.90625 
L 20.21875 43.015625 
L 29.109375 43.015625 
Q 36.375 43.015625 40.234375 45.921875 
Q 44.09375 48.828125 44.09375 54.296875 
Q 44.09375 59.90625 40.109375 62.90625 
Q 36.140625 65.921875 28.71875 65.921875 
Q 24.65625 65.921875 20.015625 65.03125 
Q 15.375 64.15625 9.8125 62.3125 
L 9.8125 71.09375 
Q 15.4375 72.65625 20.34375 73.4375 
Q 25.25 74.21875 29.59375 74.21875 
Q 40.828125 74.21875 47.359375 69.109375 
Q 53.90625 64.015625 53.90625 55.328125 
Q 53.90625 49.265625 50.4375 45.09375 
Q 46.96875 40.921875 40.578125 39.3125 
z
" id="DejaVuSans-51"></path><path d="M 70.125 53.71875 
L 47.796875 31.296875 
L 70.125 8.984375 
L 64.3125 3.078125 
L 41.890625 25.484375 
L 19.484375 3.078125 
L 13.71875 8.984375 
L 35.984375 31.296875 
L 13.71875 53.71875 
L 19.484375 59.625 
L 41.890625 37.203125 
L 64.3125 59.625 
z
" id="DejaVuSans-215"></path><path d="M 10.59375 35.5 
L 73.1875 35.5 
L 73.1875 27.203125 
L 10.59375 27.203125 
z
" id="DejaVuSans-8722"></path></defs><use transform="translate(0 0.684375)" xlink:href="#DejaVuSans-51"></use><use transform="translate(83.105469 0.684375)" xlink:href="#DejaVuSans-215"></use><use transform="translate(186.376953 0.684375)" xlink:href="#DejaVuSans-49"></use><use transform="translate(250 0.684375)" xlink:href="#DejaVuSans-48"></use><use transform="translate(314.580078 38.965625)scale(0.7)" xlink:href="#DejaVuSans-8722"></use><use transform="translate(373.232422 38.965625)scale(0.7)" xlink:href="#DejaVuSans-49"></use></g></g></g><g id="ytick_3"><g id="line2d_47"><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m34c01319aa" y="394.682669"></use></g></g><g id="text_13"><!-- $\mathdefault{4\times10^{-1}}$ --><g transform="translate(30.55625 398.481888)scale(0.1 -0.1)"><use transform="translate(0 0.684375)" xlink:href="#DejaVuSans-52"></use><use transform="translate(83.105469 0.684375)" xlink:href="#DejaVuSans-215"></use><use transform="translate(186.376953 0.684375)" xlink:href="#DejaVuSans-49"></use><use transform="translate(250 0.684375)" xlink:href="#DejaVuSans-48"></use><use transform="translate(314.580078 38.965625)scale(0.7)" xlink:href="#DejaVuSans-8722"></use><use transform="translate(373.232422 38.965625)scale(0.7)" xlink:href="#DejaVuSans-49"></use></g></g></g><g id="ytick_4"><g id="line2d_48"><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m34c01319aa" y="342.262926"></use></g></g></g><g id="ytick_5"><g id="line2d_49"><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m34c01319aa" y="299.432877"></use></g></g><g id="text_14"><!-- $\mathdefault{6\times10^{-1}}$ --><g transform="translate(30.55625 303.232095)scale(0.1 -0.1)"><use transform="translate(0 0.684375)" xlink:href="#DejaVuSans-54"></use><use transform="translate(83.105469 0.684375)" xlink:href="#DejaVuSans-215"></use><use transform="translate(186.376953 0.684375)" xlink:href="#DejaVuSans-49"></use><use transform="translate(250 0.684375)" xlink:href="#DejaVuSans-48"></use><use transform="translate(314.580078 38.965625)scale(0.7)" xlink:href="#DejaVuSans-8722"></use><use transform="translate(373.232422 38.965625)scale(0.7)" xlink:href="#DejaVuSans-49"></use></g></g></g><g id="ytick_6"><g id="line2d_50"><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m34c01319aa" y="263.220586"></use></g></g></g><g id="ytick_7"><g id="line2d_51"><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m34c01319aa" y="231.852073"></use></g></g></g><g id="ytick_8"><g id="line2d_52"><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m34c01319aa" y="204.183084"></use></g></g></g><g id="ytick_9"><g id="line2d_53"><g><use style="stroke:#000000;stroke-width:0.6;" x="78.05625" xlink:href="#m34c01319aa" y="16.601734"></use></g></g><g id="text_15"><!-- $\mathdefault{2\times10^{0}}$ --><g transform="translate(36.45625 20.400953)scale(0.1 -0.1)"><defs><path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path></defs><use transform="translate(0 0.765625)" xlink:href="#DejaVuSans-50"></use><use transform="translate(83.105469 0.765625)" xlink:href="#DejaVuSans-215"></use><use transform="translate(186.376953 0.765625)" xlink:href="#DejaVuSans-49"></use><use transform="translate(250 0.765625)" xlink:href="#DejaVuSans-48"></use><use transform="translate(314.580078 39.046875)scale(0.7)" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="text_16"><!-- relative spectral radiance of blue sky --><g transform="translate(22.396875 442.552203)rotate(-90)scale(0.2 -0.2)"><defs><path d="M 41.109375 46.296875 
Q 39.59375 47.171875 37.8125 47.578125 
Q 36.03125 48 33.890625 48 
Q 26.265625 48 22.1875 43.046875 
Q 18.109375 38.09375 18.109375 28.8125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 20.953125 51.171875 25.484375 53.578125 
Q 30.03125 56 36.53125 56 
Q 37.453125 56 38.578125 55.875 
Q 39.703125 55.765625 41.0625 55.515625 
z
" id="DejaVuSans-114"></path><path d="M 56.203125 29.59375 
L 56.203125 25.203125 
L 14.890625 25.203125 
Q 15.484375 15.921875 20.484375 11.0625 
Q 25.484375 6.203125 34.421875 6.203125 
Q 39.59375 6.203125 44.453125 7.46875 
Q 49.3125 8.734375 54.109375 11.28125 
L 54.109375 2.78125 
Q 49.265625 0.734375 44.1875 -0.34375 
Q 39.109375 -1.421875 33.890625 -1.421875 
Q 20.796875 -1.421875 13.15625 6.1875 
Q 5.515625 13.8125 5.515625 26.8125 
Q 5.515625 40.234375 12.765625 48.109375 
Q 20.015625 56 32.328125 56 
Q 43.359375 56 49.78125 48.890625 
Q 56.203125 41.796875 56.203125 29.59375 
z
M 47.21875 32.234375 
Q 47.125 39.59375 43.09375 43.984375 
Q 39.0625 48.390625 32.421875 48.390625 
Q 24.90625 48.390625 20.390625 44.140625 
Q 15.875 39.890625 15.1875 32.171875 
z
" id="DejaVuSans-101"></path><path d="M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 0 
L 9.421875 0 
z
" id="DejaVuSans-108"></path><path d="M 34.28125 27.484375 
Q 23.390625 27.484375 19.1875 25 
Q 14.984375 22.515625 14.984375 16.5 
Q 14.984375 11.71875 18.140625 8.90625 
Q 21.296875 6.109375 26.703125 6.109375 
Q 34.1875 6.109375 38.703125 11.40625 
Q 43.21875 16.703125 43.21875 25.484375 
L 43.21875 27.484375 
z
M 52.203125 31.203125 
L 52.203125 0 
L 43.21875 0 
L 43.21875 8.296875 
Q 40.140625 3.328125 35.546875 0.953125 
Q 30.953125 -1.421875 24.3125 -1.421875 
Q 15.921875 -1.421875 10.953125 3.296875 
Q 6 8.015625 6 15.921875 
Q 6 25.140625 12.171875 29.828125 
Q 18.359375 34.515625 30.609375 34.515625 
L 43.21875 34.515625 
L 43.21875 35.40625 
Q 43.21875 41.609375 39.140625 45 
Q 35.0625 48.390625 27.6875 48.390625 
Q 23 48.390625 18.546875 47.265625 
Q 14.109375 46.140625 10.015625 43.890625 
L 10.015625 52.203125 
Q 14.9375 54.109375 19.578125 55.046875 
Q 24.21875 56 28.609375 56 
Q 40.484375 56 46.34375 49.84375 
Q 52.203125 43.703125 52.203125 31.203125 
z
" id="DejaVuSans-97"></path><path d="M 18.3125 70.21875 
L 18.3125 54.6875 
L 36.8125 54.6875 
L 36.8125 47.703125 
L 18.3125 47.703125 
L 18.3125 18.015625 
Q 18.3125 11.328125 20.140625 9.421875 
Q 21.96875 7.515625 27.59375 7.515625 
L 36.8125 7.515625 
L 36.8125 0 
L 27.59375 0 
Q 17.1875 0 13.234375 3.875 
Q 9.28125 7.765625 9.28125 18.015625 
L 9.28125 47.703125 
L 2.6875 47.703125 
L 2.6875 54.6875 
L 9.28125 54.6875 
L 9.28125 70.21875 
z
" id="DejaVuSans-116"></path><path d="M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 0 
L 9.421875 0 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
" id="DejaVuSans-105"></path><path d="M 2.984375 54.6875 
L 12.5 54.6875 
L 29.59375 8.796875 
L 46.6875 54.6875 
L 56.203125 54.6875 
L 35.6875 0 
L 23.484375 0 
z
" id="DejaVuSans-118"></path><path d="M 44.28125 53.078125 
L 44.28125 44.578125 
Q 40.484375 46.53125 36.375 47.5 
Q 32.28125 48.484375 27.875 48.484375 
Q 21.1875 48.484375 17.84375 46.4375 
Q 14.5 44.390625 14.5 40.28125 
Q 14.5 37.15625 16.890625 35.375 
Q 19.28125 33.59375 26.515625 31.984375 
L 29.59375 31.296875 
Q 39.15625 29.25 43.1875 25.515625 
Q 47.21875 21.78125 47.21875 15.09375 
Q 47.21875 7.46875 41.1875 3.015625 
Q 35.15625 -1.421875 24.609375 -1.421875 
Q 20.21875 -1.421875 15.453125 -0.5625 
Q 10.6875 0.296875 5.421875 2 
L 5.421875 11.28125 
Q 10.40625 8.6875 15.234375 7.390625 
Q 20.0625 6.109375 24.8125 6.109375 
Q 31.15625 6.109375 34.5625 8.28125 
Q 37.984375 10.453125 37.984375 14.40625 
Q 37.984375 18.0625 35.515625 20.015625 
Q 33.0625 21.96875 24.703125 23.78125 
L 21.578125 24.515625 
Q 13.234375 26.265625 9.515625 29.90625 
Q 5.8125 33.546875 5.8125 39.890625 
Q 5.8125 47.609375 11.28125 51.796875 
Q 16.75 56 26.8125 56 
Q 31.78125 56 36.171875 55.265625 
Q 40.578125 54.546875 44.28125 53.078125 
z
" id="DejaVuSans-115"></path><path d="M 18.109375 8.203125 
L 18.109375 -20.796875 
L 9.078125 -20.796875 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.390625 
Q 20.953125 51.265625 25.265625 53.625 
Q 29.59375 56 35.59375 56 
Q 45.5625 56 51.78125 48.09375 
Q 58.015625 40.1875 58.015625 27.296875 
Q 58.015625 14.40625 51.78125 6.484375 
Q 45.5625 -1.421875 35.59375 -1.421875 
Q 29.59375 -1.421875 25.265625 0.953125 
Q 20.953125 3.328125 18.109375 8.203125 
z
M 48.6875 27.296875 
Q 48.6875 37.203125 44.609375 42.84375 
Q 40.53125 48.484375 33.40625 48.484375 
Q 26.265625 48.484375 22.1875 42.84375 
Q 18.109375 37.203125 18.109375 27.296875 
Q 18.109375 17.390625 22.1875 11.75 
Q 26.265625 6.109375 33.40625 6.109375 
Q 40.53125 6.109375 44.609375 11.75 
Q 48.6875 17.390625 48.6875 27.296875 
z
" id="DejaVuSans-112"></path><path d="M 48.78125 52.59375 
L 48.78125 44.1875 
Q 44.96875 46.296875 41.140625 47.34375 
Q 37.3125 48.390625 33.40625 48.390625 
Q 24.65625 48.390625 19.8125 42.84375 
Q 14.984375 37.3125 14.984375 27.296875 
Q 14.984375 17.28125 19.8125 11.734375 
Q 24.65625 6.203125 33.40625 6.203125 
Q 37.3125 6.203125 41.140625 7.25 
Q 44.96875 8.296875 48.78125 10.40625 
L 48.78125 2.09375 
Q 45.015625 0.34375 40.984375 -0.53125 
Q 36.96875 -1.421875 32.421875 -1.421875 
Q 20.0625 -1.421875 12.78125 6.34375 
Q 5.515625 14.109375 5.515625 27.296875 
Q 5.515625 40.671875 12.859375 48.328125 
Q 20.21875 56 33.015625 56 
Q 37.15625 56 41.109375 55.140625 
Q 45.0625 54.296875 48.78125 52.59375 
z
" id="DejaVuSans-99"></path><path d="M 45.40625 46.390625 
L 45.40625 75.984375 
L 54.390625 75.984375 
L 54.390625 0 
L 45.40625 0 
L 45.40625 8.203125 
Q 42.578125 3.328125 38.25 0.953125 
Q 33.9375 -1.421875 27.875 -1.421875 
Q 17.96875 -1.421875 11.734375 6.484375 
Q 5.515625 14.40625 5.515625 27.296875 
Q 5.515625 40.1875 11.734375 48.09375 
Q 17.96875 56 27.875 56 
Q 33.9375 56 38.25 53.625 
Q 42.578125 51.265625 45.40625 46.390625 
z
M 14.796875 27.296875 
Q 14.796875 17.390625 18.875 11.75 
Q 22.953125 6.109375 30.078125 6.109375 
Q 37.203125 6.109375 41.296875 11.75 
Q 45.40625 17.390625 45.40625 27.296875 
Q 45.40625 37.203125 41.296875 42.84375 
Q 37.203125 48.484375 30.078125 48.484375 
Q 22.953125 48.484375 18.875 42.84375 
Q 14.796875 37.203125 14.796875 27.296875 
z
" id="DejaVuSans-100"></path><path d="M 30.609375 48.390625 
Q 23.390625 48.390625 19.1875 42.75 
Q 14.984375 37.109375 14.984375 27.296875 
Q 14.984375 17.484375 19.15625 11.84375 
Q 23.34375 6.203125 30.609375 6.203125 
Q 37.796875 6.203125 41.984375 11.859375 
Q 46.1875 17.53125 46.1875 27.296875 
Q 46.1875 37.015625 41.984375 42.703125 
Q 37.796875 48.390625 30.609375 48.390625 
z
M 30.609375 56 
Q 42.328125 56 49.015625 48.375 
Q 55.71875 40.765625 55.71875 27.296875 
Q 55.71875 13.875 49.015625 6.21875 
Q 42.328125 -1.421875 30.609375 -1.421875 
Q 18.84375 -1.421875 12.171875 6.21875 
Q 5.515625 13.875 5.515625 27.296875 
Q 5.515625 40.765625 12.171875 48.375 
Q 18.84375 56 30.609375 56 
z
" id="DejaVuSans-111"></path><path d="M 37.109375 75.984375 
L 37.109375 68.5 
L 28.515625 68.5 
Q 23.6875 68.5 21.796875 66.546875 
Q 19.921875 64.59375 19.921875 59.515625 
L 19.921875 54.6875 
L 34.71875 54.6875 
L 34.71875 47.703125 
L 19.921875 47.703125 
L 19.921875 0 
L 10.890625 0 
L 10.890625 47.703125 
L 2.296875 47.703125 
L 2.296875 54.6875 
L 10.890625 54.6875 
L 10.890625 58.5 
Q 10.890625 67.625 15.140625 71.796875 
Q 19.390625 75.984375 28.609375 75.984375 
z
" id="DejaVuSans-102"></path><path d="M 48.6875 27.296875 
Q 48.6875 37.203125 44.609375 42.84375 
Q 40.53125 48.484375 33.40625 48.484375 
Q 26.265625 48.484375 22.1875 42.84375 
Q 18.109375 37.203125 18.109375 27.296875 
Q 18.109375 17.390625 22.1875 11.75 
Q 26.265625 6.109375 33.40625 6.109375 
Q 40.53125 6.109375 44.609375 11.75 
Q 48.6875 17.390625 48.6875 27.296875 
z
M 18.109375 46.390625 
Q 20.953125 51.265625 25.265625 53.625 
Q 29.59375 56 35.59375 56 
Q 45.5625 56 51.78125 48.09375 
Q 58.015625 40.1875 58.015625 27.296875 
Q 58.015625 14.40625 51.78125 6.484375 
Q 45.5625 -1.421875 35.59375 -1.421875 
Q 29.59375 -1.421875 25.265625 0.953125 
Q 20.953125 3.328125 18.109375 8.203125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 75.984375 
L 18.109375 75.984375 
z
" id="DejaVuSans-98"></path><path d="M 8.5 21.578125 
L 8.5 54.6875 
L 17.484375 54.6875 
L 17.484375 21.921875 
Q 17.484375 14.15625 20.5 10.265625 
Q 23.53125 6.390625 29.59375 6.390625 
Q 36.859375 6.390625 41.078125 11.03125 
Q 45.3125 15.671875 45.3125 23.6875 
L 45.3125 54.6875 
L 54.296875 54.6875 
L 54.296875 0 
L 45.3125 0 
L 45.3125 8.40625 
Q 42.046875 3.421875 37.71875 1 
Q 33.40625 -1.421875 27.6875 -1.421875 
Q 18.265625 -1.421875 13.375 4.4375 
Q 8.5 10.296875 8.5 21.578125 
z
M 31.109375 56 
z
" id="DejaVuSans-117"></path><path d="M 9.078125 75.984375 
L 18.109375 75.984375 
L 18.109375 31.109375 
L 44.921875 54.6875 
L 56.390625 54.6875 
L 27.390625 29.109375 
L 57.625 0 
L 45.90625 0 
L 18.109375 26.703125 
L 18.109375 0 
L 9.078125 0 
z
" id="DejaVuSans-107"></path><path d="M 32.171875 -5.078125 
Q 28.375 -14.84375 24.75 -17.8125 
Q 21.140625 -20.796875 15.09375 -20.796875 
L 7.90625 -20.796875 
L 7.90625 -13.28125 
L 13.1875 -13.28125 
Q 16.890625 -13.28125 18.9375 -11.515625 
Q 21 -9.765625 23.484375 -3.21875 
L 25.09375 0.875 
L 2.984375 54.6875 
L 12.5 54.6875 
L 29.59375 11.921875 
L 46.6875 54.6875 
L 56.203125 54.6875 
z
" id="DejaVuSans-121"></path></defs><use xlink:href="#DejaVuSans-114"></use><use x="38.863281" xlink:href="#DejaVuSans-101"></use><use x="100.386719" xlink:href="#DejaVuSans-108"></use><use x="128.169922" xlink:href="#DejaVuSans-97"></use><use x="189.449219" xlink:href="#DejaVuSans-116"></use><use x="228.658203" xlink:href="#DejaVuSans-105"></use><use x="256.441406" xlink:href="#DejaVuSans-118"></use><use x="315.621094" xlink:href="#DejaVuSans-101"></use><use x="377.144531" xlink:href="#DejaVuSans-32"></use><use x="408.931641" xlink:href="#DejaVuSans-115"></use><use x="461.03125" xlink:href="#DejaVuSans-112"></use><use x="524.507812" xlink:href="#DejaVuSans-101"></use><use x="586.03125" xlink:href="#DejaVuSans-99"></use><use x="641.011719" xlink:href="#DejaVuSans-116"></use><use x="680.220703" xlink:href="#DejaVuSans-114"></use><use x="721.333984" xlink:href="#DejaVuSans-97"></use><use x="782.613281" xlink:href="#DejaVuSans-108"></use><use x="810.396484" xlink:href="#DejaVuSans-32"></use><use x="842.183594" xlink:href="#DejaVuSans-114"></use><use x="883.296875" xlink:href="#DejaVuSans-97"></use><use x="944.576172" xlink:href="#DejaVuSans-100"></use><use x="1008.052734" xlink:href="#DejaVuSans-105"></use><use x="1035.835938" xlink:href="#DejaVuSans-97"></use><use x="1097.115234" xlink:href="#DejaVuSans-110"></use><use x="1160.494141" xlink:href="#DejaVuSans-99"></use><use x="1215.474609" xlink:href="#DejaVuSans-101"></use><use x="1276.998047" xlink:href="#DejaVuSans-32"></use><use x="1308.785156" xlink:href="#DejaVuSans-111"></use><use x="1369.966797" xlink:href="#DejaVuSans-102"></use><use x="1405.171875" xlink:href="#DejaVuSans-32"></use><use x="1436.958984" xlink:href="#DejaVuSans-98"></use><use x="1500.435547" xlink:href="#DejaVuSans-108"></use><use x="1528.21875" xlink:href="#DejaVuSans-117"></use><use x="1591.597656" xlink:href="#DejaVuSans-101"></use><use x="1653.121094" xlink:href="#DejaVuSans-32"></use><use x="1684.908203" xlink:href="#DejaVuSans-115"></use><use x="1737.007812" xlink:href="#DejaVuSans-107"></use><use x="1791.292969" xlink:href="#DejaVuSans-121"></use></g></g></g><g id="LineCollection_1"><path clip-path="url(#p7a915858a7)" d="M 230.360795 556.041906 
L 230.360795 179.43233 
" style="fill:none;stroke:#0000ff;stroke-dasharray:18.5,8;stroke-dashoffset:0;stroke-opacity:0.3;stroke-width:5;"></path></g><g id="LineCollection_2"><path clip-path="url(#p7a915858a7)" d="M 427.460795 556.041906 
L 427.460795 179.43233 
" style="fill:none;stroke:#008000;stroke-dasharray:18.5,8;stroke-dashoffset:0;stroke-opacity:0.3;stroke-width:5;"></path></g><g id="LineCollection_3"><path clip-path="url(#p7a915858a7)" d="M 508.092614 556.041906 
L 508.092614 179.43233 
" style="fill:none;stroke:#ff0000;stroke-dasharray:18.5,8;stroke-dashoffset:0;stroke-opacity:0.3;stroke-width:5;"></path></g><g id="line2d_54"><path clip-path="url(#p7a915858a7)" d="M 113.892614 40.041154 
L 122.851705 38.627062 
L 131.810795 37.733689 
L 140.769886 37.329716 
L 149.728977 37.385995 
L 158.688068 37.875363 
L 167.647159 38.772469 
L 176.60625 40.053624 
L 185.565341 41.696659 
L 194.524432 43.680795 
L 203.483523 45.986532 
L 212.442614 48.595539 
L 221.401705 51.490563 
L 230.360795 54.655338 
L 239.319886 58.074509 
L 248.278977 61.733563 
L 257.238068 65.618763 
L 266.197159 69.717095 
L 275.15625 74.016215 
L 284.115341 78.504406 
L 293.074432 83.170541 
L 302.033523 88.004045 
L 310.992614 92.994873 
L 319.951705 98.133478 
L 328.910795 103.410794 
L 337.869886 108.818217 
L 346.828977 114.347588 
L 355.788068 119.991183 
L 364.747159 125.741698 
L 373.70625 131.59224 
L 382.665341 137.536318 
L 391.624432 143.567834 
L 400.583523 149.68107 
L 409.542614 155.870683 
L 418.501705 162.131692 
L 427.460795 168.459467 
L 436.419886 174.849714 
L 445.378977 181.298465 
L 454.338068 187.80206 
L 463.297159 194.357129 
L 472.25625 200.96058 
L 481.215341 207.609573 
L 490.174432 214.301507 
L 499.133523 221.033993 
L 508.092614 227.80484 
L 517.051705 234.61203 
L 526.010795 241.4537 
L 534.969886 248.328121 
L 543.928977 255.233678 
L 552.888068 262.168854 
L 561.847159 269.132212 
L 570.80625 276.12238 
L 579.765341 283.138037 
L 588.724432 290.1779 
L 597.683523 297.240716 
L 606.642614 304.325251 
L 615.601705 311.430283 
L 624.560795 318.554599 
L 633.519886 325.696991 
L 642.478977 332.856251 
L 651.438068 340.031173 
L 660.397159 347.220551 
L 669.35625 354.423184 
L 678.315341 361.637871 
L 687.274432 368.863421 
L 696.233523 376.098654 
L 705.192614 383.342399 
L 714.151705 390.593506 
L 723.110795 397.850842 
L 732.069886 405.1133 
L 741.028977 412.379797 
L 749.988068 419.649282 
L 758.947159 426.920734 
L 767.90625 434.193168 
L 776.865341 441.465633 
L 785.824432 448.737217 
L 794.783523 456.007044 
L 803.742614 463.274279 
L 812.701705 470.538123 
L 821.660795 477.797818 
L 830.619886 485.052643 
" style="fill:none;stroke:#1f77b4;stroke-dasharray:5.55,2.4;stroke-dashoffset:0;stroke-width:1.5;"></path></g><g id="line2d_55"><path clip-path="url(#p7a915858a7)" d="M 113.892614 47.446575 
L 122.851705 45.08502 
L 131.810795 43.352203 
L 140.769886 42.221319 
L 149.728977 41.667373 
L 158.688068 41.666866 
L 167.647159 42.197511 
L 176.60625 43.237942 
L 185.565341 44.767443 
L 194.524432 46.765679 
L 203.483523 49.212442 
L 212.442614 52.087408 
L 221.401705 55.36991 
L 230.360795 59.038728 
L 239.319886 63.071901 
L 248.278977 67.446569 
L 257.238068 72.138838 
L 266.197159 77.12369 
L 275.15625 82.374933 
L 284.115341 87.865193 
L 293.074432 93.565968 
L 302.033523 99.447735 
L 310.992614 105.480116 
L 319.951705 111.632121 
L 328.910795 117.872434 
L 337.869886 124.169779 
L 346.828977 130.49333 
L 355.788068 136.813165 
L 364.747159 143.100759 
L 373.70625 149.329482 
L 382.665341 155.475096 
L 391.624432 161.516228 
L 400.583523 167.434784 
L 409.542614 173.216309 
L 418.501705 178.850239 
L 427.460795 184.330063 
L 436.419886 189.653368 
L 445.378977 194.821768 
L 454.338068 199.840716 
L 463.297159 204.719218 
L 472.25625 209.469458 
L 481.215341 214.106341 
L 490.174432 218.647003 
L 499.133523 223.110279 
L 508.092614 227.516173 
L 517.051705 231.885336 
L 526.010795 236.238576 
L 534.969886 240.596412 
L 543.928977 244.978677 
L 552.888068 249.404181 
L 561.847159 253.89044 
L 570.80625 258.453455 
L 579.765341 263.10756 
L 588.724432 267.865325 
L 597.683523 272.737496 
L 606.642614 277.732998 
L 615.601705 282.858957 
L 624.560795 288.120764 
L 633.519886 293.522167 
L 642.478977 299.06537 
L 651.438068 304.751162 
L 660.397159 310.579043 
L 669.35625 316.547368 
L 678.315341 322.653486 
L 687.274432 328.893881 
L 696.233523 335.264308 
L 705.192614 341.759933 
L 714.151705 348.375454 
L 723.110795 355.105222 
L 732.069886 361.943351 
L 741.028977 368.883818 
L 749.988068 375.920554 
L 758.947159 383.047523 
L 767.90625 390.258787 
L 776.865341 397.548572 
L 785.824432 404.911308 
L 794.783523 412.341673 
L 803.742614 419.83462 
L 812.701705 427.385401 
L 821.660795 434.989576 
L 830.619886 442.643022 
" style="fill:none;stroke:#ff7f0e;stroke-dasharray:5.55,2.4;stroke-dashoffset:0;stroke-width:1.5;"></path></g><g id="line2d_56"><path clip-path="url(#p7a915858a7)" d="M 113.892614 110.022678 
L 122.851705 103.668189 
L 131.810795 98.112073 
L 140.769886 93.334236 
L 149.728977 89.316384 
L 158.688068 86.041629 
L 167.647159 83.494095 
L 176.60625 81.658504 
L 185.565341 80.519763 
L 194.524432 80.06253 
L 203.483523 80.270768 
L 212.442614 81.127287 
L 221.401705 82.613267 
L 230.360795 84.707771 
L 239.319886 87.387253 
L 248.278977 90.62506 
L 257.238068 94.390941 
L 266.197159 98.650587 
L 275.15625 103.365202 
L 284.115341 108.491143 
L 293.074432 113.979655 
L 302.033523 119.776739 
L 310.992614 125.823183 
L 319.951705 132.054821 
L 328.910795 138.403038 
L 337.869886 144.795586 
L 346.828977 151.157717 
L 355.788068 157.413655 
L 364.747159 163.488387 
L 373.70625 169.309717 
L 382.665341 174.81051 
L 391.624432 179.930988 
L 400.583523 184.620941 
L 409.542614 188.841669 
L 418.501705 192.567519 
L 427.460795 195.786857 
L 436.419886 198.502395 
L 445.378977 200.730834 
L 454.338068 202.50187 
L 463.297159 203.856629 
L 472.25625 204.845697 
L 481.215341 205.526878 
L 490.174432 205.962872 
L 499.133523 206.219003 
L 508.092614 206.361129 
L 517.051705 206.453823 
L 526.010795 206.558866 
L 534.969886 206.734074 
L 543.928977 207.032457 
L 552.888068 207.501659 
L 561.847159 208.183672 
L 570.80625 209.11475 
L 579.765341 210.325498 
L 588.724432 211.841085 
L 597.683523 213.681553 
L 606.642614 215.862181 
L 615.601705 218.393888 
L 624.560795 221.283653 
L 633.519886 224.534939 
L 642.478977 228.148102 
L 651.438068 232.120798 
L 660.397159 236.448356 
L 669.35625 241.124139 
L 678.315341 246.139872 
L 687.274432 251.485949 
L 696.233523 257.151717 
L 705.192614 263.125731 
L 714.151705 269.395986 
L 723.110795 275.950123 
L 732.069886 282.775619 
L 741.028977 289.859947 
L 749.988068 297.190722 
L 758.947159 304.75582 
L 767.90625 312.543484 
L 776.865341 320.542408 
L 785.824432 328.741804 
L 794.783523 337.131458 
L 803.742614 345.701761 
L 812.701705 354.443741 
L 821.660795 363.349069 
L 830.619886 372.410061 
" style="fill:none;stroke:#2ca02c;stroke-dasharray:5.55,2.4;stroke-dashoffset:0;stroke-width:1.5;"></path></g><g id="line2d_57"><path clip-path="url(#p7a915858a7)" d="M 113.892614 239.659233 
L 122.851705 226.269119 
L 131.810795 213.909905 
L 140.769886 202.570923 
L 149.728977 192.243848 
L 158.688068 182.922301 
L 167.647159 174.601431 
L 176.60625 167.277477 
L 185.565341 160.947296 
L 194.524432 155.607844 
L 203.483523 151.255618 
L 212.442614 147.886019 
L 221.401705 145.492651 
L 230.360795 144.066513 
L 239.319886 143.59509 
L 248.278977 144.061316 
L 257.238068 145.442388 
L 266.197159 147.708433 
L 275.15625 150.821011 
L 284.115341 154.731465 
L 293.074432 159.379154 
L 302.033523 164.689613 
L 310.992614 170.572754 
L 319.951705 176.92126 
L 328.910795 183.609395 
L 337.869886 190.492524 
L 346.828977 197.407727 
L 355.788068 204.175889 
L 364.747159 210.605671 
L 373.70625 216.499616 
L 382.665341 221.662437 
L 391.624432 225.91114 
L 400.583523 229.086209 
L 409.542614 231.062647 
L 418.501705 231.759403 
L 427.460795 231.145737 
L 436.419886 229.243465 
L 445.378977 226.124689 
L 454.338068 221.905401 
L 463.297159 216.736033 
L 472.25625 210.790387 
L 481.215341 204.254419 
L 490.174432 197.316091 
L 499.133523 190.157051 
L 508.092614 182.946497 
L 517.051705 175.837175 
L 526.010795 168.963249 
L 534.969886 162.439662 
L 543.928977 156.362571 
L 552.888068 150.810498 
L 561.847159 145.845899 
L 570.80625 141.516915 
L 579.765341 137.859164 
L 588.724432 134.897462 
L 597.683523 132.647411 
L 606.642614 131.116845 
L 615.601705 130.307096 
L 624.560795 130.21411 
L 633.519886 130.829413 
L 642.478977 132.140942 
L 651.438068 134.133758 
L 660.397159 136.790658 
L 669.35625 140.092705 
L 678.315341 144.019674 
L 687.274432 148.550445 
L 696.233523 153.663338 
L 705.192614 159.336398 
L 714.151705 165.547651 
L 723.110795 172.275314 
L 732.069886 179.497987 
L 741.028977 187.194801 
L 749.988068 195.34556 
L 758.947159 203.930849 
L 767.90625 212.932122 
L 776.865341 222.331773 
L 785.824432 232.113191 
L 794.783523 242.26079 
L 803.742614 252.760034 
L 812.701705 263.597442 
L 821.660795 274.760575 
L 830.619886 286.238025 
" style="fill:none;stroke:#d62728;stroke-dasharray:5.55,2.4;stroke-dashoffset:0;stroke-width:1.5;"></path></g><g id="line2d_58"><path clip-path="url(#p7a915858a7)" d="M 113.892614 455.394558 
L 122.851705 431.929196 
L 131.810795 409.791628 
L 140.769886 388.983974 
L 149.728977 369.512052 
L 158.688068 351.385151 
L 167.647159 334.615812 
L 176.60625 319.219599 
L 185.565341 305.214886 
L 194.524432 292.622608 
L 203.483523 281.466003 
L 212.442614 271.770298 
L 221.401705 263.562337 
L 230.360795 256.870095 
L 239.319886 251.722053 
L 248.278977 248.146359 
L 257.238068 246.169683 
L 266.197159 245.815668 
L 275.15625 247.102783 
L 284.115341 250.041392 
L 293.074432 254.629732 
L 302.033523 260.848431 
L 310.992614 268.653105 
L 319.951705 277.964509 
L 328.910795 288.655679 
L 337.869886 300.535715 
L 346.828977 313.330314 
L 355.788068 326.660323 
L 364.747159 340.021608 
L 373.70625 352.772747 
L 382.665341 364.140811 
L 391.624432 373.258085 
L 400.583523 379.240025 
L 409.542614 381.303022 
L 418.501705 378.899787 
L 427.460795 371.830479 
L 436.419886 360.286015 
L 445.378977 344.804735 
L 454.338068 326.161243 
L 463.297159 305.230999 
L 472.25625 282.872526 
L 481.215341 259.849421 
L 490.174432 236.793613 
L 499.133523 214.199544 
L 508.092614 192.436451 
L 517.051705 171.76846 
L 526.010795 152.376004 
L 534.969886 134.37525 
L 543.928977 117.834286 
L 552.888068 102.785928 
L 561.847159 89.237541 
L 570.80625 77.178387 
L 579.765341 66.585064 
L 588.724432 57.425475 
L 597.683523 49.661713 
L 606.642614 43.252133 
L 615.601705 38.152854 
L 624.560795 34.318828 
L 633.519886 31.704604 
L 642.478977 30.264879 
L 651.438068 29.954888 
L 660.397159 30.730687 
L 669.35625 32.549359 
L 678.315341 35.369165 
L 687.274432 39.149656 
L 696.233523 43.851762 
L 705.192614 49.437862 
L 714.151705 55.871835 
L 723.110795 63.119114 
L 732.069886 71.146715 
L 741.028977 79.923274 
L 749.988068 89.419066 
L 758.947159 99.606021 
L 767.90625 110.457734 
L 776.865341 121.949461 
L 785.824432 134.058108 
L 794.783523 146.762215 
L 803.742614 160.041926 
L 812.701705 173.878952 
L 821.660795 188.256521 
L 830.619886 203.159327 
" style="fill:none;stroke:#9467bd;stroke-dasharray:5.55,2.4;stroke-dashoffset:0;stroke-width:1.5;"></path></g><g id="patch_3"><path d="M 78.05625 507.807531 
L 78.05625 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_4"><path d="M 866.45625 507.807531 
L 866.45625 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_5"><path d="M 78.05625 507.807531 
L 866.45625 507.807531 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_6"><path d="M 78.05625 7.2 
L 866.45625 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="legend_1"><g id="patch_7"><path d="M 92.05625 497.807531 
L 288.665625 497.807531 
Q 292.665625 497.807531 292.665625 493.807531 
L 292.665625 349.026281 
Q 292.665625 345.026281 288.665625 345.026281 
L 92.05625 345.026281 
Q 88.05625 345.026281 88.05625 349.026281 
L 88.05625 493.807531 
Q 88.05625 497.807531 92.05625 497.807531 
z
" style="fill:#ffffff;opacity:0.8;stroke:#cccccc;stroke-linejoin:miter;"></path></g><g id="line2d_59"><path d="M 96.05625 361.223156 
L 136.05625 361.223156 
" style="fill:none;stroke:#1f77b4;stroke-dasharray:5.55,2.4;stroke-dashoffset:0;stroke-width:1.5;"></path></g><g id="line2d_60"></g><g id="text_17"><!-- factor=0.010 --><g transform="translate(152.05625 368.223156)scale(0.2 -0.2)"><defs><path d="M 10.59375 45.40625 
L 73.1875 45.40625 
L 73.1875 37.203125 
L 10.59375 37.203125 
z
M 10.59375 25.484375 
L 73.1875 25.484375 
L 73.1875 17.1875 
L 10.59375 17.1875 
z
" id="DejaVuSans-61"></path><path d="M 10.6875 12.40625 
L 21 12.40625 
L 21 0 
L 10.6875 0 
z
" id="DejaVuSans-46"></path></defs><use xlink:href="#DejaVuSans-102"></use><use x="35.205078" xlink:href="#DejaVuSans-97"></use><use x="96.484375" xlink:href="#DejaVuSans-99"></use><use x="151.464844" xlink:href="#DejaVuSans-116"></use><use x="190.673828" xlink:href="#DejaVuSans-111"></use><use x="251.855469" xlink:href="#DejaVuSans-114"></use><use x="292.96875" xlink:href="#DejaVuSans-61"></use><use x="376.757812" xlink:href="#DejaVuSans-48"></use><use x="440.380859" xlink:href="#DejaVuSans-46"></use><use x="472.167969" xlink:href="#DejaVuSans-48"></use><use x="535.791016" xlink:href="#DejaVuSans-49"></use><use x="599.414062" xlink:href="#DejaVuSans-48"></use></g></g><g id="line2d_61"><path d="M 96.05625 390.579406 
L 136.05625 390.579406 
" style="fill:none;stroke:#ff7f0e;stroke-dasharray:5.55,2.4;stroke-dashoffset:0;stroke-width:1.5;"></path></g><g id="line2d_62"></g><g id="text_18"><!-- factor=0.220 --><g transform="translate(152.05625 397.579406)scale(0.2 -0.2)"><use xlink:href="#DejaVuSans-102"></use><use x="35.205078" xlink:href="#DejaVuSans-97"></use><use x="96.484375" xlink:href="#DejaVuSans-99"></use><use x="151.464844" xlink:href="#DejaVuSans-116"></use><use x="190.673828" xlink:href="#DejaVuSans-111"></use><use x="251.855469" xlink:href="#DejaVuSans-114"></use><use x="292.96875" xlink:href="#DejaVuSans-61"></use><use x="376.757812" xlink:href="#DejaVuSans-48"></use><use x="440.380859" xlink:href="#DejaVuSans-46"></use><use x="472.167969" xlink:href="#DejaVuSans-50"></use><use x="535.791016" xlink:href="#DejaVuSans-50"></use><use x="599.414062" xlink:href="#DejaVuSans-48"></use></g></g><g id="line2d_63"><path d="M 96.05625 419.935656 
L 136.05625 419.935656 
" style="fill:none;stroke:#2ca02c;stroke-dasharray:5.55,2.4;stroke-dashoffset:0;stroke-width:1.5;"></path></g><g id="line2d_64"></g><g id="text_19"><!-- factor=0.430 --><g transform="translate(152.05625 426.935656)scale(0.2 -0.2)"><use xlink:href="#DejaVuSans-102"></use><use x="35.205078" xlink:href="#DejaVuSans-97"></use><use x="96.484375" xlink:href="#DejaVuSans-99"></use><use x="151.464844" xlink:href="#DejaVuSans-116"></use><use x="190.673828" xlink:href="#DejaVuSans-111"></use><use x="251.855469" xlink:href="#DejaVuSans-114"></use><use x="292.96875" xlink:href="#DejaVuSans-61"></use><use x="376.757812" xlink:href="#DejaVuSans-48"></use><use x="440.380859" xlink:href="#DejaVuSans-46"></use><use x="472.167969" xlink:href="#DejaVuSans-52"></use><use x="535.791016" xlink:href="#DejaVuSans-51"></use><use x="599.414062" xlink:href="#DejaVuSans-48"></use></g></g><g id="line2d_65"><path d="M 96.05625 449.291906 
L 136.05625 449.291906 
" style="fill:none;stroke:#d62728;stroke-dasharray:5.55,2.4;stroke-dashoffset:0;stroke-width:1.5;"></path></g><g id="line2d_66"></g><g id="text_20"><!-- factor=0.640 --><g transform="translate(152.05625 456.291906)scale(0.2 -0.2)"><use xlink:href="#DejaVuSans-102"></use><use x="35.205078" xlink:href="#DejaVuSans-97"></use><use x="96.484375" xlink:href="#DejaVuSans-99"></use><use x="151.464844" xlink:href="#DejaVuSans-116"></use><use x="190.673828" xlink:href="#DejaVuSans-111"></use><use x="251.855469" xlink:href="#DejaVuSans-114"></use><use x="292.96875" xlink:href="#DejaVuSans-61"></use><use x="376.757812" xlink:href="#DejaVuSans-48"></use><use x="440.380859" xlink:href="#DejaVuSans-46"></use><use x="472.167969" xlink:href="#DejaVuSans-54"></use><use x="535.791016" xlink:href="#DejaVuSans-52"></use><use x="599.414062" xlink:href="#DejaVuSans-48"></use></g></g><g id="line2d_67"><path d="M 96.05625 478.648156 
L 136.05625 478.648156 
" style="fill:none;stroke:#9467bd;stroke-dasharray:5.55,2.4;stroke-dashoffset:0;stroke-width:1.5;"></path></g><g id="line2d_68"></g><g id="text_21"><!-- factor=0.850 --><g transform="translate(152.05625 485.648156)scale(0.2 -0.2)"><use xlink:href="#DejaVuSans-102"></use><use x="35.205078" xlink:href="#DejaVuSans-97"></use><use x="96.484375" xlink:href="#DejaVuSans-99"></use><use x="151.464844" xlink:href="#DejaVuSans-116"></use><use x="190.673828" xlink:href="#DejaVuSans-111"></use><use x="251.855469" xlink:href="#DejaVuSans-114"></use><use x="292.96875" xlink:href="#DejaVuSans-61"></use><use x="376.757812" xlink:href="#DejaVuSans-48"></use><use x="440.380859" xlink:href="#DejaVuSans-46"></use><use x="472.167969" xlink:href="#DejaVuSans-56"></use><use x="535.791016" xlink:href="#DejaVuSans-53"></use><use x="599.414062" xlink:href="#DejaVuSans-48"></use></g></g></g></g></g><defs><clippath id="p7a915858a7"><rect height="500.607531" width="788.4" x="78.05625" y="7.2"></rect></clippath></defs></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>crazy guess, but somewhat fits Figure 5 from [<a href="https://file.scirp.org/pdf/ACS20120400011_46715429.pdf">Zagury, 2012</a>] to achieve some sort of <a href="https://en.wikipedia.org/wiki/Sunset">sunset</a>...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wavelengths</span> <span class="o">=</span> <span class="n">CMF</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-9</span>

<span class="n">N_shades</span><span class="p">,</span> <span class="n">N_width</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span>

<span class="n">hues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N_shades</span><span class="p">,</span> <span class="n">N_width</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">wavelengths</span> <span class="o">=</span> <span class="n">CMF</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-9</span>
<span class="n">intensity5800</span> <span class="o">=</span> <span class="n">planck</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="mf">5800.</span><span class="p">)</span>
<span class="n">azimuths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N_shades</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i_azimuth</span><span class="p">,</span> <span class="n">azimuth</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">azimuths</span><span class="p">):</span>
    <span class="n">factor</span> <span class="o">=</span> <span class="o">.</span><span class="mi">001</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">azimuth</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mf">1.1</span>
    <span class="n">spectrum</span> <span class="o">=</span> <span class="n">intensity5800</span> <span class="o">*</span> <span class="n">scattering</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">)</span> <span class="o">*</span> <span class="n">chappuis</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="n">factor</span><span class="p">)</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">cs_srgb</span><span class="o">.</span><span class="n">spec_to_rgb</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span>
    <span class="n">saturation</span> <span class="o">=</span> <span class="o">.</span><span class="mi">6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">azimuth</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="o">.</span><span class="mi">4</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">saturation</span> <span class="o">*</span> <span class="n">color</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">saturation</span><span class="p">)</span> <span class="c1"># saturation</span>
    <span class="n">color</span> <span class="o">*=</span> <span class="o">.</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">azimuth</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="o">.</span><span class="mi">8</span> <span class="c1"># value</span>
    <span class="n">hues</span><span class="p">[</span><span class="n">i_azimuth</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">color</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_width</span><span class="o">*</span><span class="mi">4</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="o">**</span><span class="n">adjustprops</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">hues</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?><!-- Created with matplotlib (https://matplotlib.org/) --><svg height="821.306344pt" version="1.1" viewbox="0 0 828.8875 821.306344" width="828.8875pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><metadata><rdf xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><work><type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></type><date>2020-07-28T21:35:07.832299</date><format>image/svg+xml</format><creator><agent><title>Matplotlib v3.3.0, https://matplotlib.org/</title></agent></creator></work></rdf></metadata><defs><style type="text/css">*{stroke-linecap:butt;stroke-linejoin:round;}</style></defs><g id="figure_1"><g id="patch_1"><path d="M 0 821.306344 
L 828.8875 821.306344 
L 828.8875 -0 
L 0 -0 
z
" style="fill:none;"></path></g><g id="axes_1"><g id="patch_2"><path d="M 33.2875 797.428219 
L 821.6875 797.428219 
L 821.6875 9.028219 
L 33.2875 9.028219 
z
" style="fill:#ffffff;"></path></g><g clip-path="url(#p99c552862f)"><image height="789" id="imaged3380ab7c7" transform="scale(1 -1)translate(0 -789)" width="789" x="33.2875" xlink:href="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAxUAAAMVCAYAAAABHdkKAAARcklEQVR4nO3dwY0DORJFQVKd4/S6MW6NSd2q9aHegSAQYUFdH75S3P/9799nAQAAvPQ5/QEAAMDdRAUAAJCICgAAIJnlogIAAAgsFQAAQCIqAACARFQAAACJmwoAACCxVAAAAImoAAAAElEBAAAksx1VAAAAgaUCAABIRAUAAJCICgAAIPFOBQAAkFgqAACARFQAAACJqAAAAJLZj6MKAADgPUsFAACQiAoAACARFQAAQOKdCgAAILFUAAAAiagAAAASUQEAACSiAgAASEQFAACQiAoAACARFQAAQDL78VAFAADwnqUCAABIRAUAAJCICgAAIJnlpAIAAAgsFQAAQCIqAACAxF/KAgAAiaUCAABIRAUAAJCICgAAIJnlP2UBAIDAUgEAACSiAgAASEQFAACQjJMKAACgsFQAAACJqAAAABJRAQAAJLMfRxUAAMB7lgoAACARFQAAQCIqAACAxDsVAABAYqkAAAASUQEAACSiAgAASGY7qgAAAAJLBQAAkIgKAAAgERUAAEAy63FTAQAAvGepAAAAElEBAAAkogIAAEjGMxUAAEBhqQAAABJRAQAAJKICAABIZnunAgAACCwVAABAIioAAIBEVAAAAImoAAAAElEBAAAkogIAAEhEBQAAkHinAgAASCwVAABAIioAAIBEVAAAAMksNxUAAEBgqQAAABJRAQAAJKICAABI3FQAAACJpQIAAEhEBQAAkIgKAAAgme2kAgAACCwVAABAIioAAIBEVAAAAMms5agCAAB4z1IBAAAkogIAAEhEBQAAkMx63FQAAADvWSoAAIBEVAAAAImoAAAAktluKgAAgMBSAQAAJKICAABIRAUAAJB4pwIAAEgsFQAAQCIqAACAZLZfPwEAAIGlAgAASEQFAACQiAoAACDxl7IAAEBiqQAAABJRAQAAJKICAABIZi03FQAAwHuWCgAAIBEVAABAIioAAIBktncqAACAwFIBAAAkogIAAEhEBQAAkMxyUwEAAASWCgAAIBEVAABAIioAAIDEOxUAAEBiqQAAABJRAQAAJKICAABIvFMBAAAklgoAACARFQAAQCIqAACAZNZyUwEAALxnqQAAABJRAQAAJKICAABIZnunAgAACCwVAABAIioAAIBEVAAAAImoAAAAElEBAAAkogIAAEhEBQAAkMw+/QUAAMDVLBUAAEAiKgAAgERUAAAAiagAAAASUQEAACSiAgAASEQFAACQzPJQBQAAEFgqAACARFQAAACJqAAAAJJxUgEAABSWCgAAIBEVAABAIioAAIDEOxUAAEBiqQAAABJRAQAAJKICAABIRAUAAJCICgAAIBEVAABAIioAAIBktncqAACAwFIBAAAkogIAAEhEBQAAkIgKAAAgERUAAEAiKgAAgGS2/5QFAAACSwUAAJCICgAAIBEVAABAMstJBQAAEFgqAACARFQAAACJqAAAABJRAQAAJKICAABIRAUAAJCICgAAIJm9PVQBAAC8Z6kAAAASUQEAACSiAgAASGY5qQAAAAJLBQAAkIgKAAAgERUAAEDipgIAAEgsFQAAQCIqAACARFQAAADJbEcVAABAYKkAAAASUQEAACSiAgAASGZtNxUAAMB7lgoAACARFQAAQCIqAACAZJxUAAAAhaUCAABIRAUAAJCICgAAIPFOBQAAkFgqAACARFQAAACJqAAAABI3FQAAQGKpAAAAElEBAAAkogIAAEjGSQUAAFBYKgAAgERUAAAAiagAAAAS71QAAACJpQIAAEhEBQAAkIgKAAAgcVMBAAAklgoAACARFQAAQCIqAACAZPbHTQUAAPCepQIAAEhEBQAAkIgKAAAg8U4FAACQWCoAAIBEVAAAAImoAAAAEjcVAABAYqkAAAASUQEAACSiAgAASGZvXQEAALynKAAAgERUAAAAyayPv5QFAADes1QAAACJqAAAABJRAQAAJLO3mwoAAOA9SwUAAJCICgAAIBEVAABAMmvrCgAA4D1FAQAAJKICAABIRAUAAJDM+ninAgAAeM9SAQAAJKICAABIRAUAAJDM9k4FAAAQKAoAACARFQAAQCIqAACAZNZHVwAAAO8pCgAAIBEVAABAIioAAIBklncqAACAQFEAAACJqAAAABJRAQAAJLM/+/Q3AAAAF7NUAAAAiagAAAASUQEAACSzProCAAB4T1EAAACJqAAAABJRAQAAJLP2z+lvAAAALmapAAAAElEBAAAkogIAAEhme6cCAAAIFAUAAJCICgAAIBEVAABAMstNBQAAECgKAAAgERUAAEAiKgAAgMRNBQAAkCgKAAAgERUAAEAiKgAAgGT2/jn9DQAAwMUsFQAAQCIqAACARFQAAACJdyoAAIBEUQAAAImoAAAAElEBAAAksz7eqQAAAN6zVAAAAImoAAAAElEBAAAks91UAAAAgaUCAABIRAUAAJCICgAAIPFOBQAAkFgqAACARFQAAACJnz8BAACJpQIAAEhEBQAAkIgKAAAgme2mAgAACCwVAABAIioAAIBEVAAAAIl3KgAAgMRSAQAAJKICAABIRAUAAJDM+pnT3wAAAFzMUgEAACSiAgAASEQFAACQzPZOBQAAEFgqAACARFQAAACJqAAAAJJZH+9UAAAA71kqAACARFQAAACJqAAAAJJZ3qkAAAACSwUAAJCICgAAIBEVAABAMuvHOxUAAMB7lgoAACARFQAAQCIqAACAZPbHTQUAAPCepQIAAEhEBQAAkIgKAAAgmeWmAgAACCwVAABAIioAAIBEVAAAAMmsHzcVAADAe5YKAAAgERUAAEAiKgAAgGS2dyoAAIDAUgEAACSiAgAASEQFAACQzHJTAQAABJYKAAAgERUAAEAiKgAAgGTWzz+nvwEAALiYpQIAAEhEBQAAkIgKAAAgme2dCgAAILBUAAAAiagAAAASUQEAACTeqQAAABJLBQAAkIgKAAAgERUAAEAyyzsVAABAYKkAAAASUQEAACSiAgAASOZv7dPfAAAAXMxSAQAAJKICAABIRAUAAJDMr5sKAAAgsFQAAACJqAAAAJL5fU5/AgAAcDNLBQAAkIgKAAAgERUAAEDipgIAAEgsFQAAQCIqAACARFQAAADJ/K59+hsAAICLWSoAAIBEVAAAAImoAAAAkvnzTgUAABBYKgAAgERUAAAAiagAAACS+XVTAQAABJYKAAAgERUAAEAiKgAAgGT+Tn8BAABwNUsFAACQiAoAACARFQAAQDJ/zz79DQAAwMUsFQAAQCIqAACARFQAAADJ/D2nPwEAALiZpQIAAEhEBQAAkIgKAAAgmd/TXwAAAFzNUgEAACSiAgAASEQFAACQeKcCAABILBUAAEAiKgAAgERUAAAAyXzXPv0NAADAxSwVAABAIioAAIBEVAAAAIl3KgAAgMRSAQAAJKICAABIRAUAAJC4qQAAABJLBQAAkIgKAAAgERUAAEAyf6e/AAAAuJqlAgAASEQFAACQiAoAACCZ77NPfwMAAHAxSwUAAJCICgAAIBEVAABAMn/P6U8AAABuZqkAAAASUQEAACSiAgAASOZ7+gsAAICrWSoAAIBEVAAAAImoAAAAEu9UAAAAiaUCAABIRAUAAJDMd+3T3wAAAFzMUgEAACSiAgAASEQFAACQzNdfygIAAIGlAgAASEQFAACQiAoAACCZ7+kvAAAArmapAAAAElEBAAAkogIAAEi8UwEAACSWCgAAIBEVAABAIioAAIBkvmuf/gYAAOBilgoAACARFQAAQCIqAACAxDsVAABAYqkAAAASUQEAACSiAgAASOZ7+gsAAICrWSoAAIBEVAAAAImoAAAAEjcVAABAYqkAAAASUQEAACSiAgAASOb7nP4EAADgZpYKAAAgERUAAEAiKgAAgGSetU9/AwAAcDFLBQAAkIgKAAAgERUAAEDinQoAACCxVAAAAImoAAAAElEBAAAk46QCAAAoLBUAAEAiKgAAgERUAAAAyXxPfwEAAHA1SwUAAJCICgAAIBEVAABAMs+zT38DAABwMUsFAACQiAoAACARFQAAQOKdCgAAILFUAAAAiagAAAASUQEAACTznP4CAADgapYKAAAgERUAAEAiKgAAgMRNBQAAkFgqAACARFQAAACJqAAAAJL5OqoAAAACSwUAAJCICgAAIJln7dPfAAAAXMxSAQAAJKICAABIRAUAAJCMf5QFAAAKSwUAAJCICgAAIBEVAABA4qYCAABILBUAAEAiKgAAgERUAAAAiZsKAAAgsVQAAACJqAAAABJRAQAAJG4qAACAxFIBAAAkogIAAEhEBQAAkLipAAAAEksFAACQiAoAACARFQAAQDLP2qe/AQAAuJilAgAASEQFAACQiAoAACCZx0MVAABAYKkAAAASUQEAACSiAgAASMZJBQAAUFgqAACARFQAAACJqAAAABI3FQAAQGKpAAAAElEBAAAkogIAAEhEBQAAkIgKAAAgERUAAEAiKgAAgMQ7FQAAQGKpAAAAElEBAAAkogIAAEjmWfv0NwAAABezVAAAAImoAAAAElEBAAAkogIAAEhEBQAAkIgKAAAgERUAAEAyj2cqAACAwFIBAAAkogIAAEhEBQAAkMxz+gsAAICrWSoAAIBEVAAAAImoAAAAElEBAAAkogIAAEhEBQAAkIgKAAAg8U4FAACQWCoAAIBEVAAAAImoAAAAElEBAAAkogIAAEhEBQAAkMyz9ulvAAAALmapAAAAElEBAAAkogIAAEhEBQAAkIgKAAAgERUAAEAiKgAAgERUAAAAiagAAAASUQEAACSiAgAASObZpz8BAAC4maUCAABIRAUAAJCICgAAIBEVAABAIioAAIBEVAAAAImoAAAAknlOfwEAAHA1SwUAAJCICgAAIBEVAABAIioAAIBEVAAAAImoAAAAElEBAAAkogIAAEhEBQAAkIgKAAAgERUAAEAya+3T3wAAAFzMUgEAACSiAgAASEQFAACQzOOkAgAACCwVAABAIioAAIBEVAAAAImoAAAAElEBAAAkogIAAEhEBQAAkIgKAAAgERUAAEAiKgAAgERUAAAAiagAAAASUQEAACSiAgAASEQFAACQzHP6CwAAgKtZKgAAgERUAAAAiagAAACSWfv0JwAAADezVAAAAImoAAAAElEBAAAkogIAAEhEBQAAkIgKAAAgERUAAEAiKgAAgERUAAAAiagAAAASUQEAACSiAgAASEQFAACQiAoAACCZtffpbwAAAC5mqQAAABJRAQAAJKICAABIRAUAAJCICgAAIBEVAABAIioAAIBEVAAAAImoAAAAElEBAAAkogIAAEhEBQAAkIgKAAAgERUAAEAiKgAAgGSe018AAABczVIBAAAkogIAAEhEBQAAkMzapz8BAAC4maUCAABIRAUAAJCICgAAIBEVAABAIioAAIBEVAAAAImoAAAAElEBAAAkogIAAEhEBQAAkIgKAAAgERUAAEAiKgAAgERUAAAAiagAAAASUQEAACSiAgAASEQFAACQiAoAACCZtU9/AgAAcDNLBQAAkIgKAAAgERUAAEAiKgAAgERUAAAAiagAAAASUQEAACSiAgAASEQFAACQiAoAACARFQAAQCIqAACARFQAAACJqAAAABJRAQAAJKICAABIRAUAAJCICgAAIBEVAABAIioAAIBEVAAAAImoAAAAElEBAAAkogIAAEhEBQAAkIgKAAAgERUAAEAya5/+BAAA4GaWCgAAIBEVAABAIioAAIBEVAAAAImoAAAAElEBAAAkogIAAEhEBQAAkIgKAAAgERUAAEAiKgAAgERUAAAAiagAAAASUQEAACSiAgAASEQFAACQiAoAACARFQAAQCIqAACARFQAAACJqAAAABJRAQAAJKICAABIRAUAAJCICgAAIBEVAABAIioAAIBEVAAAAImoAAAAElEBAAAks9Y+/Q0AAMDFLBUAAEAiKgAAgERUAAAAyf8BFdGNiahx3+8AAAAASUVORK5CYII=" y="-8.428219"></image></g><g id="matplotlib.axis_1"><g id="xtick_1"><g id="line2d_1"><defs><path d="M 0 0 
L 0 3.5 
" id="m142199b075" style="stroke:#000000;stroke-width:0.8;"></path></defs><g><use style="stroke:#000000;stroke-width:0.8;" x="35.2585" xlink:href="#m142199b075" y="797.428219"></use></g></g><g id="text_1"><!-- 0 --><g transform="translate(32.07725 812.026656)scale(0.1 -0.1)"><defs><path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path></defs><use xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_2"><g id="line2d_2"><g><use style="stroke:#000000;stroke-width:0.8;" x="133.8085" xlink:href="#m142199b075" y="797.428219"></use></g></g><g id="text_2"><!-- 25 --><g transform="translate(127.446 812.026656)scale(0.1 -0.1)"><defs><path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path><path d="M 10.796875 72.90625 
L 49.515625 72.90625 
L 49.515625 64.59375 
L 19.828125 64.59375 
L 19.828125 46.734375 
Q 21.96875 47.46875 24.109375 47.828125 
Q 26.265625 48.1875 28.421875 48.1875 
Q 40.625 48.1875 47.75 41.5 
Q 54.890625 34.8125 54.890625 23.390625 
Q 54.890625 11.625 47.5625 5.09375 
Q 40.234375 -1.421875 26.90625 -1.421875 
Q 22.3125 -1.421875 17.546875 -0.640625 
Q 12.796875 0.140625 7.71875 1.703125 
L 7.71875 11.625 
Q 12.109375 9.234375 16.796875 8.0625 
Q 21.484375 6.890625 26.703125 6.890625 
Q 35.15625 6.890625 40.078125 11.328125 
Q 45.015625 15.765625 45.015625 23.390625 
Q 45.015625 31 40.078125 35.4375 
Q 35.15625 39.890625 26.703125 39.890625 
Q 22.75 39.890625 18.8125 39.015625 
Q 14.890625 38.140625 10.796875 36.28125 
z
" id="DejaVuSans-53"></path></defs><use xlink:href="#DejaVuSans-50"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use></g></g></g><g id="xtick_3"><g id="line2d_3"><g><use style="stroke:#000000;stroke-width:0.8;" x="232.3585" xlink:href="#m142199b075" y="797.428219"></use></g></g><g id="text_3"><!-- 50 --><g transform="translate(225.996 812.026656)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-53"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_4"><g id="line2d_4"><g><use style="stroke:#000000;stroke-width:0.8;" x="330.9085" xlink:href="#m142199b075" y="797.428219"></use></g></g><g id="text_4"><!-- 75 --><g transform="translate(324.546 812.026656)scale(0.1 -0.1)"><defs><path d="M 8.203125 72.90625 
L 55.078125 72.90625 
L 55.078125 68.703125 
L 28.609375 0 
L 18.3125 0 
L 43.21875 64.59375 
L 8.203125 64.59375 
z
" id="DejaVuSans-55"></path></defs><use xlink:href="#DejaVuSans-55"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use></g></g></g><g id="xtick_5"><g id="line2d_5"><g><use style="stroke:#000000;stroke-width:0.8;" x="429.4585" xlink:href="#m142199b075" y="797.428219"></use></g></g><g id="text_5"><!-- 100 --><g transform="translate(419.91475 812.026656)scale(0.1 -0.1)"><defs><path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path></defs><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_6"><g id="line2d_6"><g><use style="stroke:#000000;stroke-width:0.8;" x="528.0085" xlink:href="#m142199b075" y="797.428219"></use></g></g><g id="text_6"><!-- 125 --><g transform="translate(518.46475 812.026656)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-50"></use><use x="127.246094" xlink:href="#DejaVuSans-53"></use></g></g></g><g id="xtick_7"><g id="line2d_7"><g><use style="stroke:#000000;stroke-width:0.8;" x="626.5585" xlink:href="#m142199b075" y="797.428219"></use></g></g><g id="text_7"><!-- 150 --><g transform="translate(617.01475 812.026656)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_8"><g id="line2d_8"><g><use style="stroke:#000000;stroke-width:0.8;" x="725.1085" xlink:href="#m142199b075" y="797.428219"></use></g></g><g id="text_8"><!-- 175 --><g transform="translate(715.56475 812.026656)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-55"></use><use x="127.246094" xlink:href="#DejaVuSans-53"></use></g></g></g></g><g id="matplotlib.axis_2"><g id="ytick_1"><g id="line2d_9"><defs><path d="M 0 0 
L -3.5 0 
" id="mcfbb8211e9" style="stroke:#000000;stroke-width:0.8;"></path></defs><g><use style="stroke:#000000;stroke-width:0.8;" x="33.2875" xlink:href="#mcfbb8211e9" y="10.999219"></use></g></g><g id="text_9"><!-- 0 --><g transform="translate(19.925 14.798437)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_2"><g id="line2d_10"><g><use style="stroke:#000000;stroke-width:0.8;" x="33.2875" xlink:href="#mcfbb8211e9" y="109.549219"></use></g></g><g id="text_10"><!-- 25 --><g transform="translate(13.5625 113.348437)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-50"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use></g></g></g><g id="ytick_3"><g id="line2d_11"><g><use style="stroke:#000000;stroke-width:0.8;" x="33.2875" xlink:href="#mcfbb8211e9" y="208.099219"></use></g></g><g id="text_11"><!-- 50 --><g transform="translate(13.5625 211.898437)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-53"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_4"><g id="line2d_12"><g><use style="stroke:#000000;stroke-width:0.8;" x="33.2875" xlink:href="#mcfbb8211e9" y="306.649219"></use></g></g><g id="text_12"><!-- 75 --><g transform="translate(13.5625 310.448437)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-55"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use></g></g></g><g id="ytick_5"><g id="line2d_13"><g><use style="stroke:#000000;stroke-width:0.8;" x="33.2875" xlink:href="#mcfbb8211e9" y="405.199219"></use></g></g><g id="text_13"><!-- 100 --><g transform="translate(7.2 408.998437)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_6"><g id="line2d_14"><g><use style="stroke:#000000;stroke-width:0.8;" x="33.2875" xlink:href="#mcfbb8211e9" y="503.749219"></use></g></g><g id="text_14"><!-- 125 --><g transform="translate(7.2 507.548437)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-50"></use><use x="127.246094" xlink:href="#DejaVuSans-53"></use></g></g></g><g id="ytick_7"><g id="line2d_15"><g><use style="stroke:#000000;stroke-width:0.8;" x="33.2875" xlink:href="#mcfbb8211e9" y="602.299219"></use></g></g><g id="text_15"><!-- 150 --><g transform="translate(7.2 606.098437)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_8"><g id="line2d_16"><g><use style="stroke:#000000;stroke-width:0.8;" x="33.2875" xlink:href="#mcfbb8211e9" y="700.849219"></use></g></g><g id="text_16"><!-- 175 --><g transform="translate(7.2 704.648437)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-55"></use><use x="127.246094" xlink:href="#DejaVuSans-53"></use></g></g></g></g><g id="patch_3"><path d="M 33.2875 797.428219 
L 33.2875 9.028219 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_4"><path d="M 821.6875 797.428219 
L 821.6875 9.028219 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_5"><path d="M 33.2875 797.428219 
L 821.6875 797.428219 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g><g id="patch_6"><path d="M 33.2875 9.028219 
L 821.6875 9.028219 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path></g></g></g><defs><clippath id="p99c552862f"><rect height="788.4" width="788.4" x="33.2875" y="9.028219"></rect></clippath></defs></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="a-final-note">a final note<a class="anchor-link" href="2020-07-04-colors-of-the-sky.html#a-final-note">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Found out after doing that post that this was already explored in <a href="https://github.com/ookuyan/py_sky">https://github.com/ookuyan/py_sky</a> - of course, in a better programming style :-)
But it is known that one only learns from a journey not only by reaching your goal but by enjoying the path...</p>
<ul>
<li>TODO : green flash and mirage  </li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id='something-"funny"-to-always-remember'>something "funny" to always remember<a class="anchor-link" href="2020-07-04-colors-of-the-sky.html#something-%22funny%22-to-always-remember">¶</a>
</h3>
<p>Numpy arrays passed to a function are changed, contrary to scalars:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">compute</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">*=</span> <span class="mi">2</span>
    <span class="n">b</span> <span class="o">*=</span> <span class="n">a</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'scalar'</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'a ='</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">compute</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'a ='</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="s1">', c ='</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'numpy'</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">'a ='</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">compute</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'a ='</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="s1">', c ='</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>scalar
a = 2
a = 2 , c = 16
numpy
a = [0 1 2 3]
a = [0 2 4 6] , c = [ 0  8 16 24]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="some-book-keeping-for-the-notebook">some book keeping for the notebook<a class="anchor-link" href="2020-07-04-colors-of-the-sky.html#some-book-keeping-for-the-notebook">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> watermark
<span class="o">%</span><span class="k">watermark</span> -i -h -m -v -p numpy,matplotlib,scipy,pillow,imageio  -r -g -b
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>2020-07-28T21:35:08+02:00

CPython 3.8.5
IPython 7.16.1

numpy 1.19.1
matplotlib 3.3.0
scipy 1.5.2
pillow not installed
imageio 2.9.0

compiler   : Clang 11.0.3 (clang-1103.0.32.62)
system     : Darwin
release    : 19.5.0
machine    : x86_64
processor  : i386
CPU cores  : 4
interpreter: 64bit
host name  : ekla
Git hash   : b914b5d5cb5ae5ebb418b057953c49e04d494c51
Git repo   : https://github.com/laurentperrinet/sciblog.git
Git branch : master
</pre>
</div>
</div>

</div>
</div>

</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../categories/art.html" rel="tag">art</a></li>
            <li><a class="tag p-category" href="../categories/grand-public.html" rel="tag">grand-public</a></li>
            <li><a class="tag p-category" href="../categories/motionclouds.html" rel="tag">motionclouds</a></li>
            <li><a class="tag p-category" href="../categories/numpy.html" rel="tag">numpy</a></li>
            <li><a class="tag p-category" href="../categories/open-science.html" rel="tag">open-science</a></li>
            <li><a class="tag p-category" href="../categories/outreach.html" rel="tag">outreach</a></li>
            <li><a class="tag p-category" href="../categories/vision.html" rel="tag">vision</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="2020-06-19-caustic-optics.html" rel="prev" title="2020-06-19 caustic (optics)">Previous post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="invibe",
            disqus_url="https://laurentperrinet.github.io/sciblog/posts/2020-07-04-colors-of-the-sky.html",
        disqus_title="2020-07-04 colors of the sky",
        disqus_identifier="cache/posts/2020-07-04-colors-of-the-sky.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    },
    displayAlign: 'center', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script></article><script>var disqus_shortname="invibe";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><!--End of body content--><footer id="footer">
            Contents © 2020 <a href="mailto:laurent.perrinet@univ-amu.fr">Laurent Perrinet</a> -
Powered by <a href="http://getnikola.com">Nikola</a> with <a href="https://themes.getnikola.com/v7/maupassant/">Maupassant</a> theme <br><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/ar/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="http://i.creativecommons.org/l/by-nc-sa/2.5/ar/88x31.png"></a>
            
            
        </footer>
</div>
</div>


        <script src="../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
